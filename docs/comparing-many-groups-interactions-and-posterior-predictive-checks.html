<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Comparing many groups, interactions, and posterior predictive checks | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R</title>
  <meta name="description" content="Bayesian Models for Repeated Measures" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Comparing many groups, interactions, and posterior predictive checks | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Bayesian Models for Repeated Measures" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Comparing many groups, interactions, and posterior predictive checks | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R" />
  
  <meta name="twitter:description" content="Bayesian Models for Repeated Measures" />
  

<meta name="author" content="Santiago Bareda and Noah Silbert" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="variation-in-parameters-random-effects-and-model-comparison.html"/>
<link rel="next" href="varying-variances-more-about-priors-and-prior-predictive-checks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Repeated Measures data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bayesian-multilevel-models-and-repeated-measures-data"><i class="fa fa-check"></i>Bayesian Multilevel models and repeated measures data</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#whats-missing-from-this-book"><i class="fa fa-check"></i>What’s missing from this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistics-as-procedural-knowledge"><i class="fa fa-check"></i>Statistics as Procedural knowledge</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#practice-vs-brain-power"><i class="fa fa-check"></i>Practice vs brain power</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supplemental-resources"><i class="fa fa-check"></i>Supplemental Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#our-target-audience"><i class="fa fa-check"></i>Our target audience</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-self-starter"><i class="fa fa-check"></i>The self-starter</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-convert"><i class="fa fa-check"></i>The convert</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-instructor"><i class="fa fa-check"></i>The instructor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-need-installed-to-use-this-book"><i class="fa fa-check"></i>What you need installed to use this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-go-bayesian"><i class="fa fa-check"></i>Why go Bayesian?</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-brms"><i class="fa fa-check"></i>Why brms?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#it-takes-a-village-of-books"><i class="fa fa-check"></i>It takes a village (of books)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html"><i class="fa fa-check"></i><b>1</b> Introduction: Experiments and Variables</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#chapter-pre-cap"><i class="fa fa-check"></i><b>1.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-and-effects"><i class="fa fa-check"></i><b>1.2</b> Experiments and effects</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-and-inference"><i class="fa fa-check"></i><b>1.2.1</b> Experiments and inference</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp"><i class="fa fa-check"></i><b>1.3</b> Our experiment</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-intro"><i class="fa fa-check"></i><b>1.3.1</b> Our experiment: Introduction</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-methods"><i class="fa fa-check"></i><b>1.3.2</b> Our experimental methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-research-questions"><i class="fa fa-check"></i><b>1.3.3</b> Our research questions</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-data"><i class="fa fa-check"></i><b>1.3.4</b> Our experimental data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-variables"><i class="fa fa-check"></i><b>1.4</b> Variables</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-pops-and-samps"><i class="fa fa-check"></i><b>1.4.1</b> Populations and samples</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-dep-and-indep"><i class="fa fa-check"></i><b>1.4.2</b> Dependent and Independent Variables</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-categorical"><i class="fa fa-check"></i><b>1.4.3</b> Categorical variables and ‘factors’</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-quantitative"><i class="fa fa-check"></i><b>1.4.4</b> Quantitative variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-logical"><i class="fa fa-check"></i><b>1.4.5</b> Logical variables</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting"><i class="fa fa-check"></i><b>1.5</b> Inspecting our data</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-categorical"><i class="fa fa-check"></i><b>1.5.1</b> Inspecting categorical variables</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-quantitative"><i class="fa fa-check"></i><b>1.5.2</b> Inspecting quantitative variables</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-together"><i class="fa fa-check"></i><b>1.5.3</b> Exploring continuous and categorical variables together</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#references"><i class="fa fa-check"></i><b>1.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html"><i class="fa fa-check"></i><b>2</b> Probabilities, likelihood, and inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#chapter-pre-cap-1"><i class="fa fa-check"></i><b>2.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="2.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-data"><i class="fa fa-check"></i><b>2.2</b> Data and research questions</a></li>
<li class="chapter" data-level="2.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-empirical-prob"><i class="fa fa-check"></i><b>2.3</b> Empirical Probabilities</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-conditional"><i class="fa fa-check"></i><b>2.3.1</b> Conditional and marginal probabilities</a></li>
<li class="chapter" data-level="2.3.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-joint"><i class="fa fa-check"></i><b>2.3.2</b> Joint probabilities</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-theoretical"><i class="fa fa-check"></i><b>2.4</b> Probability distributions</a></li>
<li class="chapter" data-level="2.5" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-normal"><i class="fa fa-check"></i><b>2.5</b> The normal distribution</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-sample-mean"><i class="fa fa-check"></i><b>2.5.1</b> The sample mean</a></li>
<li class="chapter" data-level="2.5.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-sample-variance"><i class="fa fa-check"></i><b>2.5.2</b> The sample variance (or standard deviation)</a></li>
<li class="chapter" data-level="2.5.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-normal-density"><i class="fa fa-check"></i><b>2.5.3</b> The normal density</a></li>
<li class="chapter" data-level="2.5.4" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-standard-normal"><i class="fa fa-check"></i><b>2.5.4</b> The standard normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-models-and-inference"><i class="fa fa-check"></i><b>2.6</b> Models and inference</a></li>
<li class="chapter" data-level="2.7" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-likelihoods"><i class="fa fa-check"></i><b>2.7</b> Probabilities of events and likelihoods of parameters</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods"><i class="fa fa-check"></i><b>2.7.1</b> Characteristics of likelihoods</a></li>
<li class="chapter" data-level="2.7.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-logarithms"><i class="fa fa-check"></i><b>2.7.2</b> A brief aside on logarithms</a></li>
<li class="chapter" data-level="2.7.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods-2"><i class="fa fa-check"></i><b>2.7.3</b> Characteristics of likelihoods, continued</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-inference-and-likelihood"><i class="fa fa-check"></i><b>2.8</b> Answering our research questions</a></li>
<li class="chapter" data-level="2.9" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#exercises-1"><i class="fa fa-check"></i><b>2.9</b> Exercises</a></li>
<li class="chapter" data-level="2.10" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#references-1"><i class="fa fa-check"></i><b>2.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html"><i class="fa fa-check"></i><b>3</b> Fitting Bayesian regression models with <em>brms</em></a>
<ul>
<li class="chapter" data-level="3.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#chapter-pre-cap-2"><i class="fa fa-check"></i><b>3.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="3.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-what-is-reg"><i class="fa fa-check"></i><b>3.2</b> What are regression models?</a></li>
<li class="chapter" data-level="3.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-whats-bayes"><i class="fa fa-check"></i><b>3.3</b> What’s ‘Bayesian’ about these models?</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-priors"><i class="fa fa-check"></i><b>3.3.1</b> Prior probabilities</a></li>
<li class="chapter" data-level="3.3.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-posterior"><i class="fa fa-check"></i><b>3.3.2</b> Posterior distributions</a></li>
<li class="chapter" data-level="3.3.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-characteristics-posteriors"><i class="fa fa-check"></i><b>3.3.3</b> Posterior distributions and shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-sampling"><i class="fa fa-check"></i><b>3.4</b> Sampling from the posterior using <em>Stan</em> and <em>brms</em></a></li>
<li class="chapter" data-level="3.5" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-estimating"><i class="fa fa-check"></i><b>3.5</b> Estimating a single mean with the <code>brms</code> package</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-data-qs-1"><i class="fa fa-check"></i><b>3.5.1</b> Data and Research Questions</a></li>
<li class="chapter" data-level="3.5.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-description-1"><i class="fa fa-check"></i><b>3.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="3.5.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-errors-and-residuals"><i class="fa fa-check"></i><b>3.5.3</b> Errors and residuals</a></li>
<li class="chapter" data-level="3.5.4" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-model-formula"><i class="fa fa-check"></i><b>3.5.4</b> The model formula</a></li>
<li class="chapter" data-level="3.5.5" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-calling-brm"><i class="fa fa-check"></i><b>3.5.5</b> Fitting the model: Calling the <em>brm</em> function</a></li>
<li class="chapter" data-level="3.5.6" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-interpreting-print"><i class="fa fa-check"></i><b>3.5.6</b> Interpreting the model: The print statement</a></li>
<li class="chapter" data-level="3.5.7" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-seeing-samples"><i class="fa fa-check"></i><b>3.5.7</b> Seeing the samples</a></li>
<li class="chapter" data-level="3.5.8" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-getting-residuals"><i class="fa fa-check"></i><b>3.5.8</b> Getting the residuals</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-checking-convergence"><i class="fa fa-check"></i><b>3.6</b> Checking model convergence</a></li>
<li class="chapter" data-level="3.7" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-specifying-priors"><i class="fa fa-check"></i><b>3.7</b> Specifying prior probabilities</a></li>
<li class="chapter" data-level="3.8" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-log-posterior"><i class="fa fa-check"></i><b>3.8</b> The log prior and log posterior densities</a></li>
<li class="chapter" data-level="3.9" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-answering-qs"><i class="fa fa-check"></i><b>3.9</b> Answering our research questions</a></li>
<li class="chapter" data-level="3.10" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-frequentist"><i class="fa fa-check"></i><b>3.10</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-vs-ttest"><i class="fa fa-check"></i><b>3.10.1</b> One-sample t-test vs. intercept-only Bayesian models</a></li>
<li class="chapter" data-level="3.10.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-vs-ols"><i class="fa fa-check"></i><b>3.10.2</b> Intercept-only ordinary-least-squares regression vs. intercept-only Bayesian models</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#exercises-2"><i class="fa fa-check"></i><b>3.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><i class="fa fa-check"></i><b>4</b> Inspecting a ‘single group’ of observations using a Bayesian multilevel model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#chapter-pre-cap-3"><i class="fa fa-check"></i><b>4.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="4.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-multilevel"><i class="fa fa-check"></i><b>4.2</b> Repeated measures data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-levels"><i class="fa fa-check"></i><b>4.2.1</b> Multilevel models and ‘levels’ of variation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-many-levels"><i class="fa fa-check"></i><b>4.3</b> Representing predictors with many levels</a></li>
<li class="chapter" data-level="4.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-strategies"><i class="fa fa-check"></i><b>4.4</b> Strategies for estimating factors with many levels</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-complete-pooling"><i class="fa fa-check"></i><b>4.4.1</b> Complete pooling</a></li>
<li class="chapter" data-level="4.4.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-no-pooling"><i class="fa fa-check"></i><b>4.4.2</b> No pooling</a></li>
<li class="chapter" data-level="4.4.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-partial-pooling"><i class="fa fa-check"></i><b>4.4.3</b> (Adaptive) Partial pooling</a></li>
<li class="chapter" data-level="4.4.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#hyperpriors"><i class="fa fa-check"></i><b>4.4.4</b> Hyperpriors</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-estimating1"><i class="fa fa-check"></i><b>4.5</b> Estimating a multilevel model with <code>brms</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-data-and-qs-1"><i class="fa fa-check"></i><b>4.5.1</b> Data and Research questions</a></li>
<li class="chapter" data-level="4.5.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#description-of-the-model"><i class="fa fa-check"></i><b>4.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="4.5.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-fitting-1"><i class="fa fa-check"></i><b>4.5.3</b> Fitting the model</a></li>
<li class="chapter" data-level="4.5.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#interpreting-the-model"><i class="fa fa-check"></i><b>4.5.4</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-random-effects"><i class="fa fa-check"></i><b>4.6</b> ‘Random’ Effects</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-inspecting-random-effects"><i class="fa fa-check"></i><b>4.6.1</b> Inspecting the random effects</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-simulating"><i class="fa fa-check"></i><b>4.7</b> Simulating data using our model parameters</a></li>
<li class="chapter" data-level="4.8" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-second-random-effect"><i class="fa fa-check"></i><b>4.8</b> Adding a second random effect</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-updating-model"><i class="fa fa-check"></i><b>4.8.1</b> Updating the model description</a></li>
<li class="chapter" data-level="4.8.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fitting-and-interpreting-the-model"><i class="fa fa-check"></i><b>4.8.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-investigating-shrinkage"><i class="fa fa-check"></i><b>4.9</b> Investigating ‘shrinkage’</a></li>
<li class="chapter" data-level="4.10" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-answering-question"><i class="fa fa-check"></i><b>4.10</b> Answering our research questions</a></li>
<li class="chapter" data-level="4.11" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-frequentist"><i class="fa fa-check"></i><b>4.11</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-vs-lmer"><i class="fa fa-check"></i><b>4.11.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#exercises-3"><i class="fa fa-check"></i><b>4.12</b> Exercises</a></li>
<li class="chapter" data-level="4.13" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#references-2"><i class="fa fa-check"></i><b>4.13</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html"><i class="fa fa-check"></i><b>5</b> Comparing two groups of observations: Factors and contrasts</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#chapter-pre-cap-4"><i class="fa fa-check"></i><b>5.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#comparing-two-groups"><i class="fa fa-check"></i><b>5.2</b> Comparing two groups</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#distribution-of-repeated-measures-across-factor-levels"><i class="fa fa-check"></i><b>5.3</b> Distribution of repeated measures across factor levels</a></li>
<li class="chapter" data-level="5.4" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-data-and-qs"><i class="fa fa-check"></i><b>5.4</b> Data and research questions</a></li>
<li class="chapter" data-level="5.5" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-two-means"><i class="fa fa-check"></i><b>5.5</b> Estimating the difference between two means with ‘brms’</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-the-model"><i class="fa fa-check"></i><b>5.5.1</b> Fitting the model</a></li>
<li class="chapter" data-level="5.5.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#interpreting-the-model-1"><i class="fa fa-check"></i><b>5.5.2</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-contrasts"><i class="fa fa-check"></i><b>5.6</b> Contrasts</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-treatment-coding"><i class="fa fa-check"></i><b>5.6.1</b> Treatment coding</a></li>
<li class="chapter" data-level="5.6.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-sum-coding"><i class="fa fa-check"></i><b>5.6.2</b> Sum coding</a></li>
<li class="chapter" data-level="5.6.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-comparison-sum-treatment"><i class="fa fa-check"></i><b>5.6.3</b> Comparison of sum and treatment coding</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-refittin-sum"><i class="fa fa-check"></i><b>5.7</b> Sum coding and the decomposition of variation</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-description-1"><i class="fa fa-check"></i><b>5.7.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.7.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-the-model-1"><i class="fa fa-check"></i><b>5.7.2</b> Fitting the model</a></li>
<li class="chapter" data-level="5.7.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#comparison-of-sum-and-treatment-coding"><i class="fa fa-check"></i><b>5.7.3</b> Comparison of sum and treatment coding</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-working-with-posteriors"><i class="fa fa-check"></i><b>5.8</b> Inspecting and manipulating the posterior samples</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-using-hypothesis"><i class="fa fa-check"></i><b>5.8.1</b> Using the <em>hypothesis</em> function</a></li>
<li class="chapter" data-level="5.8.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-manipulating-random-effects"><i class="fa fa-check"></i><b>5.8.2</b> Working with the random effects</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-robustness"><i class="fa fa-check"></i><b>5.9</b> Making our models more robust: The (non-standardized) t distribution</a></li>
<li class="chapter" data-level="5.10" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#re-fitting-with-t-distributed-errors."><i class="fa fa-check"></i><b>5.10</b> Re-fitting with t-distributed errors</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#description-of-the-model-1"><i class="fa fa-check"></i><b>5.10.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.10.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-and-interpreting-the-model-1"><i class="fa fa-check"></i><b>5.10.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-simulating"><i class="fa fa-check"></i><b>5.11</b> Simulating the two-group model</a></li>
<li class="chapter" data-level="5.12" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-answering-qs"><i class="fa fa-check"></i><b>5.12</b> Answering our research questions</a></li>
<li class="chapter" data-level="5.13" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-frequentist"><i class="fa fa-check"></i><b>5.13</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#bayesian-multilevel-models-vs.-lmer"><i class="fa fa-check"></i><b>5.13.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#exercises-4"><i class="fa fa-check"></i><b>5.14</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html"><i class="fa fa-check"></i><b>6</b> Variation in parameters (‘random effects’) and model comparison</a>
<ul>
<li class="chapter" data-level="6.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#chapter-pre-cap-5"><i class="fa fa-check"></i><b>6.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="6.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-data-and-qs"><i class="fa fa-check"></i><b>6.2</b> Data and research questions</a></li>
<li class="chapter" data-level="6.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-variation-sources"><i class="fa fa-check"></i><b>6.3</b> Variation in parameters across sources of data</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#description-of-our-model"><i class="fa fa-check"></i><b>6.3.1</b> Description of our model</a></li>
<li class="chapter" data-level="6.3.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-correlations"><i class="fa fa-check"></i><b>6.3.2</b> Correlations between random parameters</a></li>
<li class="chapter" data-level="6.3.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-random-and-mvn"><i class="fa fa-check"></i><b>6.3.3</b> Random effects and the multivariate normal distribution</a></li>
<li class="chapter" data-level="6.3.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-mvn-priors"><i class="fa fa-check"></i><b>6.3.4</b> Specifying priors for a multivariate normal distribution</a></li>
<li class="chapter" data-level="6.3.5" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#updating-our-model-description"><i class="fa fa-check"></i><b>6.3.5</b> Updating our model description</a></li>
<li class="chapter" data-level="6.3.6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-fitting"><i class="fa fa-check"></i><b>6.3.6</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-model-comparison"><i class="fa fa-check"></i><b>6.4</b> Model Comparison</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-in-and-out-prediction"><i class="fa fa-check"></i><b>6.4.1</b> In-sample and out-of-sample prediction</a></li>
<li class="chapter" data-level="6.4.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-out-sample-adjust"><i class="fa fa-check"></i><b>6.4.2</b> Out-of-sample prediction: Adjusting predictive accuracy</a></li>
<li class="chapter" data-level="6.4.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-out-sample-crossval"><i class="fa fa-check"></i><b>6.4.3</b> Out-of-sample prediction: Cross validation</a></li>
<li class="chapter" data-level="6.4.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#selecting-a-model"><i class="fa fa-check"></i><b>6.4.4</b> Selecting a model</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-answering"><i class="fa fa-check"></i><b>6.5</b> Answering our research questions</a></li>
<li class="chapter" data-level="6.6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-frequentist"><i class="fa fa-check"></i><b>6.6</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-vs-lmer"><i class="fa fa-check"></i><b>6.6.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#exercises-5"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
<li class="chapter" data-level="6.8" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#references-3"><i class="fa fa-check"></i><b>6.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><i class="fa fa-check"></i><b>7</b> Comparing many groups, interactions, and posterior predictive checks</a>
<ul>
<li class="chapter" data-level="7.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#chapter-pre-cap-6"><i class="fa fa-check"></i><b>7.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="7.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#comparing-four-or-any-number-of-groups"><i class="fa fa-check"></i><b>7.2</b> Comparing four (or any number of) groups</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions"><i class="fa fa-check"></i><b>7.2.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.2.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-description-1"><i class="fa fa-check"></i><b>7.2.2</b> Description of our model</a></li>
<li class="chapter" data-level="7.2.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-2"><i class="fa fa-check"></i><b>7.2.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#investigating-multiple-factors-simultaneously"><i class="fa fa-check"></i><b>7.3</b> Investigating multiple factors simultaneously</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions-1"><i class="fa fa-check"></i><b>7.3.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.3.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#description-of-the-model-2"><i class="fa fa-check"></i><b>7.3.2</b> Description of the model</a></li>
<li class="chapter" data-level="7.3.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-3"><i class="fa fa-check"></i><b>7.3.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-posterior-prediction"><i class="fa fa-check"></i><b>7.4</b> Posterior prediction: Using our models to predict new data</a></li>
<li class="chapter" data-level="7.5" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-interactions-and-plots"><i class="fa fa-check"></i><b>7.5</b> Interactions and interaction plots</a></li>
<li class="chapter" data-level="7.6" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#investigating-interactions-with-a-model"><i class="fa fa-check"></i><b>7.6</b> Investigating interactions with a model</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions-2"><i class="fa fa-check"></i><b>7.6.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.6.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#model-formulas"><i class="fa fa-check"></i><b>7.6.2</b> Model formulas</a></li>
<li class="chapter" data-level="7.6.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#description-of-our-model-1"><i class="fa fa-check"></i><b>7.6.3</b> Description of our model</a></li>
<li class="chapter" data-level="7.6.4" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-4"><i class="fa fa-check"></i><b>7.6.4</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="7.6.5" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-calc-means"><i class="fa fa-check"></i><b>7.6.5</b> Caulculating group means in the presence of interactions</a></li>
<li class="chapter" data-level="7.6.6" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#calculating-simple-effects-in-the-presence-of-interactions"><i class="fa fa-check"></i><b>7.6.6</b> Calculating simple effects in the presence of interactions</a></li>
<li class="chapter" data-level="7.6.7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#assessing-model-fit-bayesian-r2"><i class="fa fa-check"></i><b>7.6.7</b> Assessing model fit: Bayesian <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-answering"><i class="fa fa-check"></i><b>7.7</b> Answering our research questions</a></li>
<li class="chapter" data-level="7.8" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#factors-with-more-than-two-levels"><i class="fa fa-check"></i><b>7.8</b> Factors with more than two levels</a></li>
<li class="chapter" data-level="7.9" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-frequentist"><i class="fa fa-check"></i><b>7.9</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#bayesian-multilevel-models-vs.-lmer-1"><i class="fa fa-check"></i><b>7.9.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#exercises-6"><i class="fa fa-check"></i><b>7.10</b> Exercises</a></li>
<li class="chapter" data-level="7.11" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#references-4"><i class="fa fa-check"></i><b>7.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html"><i class="fa fa-check"></i><b>8</b> Varying variances, more about priors, and prior predictive checks</a>
<ul>
<li class="chapter" data-level="8.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#chapter-pre-cap-7"><i class="fa fa-check"></i><b>8.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="8.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#data-and-research-questions-3"><i class="fa fa-check"></i><b>8.2</b> Data and Research questions</a></li>
<li class="chapter" data-level="8.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#more-about-priors"><i class="fa fa-check"></i><b>8.3</b> More about priors</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-prior-prediction"><i class="fa fa-check"></i><b>8.3.1</b> Prior predictive checks</a></li>
<li class="chapter" data-level="8.3.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#more-specific-priors"><i class="fa fa-check"></i><b>8.3.2</b> More specific priors</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#heteroskedasticity-and-distributional-or-mixture-models"><i class="fa fa-check"></i><b>8.4</b> Heteroskedasticity and distributional (or mixture) models</a></li>
<li class="chapter" data-level="8.5" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#a-simple-model-error-varies-according-to-a-single-fixed-effect"><i class="fa fa-check"></i><b>8.5</b> A ‘simple’ model: Error varies according to a single fixed effect</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#description-of-our-model-2"><i class="fa fa-check"></i><b>8.5.1</b> Description of our model</a></li>
<li class="chapter" data-level="8.5.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#prior-predictive-checks"><i class="fa fa-check"></i><b>8.5.2</b> Prior predictive checks</a></li>
<li class="chapter" data-level="8.5.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fitting-and-interpreting-the-model-5"><i class="fa fa-check"></i><b>8.5.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#a-complex-model-error-varies-according-to-fixed-and-random-effects"><i class="fa fa-check"></i><b>8.6</b> A ‘complex’ model: Error varies according to fixed and random effects</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-description-2"><i class="fa fa-check"></i><b>8.6.1</b> Description of our model</a></li>
<li class="chapter" data-level="8.6.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fitting-and-interpreting-the-model-6"><i class="fa fa-check"></i><b>8.6.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#answering-our-research-questions"><i class="fa fa-check"></i><b>8.7</b> Answering our research questions</a></li>
<li class="chapter" data-level="8.8" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-identifiability"><i class="fa fa-check"></i><b>8.8</b> Building identifiable and supportable models</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#collinearity"><i class="fa fa-check"></i><b>8.8.1</b> Collinearity</a></li>
<li class="chapter" data-level="8.8.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#predictable-values-of-categorical-predictors"><i class="fa fa-check"></i><b>8.8.2</b> Predictable values of categorical predictors</a></li>
<li class="chapter" data-level="8.8.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#saturated-and-nearly-saturated-models"><i class="fa fa-check"></i><b>8.8.3</b> Saturated, and ‘nearly-saturated’, models</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#exercises-7"><i class="fa fa-check"></i><b>8.9</b> Exercises</a></li>
<li class="chapter" data-level="8.10" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#references-5"><i class="fa fa-check"></i><b>8.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html"><i class="fa fa-check"></i><b>9</b> Quantitative predictors and their interactions with factors</a>
<ul>
<li class="chapter" data-level="9.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#chapter-pre-cap-8"><i class="fa fa-check"></i><b>9.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="9.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#data-and-research-questions-4"><i class="fa fa-check"></i><b>9.2</b> Data and research questions</a></li>
<li class="chapter" data-level="9.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#modeling-variation-along-lines"><i class="fa fa-check"></i><b>9.3</b> Modeling variation along lines</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-3"><i class="fa fa-check"></i><b>9.3.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.3.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-centering"><i class="fa fa-check"></i><b>9.3.2</b> Centering quantitative predictors</a></li>
<li class="chapter" data-level="9.3.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-an-interpreting-the-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting an interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-group-dependent-intercepts-but-shared-slopes"><i class="fa fa-check"></i><b>9.4</b> Models with group-dependent intercepts, but shared slopes</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-4"><i class="fa fa-check"></i><b>9.4.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.4.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-and-interpreting-the-model-7"><i class="fa fa-check"></i><b>9.4.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.4.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#interpreting-group-effects-in-the-presence-of-shared-non-zero-slopes"><i class="fa fa-check"></i><b>9.4.3</b> Interpreting group effects in the presence of shared (non-zero) slopes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-group-dependent-slopes-and-intercepts"><i class="fa fa-check"></i><b>9.5</b> Models with group-dependent slopes and intercepts</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-5"><i class="fa fa-check"></i><b>9.5.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.5.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-fitting-3"><i class="fa fa-check"></i><b>9.5.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.5.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#interpreting-group-effects-in-the-presence-of-varying-slopes"><i class="fa fa-check"></i><b>9.5.3</b> Interpreting group effects in the presence of varying slopes</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#answering-our-research-questions-interim-discussion"><i class="fa fa-check"></i><b>9.6</b> Answering our research questions: Interim discussion</a></li>
<li class="chapter" data-level="9.7" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#data-and-research-questions-updated"><i class="fa fa-check"></i><b>9.7</b> Data and research questions: Updated</a></li>
<li class="chapter" data-level="9.8" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-intercepts-and-slopes-for-each-level-of-a-grouping-factor-i.e.-random-slopes"><i class="fa fa-check"></i><b>9.8</b> Models with intercepts and slopes for each level of a grouping factor (i.e. ‘random slopes’)</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-6"><i class="fa fa-check"></i><b>9.8.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.8.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-and-interpreting-the-model-8"><i class="fa fa-check"></i><b>9.8.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-multiple-predictors-for-each-level-of-a-grouping-factor"><i class="fa fa-check"></i><b>9.9</b> Models with multiple predictors for each level of a grouping factor</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-7"><i class="fa fa-check"></i><b>9.9.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.9.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-fitting-5"><i class="fa fa-check"></i><b>9.9.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.9.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#model-selection"><i class="fa fa-check"></i><b>9.9.3</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#answering-our-research-questions-updated"><i class="fa fa-check"></i><b>9.10</b> Answering our research questions: Updated</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#a-word-on-causality"><i class="fa fa-check"></i><b>9.10.1</b> A word on causality</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#exercises-8"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
<li class="chapter" data-level="9.12" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#references-6"><i class="fa fa-check"></i><b>9.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html"><i class="fa fa-check"></i><b>10</b> Logistic regression and signal detection theory models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#chapter-pre-cap-9"><i class="fa fa-check"></i><b>10.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="10.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-dichotomous"><i class="fa fa-check"></i><b>10.2</b> Dichotomous variables and data</a></li>
<li class="chapter" data-level="10.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#generalizing-our-linear-models"><i class="fa fa-check"></i><b>10.3</b> Generalizing our linear models</a></li>
<li class="chapter" data-level="10.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logistic-regression"><i class="fa fa-check"></i><b>10.4</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logits"><i class="fa fa-check"></i><b>10.4.1</b> Logits</a></li>
<li class="chapter" data-level="10.4.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-inverse-logit"><i class="fa fa-check"></i><b>10.4.2</b> The inverse logit link function</a></li>
<li class="chapter" data-level="10.4.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#building-intuitions-about-logits-and-the-inverse-logit-function"><i class="fa fa-check"></i><b>10.4.3</b> Building intuitions about logits and the inverse logit function</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logistic-regression-with-one-quantitative-predictor"><i class="fa fa-check"></i><b>10.5</b> Logistic regression with one quantitative predictor</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#data-and-research-questions-5"><i class="fa fa-check"></i><b>10.5.1</b> Data and research questions</a></li>
<li class="chapter" data-level="10.5.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#description-of-the-model-8"><i class="fa fa-check"></i><b>10.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="10.5.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-fitting-0"><i class="fa fa-check"></i><b>10.5.3</b> Fitting the model</a></li>
<li class="chapter" data-level="10.5.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-fitting-1"><i class="fa fa-check"></i><b>10.5.4</b> Interpreting the model</a></li>
<li class="chapter" data-level="10.5.5" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-classification"><i class="fa fa-check"></i><b>10.5.5</b> Using logistic models to understand classification</a></li>
<li class="chapter" data-level="10.5.6" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#answering-our-research-question"><i class="fa fa-check"></i><b>10.5.6</b> Answering our research question</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#measuring-sensitivity-and-bias"><i class="fa fa-check"></i><b>10.6</b> Measuring sensitivity and bias</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#data-and-research-questions-6"><i class="fa fa-check"></i><b>10.6.1</b> Data and research questions</a></li>
<li class="chapter" data-level="10.6.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#description-of-the-model-9"><i class="fa fa-check"></i><b>10.6.2</b> Description of the model</a></li>
<li class="chapter" data-level="10.6.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#fitting-and-interpreting-the-model-9"><i class="fa fa-check"></i><b>10.6.3</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="10.6.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#answering-our-research-questions-1"><i class="fa fa-check"></i><b>10.6.4</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#exercises-9"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
<li class="chapter" data-level="10.8" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#references-7"><i class="fa fa-check"></i><b>10.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><i class="fa fa-check"></i><b>11</b> Multiple quantitative predictors, dealing with large models, and Bayesian ANOVA</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#chapter-pre-cap-10"><i class="fa fa-check"></i><b>11.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="11.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#models-with-multiple-quantitative-predictors"><i class="fa fa-check"></i><b>11.2</b> Models with multiple quantitative predictors</a></li>
<li class="chapter" data-level="11.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#interactions-between-quantitative-predictors"><i class="fa fa-check"></i><b>11.3</b> Interactions between quantitative predictors</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#centering-quantitative-predictors-when-including-interactions"><i class="fa fa-check"></i><b>11.3.1</b> Centering quantitative predictors when including interactions</a></li>
<li class="chapter" data-level="11.3.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#data-and-research-questions-7"><i class="fa fa-check"></i><b>11.3.2</b> Data and research questions</a></li>
<li class="chapter" data-level="11.3.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c11-description-1"><i class="fa fa-check"></i><b>11.3.3</b> Description of the model</a></li>
<li class="chapter" data-level="11.3.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-the-model-2"><i class="fa fa-check"></i><b>11.3.4</b> Fitting the model</a></li>
<li class="chapter" data-level="11.3.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#advantages-of-bayesian-multilevel-models-for-large-models"><i class="fa fa-check"></i><b>11.3.5</b> Advantages of Bayesian multilevel models for large models</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c11-BANOVA"><i class="fa fa-check"></i><b>11.4</b> Bayesian Analysis of Variance</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#getting-the-standard-deviations-from-our-models-manually"><i class="fa fa-check"></i><b>11.4.1</b> Getting the standard deviations from our models ‘manually’</a></li>
<li class="chapter" data-level="11.4.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#using-the-banova-function"><i class="fa fa-check"></i><b>11.4.2</b> Using the <code>banova</code> function</a></li>
<li class="chapter" data-level="11.4.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-and-comparing-the-reduced-model"><i class="fa fa-check"></i><b>11.4.3</b> Fitting and comparing the reduced model</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#a-logistic-regression-model-with-multiple-quantitative-predictors"><i class="fa fa-check"></i><b>11.5</b> A logistic regression model with multiple quantitative predictors</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#data-and-research-questions-8"><i class="fa fa-check"></i><b>11.5.1</b> Data and research questions</a></li>
<li class="chapter" data-level="11.5.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#description-of-the-model-10"><i class="fa fa-check"></i><b>11.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="11.5.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-and-the-model-and-applying-a-bayesian-anova"><i class="fa fa-check"></i><b>11.5.3</b> Fitting and the model and applying a Bayesian ANOVA</a></li>
<li class="chapter" data-level="11.5.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c12-2d-categorization"><i class="fa fa-check"></i><b>11.5.4</b> Categorization in two dimensions</a></li>
<li class="chapter" data-level="11.5.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#model-selection-and-misspecification"><i class="fa fa-check"></i><b>11.5.5</b> Model selection and misspecification</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#exercises-10"><i class="fa fa-check"></i><b>11.6</b> Exercises</a></li>
<li class="chapter" data-level="11.7" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#references-8"><i class="fa fa-check"></i><b>11.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html"><i class="fa fa-check"></i><b>12</b> Multinomial and Ordinal regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#chapter-pre-cap-11"><i class="fa fa-check"></i><b>12.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="12.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>12.2</b> Multinomial logistic regression</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#multinomial-logits-and-the-softmax-function"><i class="fa fa-check"></i><b>12.2.1</b> Multinomial logits and the softmax function</a></li>
<li class="chapter" data-level="12.2.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#comparison-to-logistic-regression"><i class="fa fa-check"></i><b>12.2.2</b> Comparison to logistic regression</a></li>
<li class="chapter" data-level="12.2.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#data-and-research-questions-9"><i class="fa fa-check"></i><b>12.2.3</b> Data and research questions</a></li>
<li class="chapter" data-level="12.2.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#description-of-our-model-3"><i class="fa fa-check"></i><b>12.2.4</b> Description of our model</a></li>
<li class="chapter" data-level="12.2.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#fitting-the-model-3"><i class="fa fa-check"></i><b>12.2.5</b> Fitting the model</a></li>
<li class="chapter" data-level="12.2.6" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#interpreting-the-model-2"><i class="fa fa-check"></i><b>12.2.6</b> Interpreting the model</a></li>
<li class="chapter" data-level="12.2.7" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#c12-multinomial-territorial-maps"><i class="fa fa-check"></i><b>12.2.7</b> Multinomial models and territorial maps</a></li>
<li class="chapter" data-level="12.2.8" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#refitting-the-model-without-speaker-random-effects"><i class="fa fa-check"></i><b>12.2.8</b> Refitting the model without speaker random effects</a></li>
<li class="chapter" data-level="12.2.9" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#answering-our-research-questions-2"><i class="fa fa-check"></i><b>12.2.9</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#ordinal-logistic-regression"><i class="fa fa-check"></i><b>12.3</b> Ordinal (logistic) regression</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#c12-cumulative-density"><i class="fa fa-check"></i><b>12.3.1</b> Cumulative distribution functions</a></li>
<li class="chapter" data-level="12.3.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#data-and-research-questions-10"><i class="fa fa-check"></i><b>12.3.2</b> Data and research questions</a></li>
<li class="chapter" data-level="12.3.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#description-of-the-model-11"><i class="fa fa-check"></i><b>12.3.3</b> Description of the model</a></li>
<li class="chapter" data-level="12.3.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#fitting-and-interpreting-the-model-10"><i class="fa fa-check"></i><b>12.3.4</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="12.3.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#listener-specific-discrimination-terms"><i class="fa fa-check"></i><b>12.3.5</b> Listener-specific discrimination terms</a></li>
<li class="chapter" data-level="12.3.6" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#answering-our-research-questions-3"><i class="fa fa-check"></i><b>12.3.6</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#exercises-11"><i class="fa fa-check"></i><b>12.4</b> Exercises</a></li>
<li class="chapter" data-level="12.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#references-9"><i class="fa fa-check"></i><b>12.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><i class="fa fa-check"></i><b>13</b> Writing up experiments: An investigation of the perception of apparent speaker characteristics from speech acoustics</a>
<ul>
<li class="chapter" data-level="13.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#introduction"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#fundamental-frequency-and-voice-pitch"><i class="fa fa-check"></i><b>13.1.1</b> Fundamental frequency and voice pitch</a></li>
<li class="chapter" data-level="13.1.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#variation-in-fundamental-frequency-between-speakers"><i class="fa fa-check"></i><b>13.1.2</b> Variation in fundamental frequency between speakers</a></li>
<li class="chapter" data-level="13.1.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#voice-resonance-and-vocal-tract-length"><i class="fa fa-check"></i><b>13.1.3</b> Voice resonance and vocal-tract length</a></li>
<li class="chapter" data-level="13.1.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-estimating-vtl"><i class="fa fa-check"></i><b>13.1.4</b> Estimating vocal-tracts length from speech</a></li>
<li class="chapter" data-level="13.1.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#variation-in-vocal-tract-length-between-speakers"><i class="fa fa-check"></i><b>13.1.5</b> Variation in vocal-tract length between speakers</a></li>
<li class="chapter" data-level="13.1.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-perception-of-chars"><i class="fa fa-check"></i><b>13.1.6</b> Perception of age, gender and size</a></li>
<li class="chapter" data-level="13.1.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#category-dependent-behavior"><i class="fa fa-check"></i><b>13.1.7</b> Category-dependent behavior</a></li>
<li class="chapter" data-level="13.1.8" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#the-current-experiment"><i class="fa fa-check"></i><b>13.1.8</b> The current experiment</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#methods"><i class="fa fa-check"></i><b>13.2</b> Methods</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#participants"><i class="fa fa-check"></i><b>13.2.1</b> Participants</a></li>
<li class="chapter" data-level="13.2.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-stimuli"><i class="fa fa-check"></i><b>13.2.2</b> Stimuli</a></li>
<li class="chapter" data-level="13.2.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#procedure"><i class="fa fa-check"></i><b>13.2.3</b> Procedure</a></li>
<li class="chapter" data-level="13.2.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#data-screening"><i class="fa fa-check"></i><b>13.2.4</b> Data screening</a></li>
<li class="chapter" data-level="13.2.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#loading-the-data-and-packages"><i class="fa fa-check"></i><b>13.2.5</b> Loading the data and packages</a></li>
<li class="chapter" data-level="13.2.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#statistical-analysis-apparent-height"><i class="fa fa-check"></i><b>13.2.6</b> Statistical Analysis: Apparent height</a></li>
<li class="chapter" data-level="13.2.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#statistical-analysis-apparent-gender"><i class="fa fa-check"></i><b>13.2.7</b> Statistical Analysis: Apparent gender</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#results-apparent-height-judgments"><i class="fa fa-check"></i><b>13.3</b> Results: Apparent height judgments</a></li>
<li class="chapter" data-level="13.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#discussion-apparent-height"><i class="fa fa-check"></i><b>13.4</b> Discussion: Apparent height</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#age-dependent-use-of-vtl-cues-on-apparent-height"><i class="fa fa-check"></i><b>13.4.1</b> Age-dependent use of VTL cues on apparent height</a></li>
<li class="chapter" data-level="13.4.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#the-effect-for-apparent-gender-on-apparent-height"><i class="fa fa-check"></i><b>13.4.2</b> The effect for apparent gender on apparent height</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#conclusion-apparent-height-judgments"><i class="fa fa-check"></i><b>13.5</b> Conclusion: Apparent height judgments</a></li>
<li class="chapter" data-level="13.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#results-apparent-gender-judgments"><i class="fa fa-check"></i><b>13.6</b> Results: Apparent gender judgments</a></li>
<li class="chapter" data-level="13.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#discussion-apparent-gender-judgments"><i class="fa fa-check"></i><b>13.7</b> Discussion: Apparent gender judgments</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#effect-of-apparent-age-on-the-perception-of-femaleness"><i class="fa fa-check"></i><b>13.7.1</b> Effect of apparent age on the perception of femaleness</a></li>
<li class="chapter" data-level="13.7.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#between-listener-variation-in-gender-perception"><i class="fa fa-check"></i><b>13.7.2</b> Between-listener variation in gender perception</a></li>
<li class="chapter" data-level="13.7.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#beyond-gross-acoustic-cues-in-gender-perception"><i class="fa fa-check"></i><b>13.7.3</b> Beyond gross acoustic cues in gender perception</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#conclusion-apparent-gender"><i class="fa fa-check"></i><b>13.8</b> Conclusion: Apparent gender</a></li>
<li class="chapter" data-level="13.9" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#next-steps"><i class="fa fa-check"></i><b>13.9</b> Next steps</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#research-design-variable-selection-etc."><i class="fa fa-check"></i><b>13.9.1</b> Research design, variable selection, etc.</a></li>
<li class="chapter" data-level="13.9.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#non-linear-models"><i class="fa fa-check"></i><b>13.9.2</b> Non-linear models</a></li>
<li class="chapter" data-level="13.9.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#other-data-distributions"><i class="fa fa-check"></i><b>13.9.3</b> Other data distributions</a></li>
<li class="chapter" data-level="13.9.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#multivariate-analyses"><i class="fa fa-check"></i><b>13.9.4</b> Multivariate analyses</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#references-10"><i class="fa fa-check"></i><b>13.10</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/santiagobarreda/bmmrmd" target="blank">Book GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="comparing-many-groups-interactions-and-posterior-predictive-checks" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Comparing many groups, interactions, and posterior predictive checks<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#comparing-many-groups-interactions-and-posterior-predictive-checks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We’ve been making our models more and more complicated, but we’ve still only fit models with extremely simple fixed effects structures. For example, in the last two chapters we talked about comparing only two groups. Although the comparison of two groups is very simple, it also comes up often. In addition, more complicated problems are often broken down into several two-group questions in the course of understanding a data set. However, real-world experiments don’t usually <em>begin</em> as two-group questions. In this chapter, we’re going to talk about the comparison of observations across multiple groups and using multiple factors.</p>
<div id="chapter-pre-cap-6" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Chapter pre-cap<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#chapter-pre-cap-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we introduce models that include factors with many levels, and multiple different factors. After that, we discuss the concepts of within and between-subjects factors with respect to factorial designs, orthogonality, and interactions. We then introduce posterior prediction, and the use of this for model checking. Interactions and interaction plots are discussed, as is the way that these can be used to understand main effects and simple main effects. A model with two factors and an interaction, and random effects for all predictors, is fit, and the model is discussed and interpreted. We then present Bayesian <span class="math inline">\(R^2\)</span> as a simple measure of model fit, useful for getting an indication of how much two models actually differ. Finally, we discuss type S and type M errors, regions of practical equivalence, and the problem of how to know when effects are ‘real’.</p>
</div>
<div id="comparing-four-or-any-number-of-groups" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Comparing four (or any number of) groups<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#comparing-four-or-any-number-of-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we’re going to discuss models that compare observations across any number of groups (i.e., levels of a single factor). A model that can be used to compare multiple groups might have just one predictor factor, but that factor can have any number of levels. Although it’s not very common to have a study design or model that <em>only</em> consists of a single multi-group comparison, the inclusion of multi-group comparisons is ubiquitous in many disciplines (including linguistics). Examples of predictors with multiple levels are language (e.g., participants’ first languages), word category (e.g., part of speech, or usage frequency bins), and age groups (e.g., infant, child, teen, adult).</p>
<p>In figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-1">7.1</a> we see two ways that subjects (or listeners, or the levels of any grouping factor) can be arranged into groups. In the <em>within-subjects</em> version of this design, each subject is tested at each level of <span class="math inline">\(A\)</span>. In the <em>between-subjects</em> version of the design, different subjects are tested at every level of <span class="math inline">\(A\)</span>. Here we omit the more complicated design discussed in chapter 5, in which some subjects appear at all levels of <span class="math inline">\(A\)</span> and others don’t. Such designs are definitely analyzable with <code>brms</code>, and sometimes they may be unavoidable. However, they are not included in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-1">7.1</a> because there are a large number of possible configurations of this, and because the additional complexity of such designs can make them extremely challenging to use effectively, so we are typically better off not using such designs if at all possible.</p>
<div class="figure"><span style="display:block;" id="fig:F7-1"></span>
<img src="../wrong_plots/Figure 7.1.jpg" alt="Data from a single group of subjects (S) divided according to a single grouping factor A." width="100%" />
<p class="caption">
Figure 7.1: Data from a single group of subjects (S) divided according to a single grouping factor A.
</p>
</div>
<div id="data-and-research-questions" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Data and research questions<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below we load the data for our experiment investigating apparent speaker height, in addition to the <code>brms</code> and <code>bmmb</code> packages. For the first time, we’re going to analyze productions from all speaker categories at the same time (i.e. boys, girls, men, and women).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (brms)</span>
<span id="cb1-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (bmmb)</span>
<span id="cb1-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&#39;contr.sum&#39;</span>,<span class="st">&#39;contr.sum&#39;</span>))</span>
<span id="cb1-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span> (exp_data)</span></code></pre></div>
<p>In figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-2">7.2</a> we see that the distribution of apparent height with respect to apparent speaker category is very similar to its distribution with respect to veridical speaker category.</p>
<div class="figure"><span style="display:block;" id="fig:F7-2"></span>
<img src="_main_files/figure-html/F7-2-1.jpeg" alt="Distribution of apparent height judgments for boys (b), girls (g), men (m), and women (w) based on apparent speaker category (left) and veridical speaker category (right)." width="4800" />
<p class="caption">
Figure 7.2: Distribution of apparent height judgments for boys (b), girls (g), men (m), and women (w) based on apparent speaker category (left) and veridical speaker category (right).
</p>
</div>
<p>This is not terribly surprising since as we can see below, listeners identified speaker category correctly in 75% of cases. In addition, errors were most common for boys and girls, speakers that are expected to be approximately the same size.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overall average correct category identification</span></span>
<span id="cb2-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(exp_data<span class="sc">$</span>C <span class="sc">==</span> exp_data<span class="sc">$</span>C_v)</span>
<span id="cb2-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.7458</span></span>
<span id="cb2-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># average correct category identification by category</span></span>
<span id="cb2-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(exp_data<span class="sc">$</span>C <span class="sc">==</span> exp_data<span class="sc">$</span>C_v, exp_data<span class="sc">$</span>C_v, mean)</span>
<span id="cb2-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">##      b      g      m      w </span></span>
<span id="cb2-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.5778 0.6456 0.9274 0.7097</span></span></code></pre></div>
<p>In this chapter we’re going to focus on the effect of <em>apparent</em> speaker category on apparent height. This is because we want to understand how listener’s assumptions about the speaker affect their height judgments, and listeners did not know the veridical speaker category. We’re first going to treat the four groups as if they had no internal relationships between the groups. This means we will be ignoring the fact that we might expect some degree of similarity in the relationships between women and girls, on the one hand, and men and boys, on the other. This may not be the best approach for this data since we know there are logical ways to group boys, girls, men, and women. However, this is a good starting point since in many cases you will have levels of a factor with no logical internal divisions.</p>
<p>Even with only four different groups our potential research questions are substantially more complicated than in the two-group case. First, there are four groups now, meaning we could potentially make 6 2-group comparisons. Second, the groups differ along multiple dimensions, making it more difficult to make two-group comparisons that answer a single question. For example, the ‘man’ and ‘girl’ groups differ according to apparent adultness <em>and</em> apparent gender. In the presence of a difference between groups, this makes it difficult to isolate the contribution of each characteristic to the difference in apparent height. For now, we’re going to keep things simple and just build a model that can tell us about our average group values.</p>
<p>To analyze data like this it should be in a data frame with one row for each observation. One column should contain the dependent variable, the variable whose values and variation you’re trying to predict. Another column should contain the fixed effect predictor determining which group each observation belongs to. Finally, you need one or more columns indicating the sources of data in your experiment. The model in this section will use the following variables from our data frame:</p>
<ul>
<li><code>L</code>: A number from 1-15 indicating which <em>listener</em> responded to the trial.</li>
<li><code>C</code>: A letter representing the speaker <em>category</em> (<code>b</code>=boy, <code>g</code>=girl, <code>m</code>=man, <code>w</code>=woman) reported by the listener for each trial.</li>
<li><code>height</code>: A number representing the <em>height</em> (in centimeters) reported for the speaker on each trial.</li>
<li><code>S</code>: A number from 1-139 indicating which <em>speaker</em> produced the trial stimulus.</li>
</ul>
<p>And we are going to ask the following basic question:</p>
<p>(Q1) Does apparent speaker height vary systematically across apparent speaker categories?</p>
</div>
<div id="c7-description-1" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Description of our model<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-description-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the last two chapters we discussed the inclusion of a single factor with two levels in our models. Our model formula does not change in structure to include predictors with many levels. The formula to fit our model will be:</p>
<p><code>height ~ C + (C|L) + (1|S)</code></p>
<p>Where <code>C</code> is the apparent speaker category indicated by the listener for each trial, a factor with four levels (see above). Since we include <code>C</code> on the left-hand-side of the pipe of <code>L</code>, we know that we are estimating the category by listener interaction using adaptive partial pooling. At this point we have to make a decision regarding how we represent our models in more formal notation, and striking a balance between readability and models that are directly analogous to the output in R.</p>
<p>Each level of the category predictor that we are estimating needs to be represented by a model parameter. Since we are using sum coding for all our factors (see section <a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-sum-coding">5.6.2</a>), our model will estimate three of the four group effects, omitting the alphabetically last level (in this case ‘woman’). As a result, the formula above is analogous to:</p>
<p><code>height ~ C1 + C2 + C3 + (C1 + C2 + C3|L) + (1|S)</code></p>
<p>Where <code>C1</code>, <code>C2</code>, and <code>C3</code> are parameters associated with the first three levels of apparent speaker category. In section <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-many-levels">4.3</a>, we noted that each parameter in our model needs to be associated with a predictor. If we call the predictors <code>x1</code>, <code>x2</code>, and <code>x3</code> our model formula could sort of be thought of as seen below. Of course this is no longer a real or working model formula, we’re just trying to show how <span class="math inline">\(C\)</span> might actually be included in our model.</p>
<p><code>height ~ x1*C1 + x2*C2 + x3*C3 + (x1*C1 + x2*C2 + x3*C3|L) + (1|S)</code></p>
<p>When a factor has only two levels, the effect for one level must equal the negative of the effect for the other level. As a result, group membership for observations can be represented using a single predictor equal to either -1 or 1 (for sum coding, discussed in section <a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-description-1">5.7.1</a>). When the observation is associated with one level of the factor the predictor is 1, and when the observation is associated with the other level the predictor is -1. In that way, a single predictor and coefficient can reflect two different levels of the factor.</p>
<p>When there are more than two levels, each level that is being estimated is associated with a predictor variable, meaning that we expect <span class="math inline">\(J-1\)</span> estimated coefficients for a factor with <span class="math inline">\(J\)</span> levels in the absence of additional constraints. An example of this is seen below, where we generate three ‘fake’ predictors to represent four groups. Imagine the tiny matrix below represents the numerical predictors for our <code>C</code> parameters so that the first, second, and third columns represent <code>x1</code>, <code>x2</code> and <code>x3</code> respectively. Each row is represented by a single 1 save for the final row which is represented by -1 in <em>all other predictors</em> for that factor.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contr.sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb3-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   [,1] [,2] [,3]</span></span>
<span id="cb3-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    1    0    0</span></span>
<span id="cb3-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2    0    1    0</span></span>
<span id="cb3-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3    0    0    1</span></span>
<span id="cb3-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4   -1   -1   -1</span></span></code></pre></div>
<p>Our tiny data matrix above suggests that the first observation (row) belongs to the first group (boy). This is because our data results in the <span class="math inline">\(C1\)</span> parameter being multiplied by one, and <span class="math inline">\(C2\)</span> and <span class="math inline">\(C3\)</span> being zeroed out (see section <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-many-levels">4.3</a>). The same logic suggests the second row is an observation from the second group and the third from the third. For example, in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-0">(7.1)</a> we imagine that the first four values of our <code>C</code> predictor are 1, 2, 3, and 4, meaning that the apparent speaker category indicated for the first four trials were boy, girl, man, and woman. We also imagine that our predicted value (<span class="math inline">\(\mu\)</span>) is a combination of our estimated parameters <span class="math inline">\(C1, C2\)</span> and <span class="math inline">\(C3\)</span> with the ‘secret’ predictors in our matrix above. We can see that multiplying our coefficients with our predictors has the effect of ‘erasing’ the unwanted coefficients for a given row leaving only the one associated with the observation.</p>
<p><span class="math display" id="eq:7-0">\[
\begin{equation}
\begin{split}
\mathsf{C}_{[1]} = 1, \mathsf{C}_{[2]}=2,\mathsf{C}_{[3]}=3,\mathsf{C}_{[4]}=4  \dots \\
\mu_{[i]} = x_1 \cdot C1 +  x_2 \cdot C2 + x_3 \cdot C3 \\ \\
\mu_{[1]} = 1 \cdot C1 +  0 \cdot C2 + 0 \cdot C3 = C1\\
\mu_{[2]} = 0 \cdot C1 +  1 \cdot C2 + 0 \cdot C3 = C2\\
\mu_{[3]} = 0 \cdot C1 +  0 \cdot C2 + 1 \cdot C3 = C3\\
\mu_{[4]} = -1 \cdot C1 - 1 \cdot C2 - 1 \cdot C3 = -(C1 + C2 + C3) = C4\\
\end{split}
\tag{7.1}
\end{equation}
\]</span></p>
<p>Since <span class="math inline">\(C4\)</span> is equal to <span class="math inline">\(-(C1+C2+C3)\)</span> (under sum coding), adding the negative of <span class="math inline">\(C1\)</span>, <span class="math inline">\(C2\)</span>, and <span class="math inline">\(C3\)</span> to the prediction is equivalent to adding the value of <span class="math inline">\(C4\)</span>. As a result, the fourth row of our tiny matrix represents an observation from the fourth group, and encodes the effect for <span class="math inline">\(C4\)</span>, even without directly estimating this value. As a result, even though our model only directly estimates three parameters for our <span class="math inline">\(C\)</span> predictor, we could think of our model as tacitly representing four parameters for this factor: <span class="math inline">\(C1\)</span>, <span class="math inline">\(C2\)</span>, <span class="math inline">\(C3\)</span>, and <span class="math inline">\(-(C1+C2+C3)\)</span>.</p>
<p>Even though the inclusion of <span class="math inline">\(C\)</span> in our model requires the addition of three separate parameters, we’re going to represent these with a single term like <span class="math inline">\(C_{[\mathsf{C}_{[i]}]}\)</span> in our formal model descriptions. This term selects the value of <span class="math inline">\(C\)</span> for trial <span class="math inline">\(i\)</span> based on the value of the <code>C</code> (apparent category) predictor, which is consistent with the way we’ve been representing our listener and speaker-dependent intercepts. However, there appears to be a problem. The subscript of the term is a predictor which has four levels (<code>C</code>, or <span class="math inline">\(\mathsf{C}\)</span>). When the <code>C</code> predictor is equal to it’s fourth level (<code>C = w</code>), the model seems to want to select the fourth <span class="math inline">\(C\)</span> predictor, i.e. <span class="math inline">\(C_{[4]}\)</span>. However, our <span class="math inline">\(C\)</span> predictor vector does not contain four elements because the fourth level of the <code>C</code> predictor is not estimated (i.e. there is no <span class="math inline">\(x_4\)</span> predictor in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-0">(7.1)</a>). So, when this occurs we can just imagine that our model reconstructs the missing parameter using the ones that <em>are</em> estimated, and then uses this value for <span class="math inline">\(C4\)</span>.</p>
<p>Since we are including adult male speakers in our data we should also reconsider our priors. Based on the information in <code>height_data</code> we expect average apparent heights of around 176, 162, 150 and 150 cm respectively for men, women, girls, and boys. These four groups have an average of 159 cm and a standard deviation of 12 cm. Based on this, and especially given that we are investigating <em>apparent</em> and not <em>veridical</em> height, the priors we used in the last chapter still seem appropriate. The formal description of our model is given below. We omit the deterministic equation building up <span class="math inline">\(\mathrm{\Sigma}\)</span> from the correlation matrix (<span class="math inline">\(R\)</span>) and the individual standard deviations (shown in <a href="#eq:6-7">(<strong>??</strong>)</a>) since this does not involve the user, and it makes the model description needlessly bigger.</p>
<p><span class="math display" id="eq:7-1">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{t}(\nu, \mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{Intercept} + C_{[\mathsf{C}_{[i]}]}  + L_{[\mathsf{L}_{[i]}]} + C_{[\mathsf{C}_{[i]}]} \colon L_{[\mathsf{L}_{[i]}]} + S_{[\mathsf{S}_{[i]}]} \\ \\
\mathrm{Priors:} \\
S_{[\bullet]} \sim \mathrm{N}(0,\sigma_S) \\
\begin{bmatrix} L_{[\bullet]} \\ C_{[1]} \colon L_{[\bullet]}
\\ C_{[2]} \colon L_{[\bullet]} \\ C_{[3]} \colon L_{[\bullet]} \end{bmatrix} \sim \mathrm{MVNormal} \left(\begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \\ \end{bmatrix}, \mathrm{\Sigma} \right) \\ \\
\mathrm{Intercept} \sim \mathrm{N}(156,12) \\
C_{[\bullet]} \sim \mathrm{N}(0,12) \\
\sigma_L,\sigma_{C_{[1]} \colon L},\sigma_{C_{[2]} \colon L},\sigma_{C_{[3]} \colon L}, \sigma_S \sim \mathrm{N}(0,12) \\
\nu \sim \mathrm{gamma}(2, 0.1) \\
R \sim \mathrm{LKJCorr} (2)
\end{split}
\tag{7.2}
\end{equation}
\]</span></p>
<p>Structurally, this model is extremely similar to the one described in <a href="#eq:6-7">(<strong>??</strong>)</a> last chapter with <span class="math inline">\(C_{[\mathsf{C}_{[i]}]}\)</span> replacing <span class="math inline">\(A\)</span> and <span class="math inline">\(C_{[\mathsf{C}_{[i]}]} \colon L_{[\mathsf{L}_{[i]}]}\)</span> replacing <span class="math inline">\(A \colon L_{[\mathsf{L}_{[i]}]}\)</span>. Note that since we are estimating three parameters for <code>C</code>, our listener-dependent ‘random effects’ come from a four-dimensional normal distribution which considers the relationships between the intercepts and category effects for individual listeners. Here is a plain English description of the model in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-1">(7.2)</a>:</p>
<blockquote>
<p>We are modeling apparent height as coming from a t distribution with unknown nu (<span class="math inline">\(\nu\)</span>), mean (<span class="math inline">\(\mu\)</span>), and scale (<span class="math inline">\(\sigma\)</span>) parameters. The expected value for any given trial (<span class="math inline">\(\mu\)</span>) is modeled as the sum of an intercept, an effect for apparent speaker category (<span class="math inline">\(C\)</span>), a listener effect (<span class="math inline">\(L\)</span>), listener dependent effects for apparent category (e.g. <span class="math inline">\(C_{[1]} \colon L\)</span>), and a speaker effect (<span class="math inline">\(S\)</span>). The speaker effects were drawn from a univariate normal distribution with a standard deviation (<span class="math inline">\(\sigma_S\)</span>) estimated from the data. The four listener effects were drawn from a multivariate normal distribution with individual standard deviations (<span class="math inline">\(\sigma_L,\sigma_{C_{[1]} \colon L},\sigma_{C_{[2]} \colon L},\sigma_{C_{[3]} \colon L}\)</span>) and a correlation matrix (<span class="math inline">\(R\)</span>) that was estimated from the data. The remainder of the ‘fixed’ effects and correlations were given prior distributions appropriate for their expected range of values.</p>
</blockquote>
</div>
<div id="fitting-and-interpreting-the-model-2" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Fitting and interpreting the model<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We fit the four-group model below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb4-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,156, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb4-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-3" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb4-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-4" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb4-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-5" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (2)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>), </span>
<span id="cb4-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-6" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;gamma(2, 0.1)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;nu&quot;</span>),</span>
<span id="cb4-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-7" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb4-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-9" aria-hidden="true" tabindex="-1"></a>model_four_groups <span class="ot">=</span>  </span>
<span id="cb4-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-10" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> C <span class="sc">+</span> (C<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, </span>
<span id="cb4-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">thin =</span> <span class="dv">4</span>, </span>
<span id="cb4-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb4-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">prior =</span> priors, <span class="at">family =</span> <span class="st">&quot;student&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or download it from the GitHub page:</span></span>
<span id="cb5-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb5-2" aria-hidden="true" tabindex="-1"></a>model_four_groups <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;7_model_four_groups.RDS&#39;</span>)</span></code></pre></div>
<p>We’ll focus on the fixed effects, seen below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb6-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">fixef</span>(model_four_groups)</span>
<span id="cb6-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error   Q2.5   Q97.5</span></span>
<span id="cb6-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept  158.581     1.083 156.41 160.685</span></span>
<span id="cb6-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">## C1          -9.318     1.310 -11.87  -6.682</span></span>
<span id="cb6-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="do">## C2         -12.082     1.494 -15.07  -9.110</span></span>
<span id="cb6-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## C3          15.286     1.327  12.59  17.950</span></span></code></pre></div>
<p>It’s always a good idea to make sure your model coefficients make sense given your data. Doing things like this will help minimize mistakes and make sure that you really understand your model. We can see that the intercept corresponds to the average of the group means, and our <code>C</code> coefficients correspond reasonably to, but don’t exactly match, the centered group means.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group means</span></span>
<span id="cb7-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-2" aria-hidden="true" tabindex="-1"></a>means <span class="ot">=</span> <span class="fu">tapply</span> (exp_data<span class="sc">$</span>height, exp_data<span class="sc">$</span>C, mean)</span>
<span id="cb7-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept = mean of means</span></span>
<span id="cb7-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span> (means)</span>
<span id="cb7-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 158</span></span>
<span id="cb7-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Group effects = centered group means</span></span>
<span id="cb7-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-9" aria-hidden="true" tabindex="-1"></a>means <span class="sc">-</span> <span class="fu">mean</span> (means)</span>
<span id="cb7-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">##      b      g      m      w </span></span>
<span id="cb7-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">## -11.12 -13.03  16.56   7.59</span></span></code></pre></div>
<p>There are many possible reasons for this including the fact that the group means don’t account for repeated measures, a lack of balance in the data, or for the way that outliers can unduly influence sample mean estimates. That being said, it’s useful to see that our model coefficients seem to reflect the data and we should be concerned if these diverged wildly. Note that, as discussed above, we’re missing the <code>C4</code> coefficient. We can use the <code>short_hypothesis</code> function to easily recover the final group coefficient by finding the negative sum of the coefficients that <em>were</em> estimated. An example of this is shown below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># missing group effect</span></span>
<span id="cb8-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb8-2" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">short_hypothesis</span> (model_four_groups, <span class="fu">c</span>(<span class="st">&quot;-(C1+C2+C3) = 0&quot;</span>))</span>
<span id="cb8-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    Estimate Est.Error  Q2.5 Q97.5        hypothesis</span></span>
<span id="cb8-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">## H1    6.114     1.216 3.686 8.543 (-(C1+C2+C3)) = 0</span></span></code></pre></div>
<p>Clearly, there are differences in apparent height across groups. If someone asked you “please describe the differences to me”, you might begin by saying something like “there doesn’t seem to be too much difference in apparent height between apparent boys and girls”, or “apparent men are identified as taller than apparent women”. In each case, these statements reduce a multi-group model to focus on a single difference between groups at a time. We can use <code>short_hypothesis</code> to help us compare different combinations of our fixed effects. Using the code below we test for a difference in group means between the first and second groups (boys and girls), and between the third and fourth groups (men and women).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find differences between groups</span></span>
<span id="cb9-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb9-2" aria-hidden="true" tabindex="-1"></a>comparisons <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">short_hypothesis</span> (model_four_groups, </span>
<span id="cb9-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb9-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">c</span>(<span class="st">&quot;C1 = C2&quot;</span>, <span class="st">&quot;C3 = -(C1+C2+C3)&quot;</span>))</span></code></pre></div>
<p>We can use <code>brmplot</code> from the <code>bmmb</code> package to easily make plots showing means and credible intervals for our fixed effects, including the recovered coefficient. We also plot the two comparisons we made using the <code>hypothesis</code> function above, presented in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-3">7.3</a>.</p>
<div class="figure"><span style="display:block;" id="fig:F7-3"></span>
<img src="_main_files/figure-html/F7-3-1.jpeg" alt="(left) Means and 95% credible intervals for boy (b), girl (g), man (m), and woman (w) effects for our four group model. (right) Means and 95% credible intervals for differences between boys and girls, and men and women." width="4800" />
<p class="caption">
Figure 7.3: (left) Means and 95% credible intervals for boy (b), girl (g), man (m), and woman (w) effects for our four group model. (right) Means and 95% credible intervals for differences between boys and girls, and men and women.
</p>
</div>
<p>The distributions in the left plot of the figure tell us about probable values for our category parameters: Given our data and model structure, there is a 95% probability that the parameter value falls within this interval. Our category effects reflect the expected difference between our model intercept, the overall grand mean, and each category mean. So, the intervals on the left of figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-3">7.3</a> tell us that there is a 95% probability (given our data and model structure) that the actual difference between the grand mean and each group mean falls within that range. What do the distributions in the right plot in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-2">7.2</a> tell us? They represent the posterior distribution of the <em>difference</em> between category means directly, without involving the intercept.</p>
<p>Conceptually, finding the difference between the intercept and a group mean is no different than finding the difference between individual group means. Consider the example of providing directions with respect to your house. If the library is 5 miles west and the park is 3 miles west, you could refer to these as -5 and -3 miles from your house, west to east. However, you could also express the difference between one and the other directly as 2 (or -2). The left plot in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-2">7.2</a> expresses all distances with respect to the intercept (your house) while the right plot expresses differences with respect to individual category means directly (the library and park).</p>
</div>
</div>
<div id="investigating-multiple-factors-simultaneously" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Investigating multiple factors simultaneously<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#investigating-multiple-factors-simultaneously" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our model above had a single factor with four groups/levels. Another way to look at it is that the model predicted variation along a single <strong>dimension</strong>, that is a single piece of information that can be used to distinguish our groups. However, we can usually categorize people (or observations) along multiple dimensions simultaneously - there is more structure in the data than a single dimension captures. So, a speaker may be an adult <em>and</em> female or adult <em>and</em> male, child <em>and</em> female or child <em>and</em> male, and not just adult or child, male or female. This is because adultness and gender are separate characteristics (dimensions) and the value of one does not determine the value of the other. In our height experiment we effectively asked listeners to make two binary classifications: Is the listener an adult or a child? Is the listener female or male? This means we can think of our four groups as varying along two dimensions, each represented by a different factor. However, although we know this, our previous model didn’t: It thinks we just have four groups that have no logical internal distinctions.</p>
<p>To include multiple predictors in our model and inspect the effect of all combinations of factor levels on our dependent variable, we must <em>cross</em> our predictors. This means that we observe each level of one factor at every level of the other factor (and vice versa). For our data this means that we observe both male and female children, and male and female adults. Crossing factors results in <span class="math inline">\(n_A \cdot n_B\)</span> individual groups for two factors (<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) with <span class="math inline">\(n_A\)</span> and <span class="math inline">\(n_B\)</span> number of levels each. Since we have two factors with two levels each, crossing apparent age and gender results in four unique groups: Boys (male child), girls (female child), men (male adult), and women (female adult). Designs where all the factors are crossed are sometimes called <strong>factorial</strong> or <strong>orthogonal</strong> designs.</p>
<p>When you have orthogonal designs, that means that the effect of your ‘dimensions’ (i.e., factors) can be estimated separately. For example, if you want to know the difference in apparent height across levels of apparent gender, it helps to have observed both adults and children for each gender. A comparison of boys and women will conflate gender and age differences, thereby making it difficult to understand the independent effect of apparent gender. By balancing factors across each other, orthogonal designs allow us to <em>decompose</em> the variation in our data using different factors more effectively. This allows us to attribute the variation in our observations to the different factors in our design (we will return to this idea in chapter 11).</p>
<p>Figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-4">7.4</a> presents a few ways that subjects can be combined with two two-level factors, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, whose combination can represent four groups. First, we can see that factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are crossed with each other since there are subjects, and presumably observations, in each little <strong>cell</strong> (i.e. combination of factor levels). What would it look like for these factors to not be crossed? Well, one of the ‘cells’ (boxes) would be completely missing observations. If this were to happen, we would obviously lose the ability to make comparisons across groups involving the values in that cell. If your subjects factor is fully crossed with your fixed effects factors (in this case <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) then you have a fully <em>within-subjects</em> design. If you only observe certain subjects for specific combinations of fixed effects, you have a fully <em>between-subjects</em> design.</p>
<div class="figure"><span style="display:block;" id="fig:F7-4"></span>
<img src="../wrong_plots/Figure 7.4.jpg" alt="Data from groups of subjects (S), divided according to two grouping factors A and B." width="100%" />
<p class="caption">
Figure 7.4: Data from groups of subjects (S), divided according to two grouping factors A and B.
</p>
</div>
<p>Finally, we see a new possibility, a <strong>mixed design</strong>. In a mixed design, one or more factors are between-subjects, and the others are within-subjects. In the example below, <span class="math inline">\(A\)</span> is between-subjects but <span class="math inline">\(B\)</span> is within-subjects. This means that each level of <span class="math inline">\(A\)</span> has different subjects but each level of <span class="math inline">\(B\)</span> has the same subjects. An example of a mixed design would arise if, for example, we wanted to run our coffee and reading time experiment (discussed in chapter 5) on multiple first languages. Each subject could be tested at both coffee and decaf, making that factor within subjects, however, each subject would only be observed within a single first language group, making that factor between subjects.</p>
<p>Our model contains two predictors with two levels each, leading to four groups. Height judgments for these four groups are presented in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-5">7.5</a>. These four boxes correspond to the four cells in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-4">7.4</a>. The middle plot in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-5">7.5</a> compares height judgments across levels of gender (male vs. female). Since we have both adults and children within each gender group, each box in the plot is really the average of two of the boxes from the left plot in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-5">7.5</a> (boxes 1 and 3 vs. 2 and 4). This is equivalent to finding the average of one row in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-4">7.4</a>, and comparing it to the average of the other row.</p>
<div class="figure"><span style="display:block;" id="fig:F7-5"></span>
<img src="_main_files/figure-html/F7-5-1.jpeg" alt="(left) Distribution of apparent height judgments for apparent boys (b), girls (g), men (m), and women (w). (middle) Comparison of distributions based on whether the speaker is female or male. (right) Comparison distributions based on whether the speaker is an adult or child." width="4800" />
<p class="caption">
Figure 7.5: (left) Distribution of apparent height judgments for apparent boys (b), girls (g), men (m), and women (w). (middle) Comparison of distributions based on whether the speaker is female or male. (right) Comparison distributions based on whether the speaker is an adult or child.
</p>
</div>
<p>Similarly, the right plot in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-4">7.4</a> compares height judgments across levels of age (adult vs. child). Since we have both males and females within each gender group, each box in the plot is really the average of two of the boxes from the left plot in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-5">7.5</a> (boxes 1 and 2 vs. 3 and 4). This is equivalent to finding the average of one column in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-4">7.4</a>, and comparing it to the average of the other column. In this way, our model including two fixed effect predictors can use four groups to answer two questions simultaneously: What is the effect of apparent age on apparent height? What is the effect of apparent gender on apparent height?</p>
<div id="data-and-research-questions-1" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Data and research questions<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We load our data and packages again just in case:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (brms)</span>
<span id="cb10-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (bmmb)</span>
<span id="cb10-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&#39;contr.sum&#39;</span>,<span class="st">&#39;contr.sum&#39;</span>))</span>
<span id="cb10-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span> (exp_data)</span></code></pre></div>
<p>We’re going to use slightly different set of columns from our data this time, this time using <code>A</code> and <code>G</code> rather than <code>C</code>. The model in this section will use the following variables from our data frame:</p>
<ul>
<li><code>L</code>: A number from 1-15 indicating which <em>listener</em> responded to the trial.</li>
<li><code>height</code>: A number representing the <em>height</em> (in centimeters) reported for the speaker on each trial.</li>
<li><code>S</code>: A number from 1-139 indicating which <em>speaker</em> produced the trial stimulus.</li>
<li><code>G</code>: The <em>apparent gender</em> of the speaker indicated by the listener, <code>f</code> (female) or <code>m</code> (male).</li>
<li><code>A</code>: The <em>apparent age</em> of the speaker indicated by the listener, <code>a</code> (adult) or <code>c</code> (child).</li>
</ul>
<p>And we’re going to split the question we posed above into two questions:</p>
<p>(Q1) Does average apparent height differ across levels of apparent age?</p>
<p>(Q2) Does average apparent height differ across levels of apparent gender?</p>
</div>
<div id="description-of-the-model-2" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Description of the model<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#description-of-the-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In our previous model, we acted like we just had four different groups with no internal structure. Of course, we know that our groups differ systematically from each other in meaningful ways. For example, we might have chosen to fit two separate models investigating age and gender like this:</p>
<p><code>brm (height ~ A + (A|L) + (1|S)</code></p>
<p><code>brm (height ~ G + (G|L) + (1|S)</code></p>
<p>For several reasons (some of which we’ll see very soon), it’s preferable to fit a single model with both predictors at once, rather than fitting separate models for each one. Our model formula will now look like this, reflecting the influence of both predictors simultaneously:</p>
<p><code>height ~ A + G + (A + G|L) + (1|S)</code></p>
<p>This can be read like “apparent height is distributed according to effects for apparent adultness and gender, with random intercepts, age, and gender effects for each listener, and random intercepts for each speaker”. You may have noticed that our model no longer includes the <code>C</code> predictor. This is because the <code>C</code> label is perfectly predictable on the basis of <code>A</code> and <code>G</code> (i.e., as a female child, a member of the <code>g</code> group must have values of <code>f</code> and <code>c</code> for their <code>G</code> and <code>A</code> predictors). Basically, we have <em>decomposed</em> the four categories into two components to help us understand the effect of each. For example, the fixed effect predictors in our model were previously:</p>
<p><span class="math display" id="eq:7-2">\[
\begin{equation}
\begin{split}
\mu_{[i]} = \mathrm{Intercept} + (C_{[\mathrm{C}_{[i]}]})
\end{split}
\tag{7.3}
\end{equation}
\]</span></p>
<p>We can expand the term in parentheses as seen below. Since group can be exactly represented by combinations of gender and adult, our model sort of ‘secretly’ contained this more-complicated model inside of it.</p>
<p><span class="math display" id="eq:7-3">\[
\begin{equation}
\begin{split}
\mu_{[i]} = \mathrm{Intercept} + (A_{[\mathrm{A}_{[i]}]} + G_{[\mathrm{G}_{[i]}]})
\end{split}
\tag{7.4}
\end{equation}
\]</span></p>
<p>The above can be thought of as a ‘decomposition’ of the variance in your model by breaking it up into parts and assigning them to different sources. We have actually been doing this from the start by making more and more complicated models. Recall that our very first approach (in chapter 3) to understanding variation in apparent height treated all variation as error, and so did not ‘decompose’ anything. In chapter 4 we added between-listener and speaker variation to the model, and in chapter 5 we added apparent age. Now we include apparent age and gender, listener specific effects and intercepts, and speaker specific intercepts. There is a fixed amount of variation in our dependent variable. Every tiny bit of variance that these added components explain takes away from the data-level error variance (<span class="math inline">\(\sigma\)</span>), and potentially also from the other components that had previously been in the model. Our updated model description is provided in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-4">(7.5)</a>, again omitting the deterministic equation ‘building’ up <span class="math inline">\(\mathrm{\Sigma}\)</span>.</p>
<p><span class="math display" id="eq:7-4">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{t}(\nu, \mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{Intercept} + A + G + L_{[\mathsf{L}_{[i]}]} + A \colon L_{[\mathsf{L}_{[i]}]} + G \colon L_{[\mathsf{L}_{[i]}]} + S_{[\mathsf{S}_{[i]}]} \\ \\
\mathrm{Priors:} \\
S_{[\bullet]} \sim \mathrm{N}(0,\sigma_S) \\
\begin{bmatrix} L_{[\bullet]} \\ A \colon L_{[\bullet]} \\ G \colon L_{[\bullet]}  \end{bmatrix} \sim \mathrm{MVNormal} \left( \begin{bmatrix} 0 \\ 0 \\ 0 \\ \end{bmatrix}, \mathrm{\Sigma} \right) \\ \\
\mathrm{Intercept} \sim \mathrm{N}(156,12) \\
A, G \sim \mathrm{N}(0,12) \\
\sigma_L, \sigma_{A \colon L}, \sigma_{G \colon L}, \sigma_S \sim \mathrm{N}(0,12) \\
\sigma \sim \mathrm{N}(0,12) \\
\nu \sim \mathrm{gamma}(2, 0.1) \\
R \sim \mathrm{LKJCorr} (2)
\end{split}
\tag{7.5}
\end{equation}
\]</span></p>
<p>Our models have increasingly large numbers of priors, and many of these are the same. As a result, going forward we will place these on the same line when they have the same prior and represent the same sorts of parameters (in much the same way they are specified by the <code>class</code> parameter in the <code>set_prior</code> function). For example, the line <span class="math inline">\(\sigma_L, \sigma_{A \colon L}, \sigma_{G \colon L}, \sigma_S \sim \mathrm{N}(0,12)\)</span> specifies the prior probability of all standard deviation terms individually, but at the same time. In plain English this says:</p>
<blockquote>
<p>We are modeling apparent height as coming from a t distribution with unknown nu (<span class="math inline">\(\nu\)</span>), mean (<span class="math inline">\(\mu\)</span>), and scale (<span class="math inline">\(\sigma\)</span>) parameters. The expected value for any given trial (<span class="math inline">\(\mu\)</span>) is modeled as the sum of an intercept, an effect for apparent speaker age (<span class="math inline">\(A\)</span>) and gender (<span class="math inline">\(G\)</span>), a listener effect (<span class="math inline">\(L\)</span>), a listener dependent effect for apparent age (<span class="math inline">\(A \colon L\)</span>) and apparent gender (<span class="math inline">\(G \colon L\)</span>), and a speaker effect (<span class="math inline">\(S\)</span>). The speaker effects were drawn from a univariate normal distribution with a standard deviation (<span class="math inline">\(\sigma_S\)</span>) estimated from the data. The three listener effects were drawn from a multivariate normal distribution with individual standard deviations (<span class="math inline">\(\sigma_L,\sigma_{A \colon L},\sigma_{G \colon L}\)</span>) and a correlation matrix (<span class="math inline">\(R\)</span>) that was estimated from the data. The remainder of the ‘fixed’ effects and correlations were given prior distributions appropriate for their expected range of values.</p>
</blockquote>
</div>
<div id="fitting-and-interpreting-the-model-3" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Fitting and interpreting the model<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below we fit a model with the structure outlined in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-4">(7.5)</a>. We don’t need to change our priors because our new predictors are all covered by the classes of priors we have specified so far, and we think the priors we have been using thus far are still a good fit for our data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb11-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,156, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb11-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-3" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb11-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-4" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb11-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-5" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (2)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>), </span>
<span id="cb11-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-6" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;gamma(2, 0.1)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;nu&quot;</span>),</span>
<span id="cb11-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-7" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb11-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-9" aria-hidden="true" tabindex="-1"></a>model_both <span class="ot">=</span>  </span>
<span id="cb11-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-10" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> A <span class="sc">+</span> G <span class="sc">+</span> (A <span class="sc">+</span> G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), <span class="at">data =</span> exp_data, </span>
<span id="cb11-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">5000</span>, </span>
<span id="cb11-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb11-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">thin =</span> <span class="dv">4</span>, <span class="at">prior =</span> priors, <span class="at">family =</span> <span class="st">&quot;student&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb12-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb12-2" aria-hidden="true" tabindex="-1"></a>model_both <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;7_model_both.RDS&#39;</span>)</span></code></pre></div>
<p>We can inspect the model fixed effects:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect the fixed effects</span></span>
<span id="cb13-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb13-2" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">fixef</span> (model_both)</span>
<span id="cb13-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error    Q2.5   Q97.5</span></span>
<span id="cb13-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept  158.654    1.1947 156.319 161.025</span></span>
<span id="cb13-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## A1           9.979    1.2107   7.562  12.282</span></span>
<span id="cb13-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">## G1          -2.205    0.5524  -3.288  -1.124</span></span></code></pre></div>
<p>We now have two non-Intercept ‘Population-Level’ effects: <code>A1</code> and <code>G1</code>, representing the categories ‘adult’ and ‘female’ respectively. Remember that since we used sum coding and have only two levels for each factor, the effects for the groups that are not represented (‘child’, ‘male’) are just the opposite sign of the groups that <em>are</em> represented. Below, we calculate the mean apparent height of the four groups and find the grand mean of the four groups. We can see that this is very similar to our intercept.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept</span></span>
<span id="cb14-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span> (<span class="fu">tapply</span> (exp_data<span class="sc">$</span>height, exp_data<span class="sc">$</span>C, mean)) </span>
<span id="cb14-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 158</span></span></code></pre></div>
<p>Next we find the average apparent height for each level of adultness, find the difference between these, and divide it by negative two (just to flip the sign to match our effects). We also do the same for the levels of age. This tells us half the difference between our group means, and we can see that these values are reasonably similar to the estimated <code>A1</code> and <code>G1</code> predictors.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age effect</span></span>
<span id="cb15-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> (<span class="fu">tapply</span> (exp_data<span class="sc">$</span>height, exp_data<span class="sc">$</span>A, mean) ) <span class="sc">/</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb15-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">##     c </span></span>
<span id="cb15-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 12.16</span></span>
<span id="cb15-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender effect</span></span>
<span id="cb15-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> (<span class="fu">tapply</span> (exp_data<span class="sc">$</span>height, exp_data<span class="sc">$</span>G, mean) ) <span class="sc">/</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb15-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">##      m </span></span>
<span id="cb15-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -3.166</span></span></code></pre></div>
<p>We can recover the four original group means by adding up individual fixed effect coefficients. This can sometimes be tedious and requires you to be careful and methodical, but isn’t actually difficult. Remember that each of the four groups is uniquely identified by a combination of gender and adultness. This means that to recover the expected group means, we need to add the right combination of coefficients to the intercept. For example, the first hypothesis we test below (<code>Intercept + -A1 + -G1 = 0</code>) takes the intercept and adds the effect for ‘child’ (<code>-A1</code>). We use <code>-A1</code> and not <code>A2</code> (i.e. the second level of <code>A</code>) because our model does not contain a parameter called <code>A2</code>. This parameter is not estimated in our model because <code>-A1=A2</code>. So, if we want the value of <code>A2</code> we use <code>-A1</code>. Similarly, we add the effect for ‘male’ using <code>-G1</code>. Since we started with the overall mean apparent height (the intercept) and add the effects for ‘child’ and ‘male’, the hypothesis <code>Intercept + -A1 + -G1 = 0</code> estimates the group mean for ‘boys’.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-1" aria-hidden="true" tabindex="-1"></a>means_pred <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">short_hypothesis</span> (model_both, </span>
<span id="cb16-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="st">&quot;Intercept + -A1 + -G1 = 0&quot;</span>,  <span class="co"># boys</span></span>
<span id="cb16-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Intercept + -A1 +  G1 = 0&quot;</span>,  <span class="co"># girls </span></span>
<span id="cb16-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Intercept +  A1 + -G1 = 0&quot;</span>,  <span class="co"># men</span></span>
<span id="cb16-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Intercept +  A1 +  G1 = 0&quot;</span>)) <span class="co"># women</span></span>
<span id="cb16-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-7" aria-hidden="true" tabindex="-1"></a>means_pred</span>
<span id="cb16-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    Estimate Est.Error  Q2.5 Q97.5              hypothesis</span></span>
<span id="cb16-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="do">## H1    150.9    2.2410 146.6 155.3 (Intercept+-A1+-G1) = 0</span></span>
<span id="cb16-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="do">## H2    146.5    2.3680 142.0 151.2  (Intercept+-A1+G1) = 0</span></span>
<span id="cb16-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="do">## H3    170.8    1.2988 168.2 173.4  (Intercept+A1+-G1) = 0</span></span>
<span id="cb16-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="do">## H4    166.4    0.6901 165.0 167.8   (Intercept+A1+G1) = 0</span></span></code></pre></div>
<p>Below we compare our recreated group means with our average height judgment for each group. There is a reasonable similarity, however there also appear to be some important mismatches.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span> (exp_data<span class="sc">$</span>height, exp_data<span class="sc">$</span>C, mean)</span>
<span id="cb17-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     b     g     m     w </span></span>
<span id="cb17-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 146.9 145.0 174.5 165.6</span></span></code></pre></div>
<p>For example, we see that adult women and men differ in height by 9 cm in our data, while boys and girls by only 2 cm. So, it seems like the difference between males and females is smaller for children than for adults. However, according to our model men and women differ by about 4.4 cm, and so do and boys and girls. This discrepancy suggests that our model is potentially missing important information about our data.</p>
</div>
</div>
<div id="c7-posterior-prediction" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Posterior prediction: Using our models to predict new data<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-posterior-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far we’ve been working with very simple models and so we haven’t worried very much about how well they <em>fit</em>, or represent our data. Our reconstruction of the group means above suggests our current model may have some issues, and that we should be concerned about its ability to accurately capture the patterns in the data. So far we’ve only been discussing modeling in one direction, going from data to abstract, reduced representations (i.e. regression models). However, it’s also worth considering going in the other direction, from the abstract representation back towards data.</p>
<p>One way to see how well our model represents our data is to consider what data would be <em>generated</em> by the relationships represented in our model. Using your model in this way is called <strong>prediction</strong>, and you can use prediction to evaluate the fit of your model. The reasoning is basically, if your model is a good representation of the data, the ‘fake’ data it generates should look very much like your real data. If the fake data it generates doesn’t look like your real data, something about your model is slightly ‘off’. The discussion of prediction presented here will involve dependent variables that do not require a link function (discussed in chapter 10). Some of the details discussed here, in particular those involving expected values, do not exactly apply to models that require a link function.</p>
<p>All our models so far have contained lines like those seen in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-5">(7.6)</a>. These lines tell our models that: 1) We expect our data to be normally distributed given some mean and standard deviation, and 2) The mean for a given trial can be predicted using some combination of the independent variables.</p>
<p><span class="math display" id="eq:7-5">\[
\begin{equation}
\begin{split}
y_{[i]} \sim N (\mu_{[i]}, \sigma) \\
\mu_{[i]} = Intercept + A_{[\mathsf{A}_{[i]}]} + B_{[\mathsf{B}_{[i]}]} + C_{[\mathsf{C}_{[i]}]}
\end{split}
\tag{7.6}
\end{equation}
\]</span></p>
<p>The value of <span class="math inline">\(\mu\)</span> above is the expected value for a given trial. This is also sometimes called the <strong>linear predictor</strong>, or the <strong>conditional expectation function</strong> (in econometrics). Since the linear predictor is the value you expect for a trial, it’s obvious that there should be a reasonable correspondence between the linear predictor and your dependent variable. If what your model tells you to expect is not like what you actually observe, then what good is the model? One shortcoming of the linear predictor is that this does not incorporate the random trial-to-trial error (i.e., <span class="math inline">\(\sigma\)</span>) that you know is a part of your data. As a result, the linear predictor is constant for any single combination of dependent variables, and undersells the amount of variation that can be expected in a given data set.</p>
<p>The <strong>posterior predictive distribution</strong> is the distribution of possible data given your parameter estimates and probability model. In other words, the posterior predictive distribution uses your linear predictor, but also includes the data-level noise implied by the structure of your model. For normally distributed data, our posterior predictive distribution is the distribution of generated values of <span class="math inline">\(\tilde{y}\)</span> given estimates of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> as in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-7">(7.7)</a>. We use <span class="math inline">\(\tilde{y}\)</span> to represent <em>new</em> observations, as opposed to <span class="math inline">\(\hat{y}\)</span> which represents estimates of current data.</p>
<p><span class="math display" id="eq:7-7">\[
\begin{equation}
\begin{split}
\tilde{y}_{[i]} \sim N (\mu_{[i]}, \sigma) \\
\end{split}
\tag{7.7}
\end{equation}
\]</span></p>
<p>A <em>posterior predictive check</em> samples from the posterior predictive distribution with the intention of comparing these samples of <span class="math inline">\(\tilde{y}\)</span> to your original data <span class="math inline">\(y\)</span>. Posterior prediction can be used to assess how well your model fits your data. If your model really ‘gets’ your data, the fake data it generates (<span class="math inline">\(\tilde{y}\)</span> ) will have similar characteristics to your real data (<span class="math inline">\(y\)</span>). If the fake data your model generates looks substantially different from your real data, that suggests a fundamental misalignment between your model and your data.</p>
<p>You can get simple representations of your posterior predictive distribution using the <code>pp_check</code> function in <code>brms</code> as seen below. This function will compare the distribution of your new data (<span class="math inline">\(\tilde{y}\)</span>) to the distribution of your actual data. It compares density plots by default, though the user can select other sorts of plots.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb18-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(model_both)</span></code></pre></div>
<p>You can also use the <code>p_check</code> (predictive check) function in <code>brms</code> to make the same sorts of comparisons, though this function only compares densities. This function lets you hide or show your data in the plot, lets you specify the number of posterior samples you want, and also lets you specify the random effects formula when predicting. This function also returns a matrix containing the posterior predictions (<code>y_pred</code> below) where each row represents a different observation and each column represents a different posterior sample.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb19-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">p_check</span>(model_both, <span class="at">show_data =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The functions above are good for a ‘30,000-foot view’ of our posterior predictions. They show you when something big has gone wrong but may not let you see if something small goes wrong. To investigate nuances in your predictions, you may need to consider these using the same sort of plots you would use to interpret your real data, for example using a representation as seen in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-5">7.5</a>. The generic functions <code>fitted</code> and <code>predict</code> will help you get linear and posterior predictions from your <code>brm</code> model.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear predictor</span></span>
<span id="cb20-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb20-2" aria-hidden="true" tabindex="-1"></a>y_lin_pred <span class="ot">=</span> <span class="fu">fitted</span> (model_both)</span>
<span id="cb20-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior prediction</span></span>
<span id="cb20-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb20-5" aria-hidden="true" tabindex="-1"></a>y_post_pred <span class="ot">=</span> <span class="fu">predict</span> (model_both)</span></code></pre></div>
<p>In both cases the functions return four-column data frames with as many rows as the number of observations in the data. These data frames contain columns representing the mean, standard deviation and the upper and lower 95% credible intervals for each one of our data points. The reason we get intervals for our posterior predictions is because our model has a different prediction for each set of posterior samples. This means that if we have 4000 samples we actually have 4000 slightly different sets of parameter estimates and so 4000 slightly different predictions. So, in addition to information about the average prediction for each data point, we get information about variation around these estimates. We can see the (summarized) data frame representing our linear predictors.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear predictions</span></span>
<span id="cb21-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (y_lin_pred)</span>
<span id="cb21-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error  Q2.5 Q97.5</span></span>
<span id="cb21-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    156.8     2.182 152.5 161.0</span></span>
<span id="cb21-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    161.7     2.059 157.6 165.6</span></span>
<span id="cb21-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]    160.6     1.983 156.6 164.3</span></span>
<span id="cb21-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]    162.3     1.846 158.5 165.9</span></span>
<span id="cb21-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [5,]    163.0     1.992 159.0 167.0</span></span>
<span id="cb21-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [6,]    155.7     2.371 151.1 160.5</span></span></code></pre></div>
<p>And below we see the data frame corresponding to our posterior predictions. Note that although the means of the linear and posterior predictions are very similar, the intervals around the posterior predictions are noticeably wider. This is because the posterior predictions incorporate the data-level error (<span class="math inline">\(\sigma\)</span>) in their predictions. Another difference between the linear and posterior predictions is that the linear predictors are fixed for a given set of posterior samples. In contrast, every time you run the command <code>predict(model)</code> you will get slightly different results because these incorporate random error.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior predictions</span></span>
<span id="cb22-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (y_post_pred)</span>
<span id="cb22-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error  Q2.5 Q97.5</span></span>
<span id="cb22-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    156.7     8.020 141.2 171.8</span></span>
<span id="cb22-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    161.7     8.209 145.9 177.6</span></span>
<span id="cb22-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]    160.6     8.747 145.3 175.5</span></span>
<span id="cb22-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]    162.4     7.603 147.2 177.0</span></span>
<span id="cb22-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [5,]    163.0     7.887 147.6 178.0</span></span>
<span id="cb22-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [6,]    155.6     8.456 139.7 172.0</span></span></code></pre></div>
<p>For both kinds of predictions, you can also set <code>summary=FALSE</code> to get the individual (unsummarized) predictions. If you do this you get individual predictions for every set of posterior samples for your parameters, for every data point. So, if you have 1500 data points and 4000 posterior samples, the unsummarized output of these functions would be a matrix with 4000 rows and 1500 columns.</p>
<p>There’s a parameter for the <code>predict</code> function, <code>re_formula</code>, that determines which random effect terms are included in your prediction. By default this parameter is set to <code>NULL</code> meaning that your predictions will be made using your complete model formula. For example for our last model this means our posterior predictions reflect this model formula:</p>
<p><code>height ~ A + G + (A + G|S) + (1|L)</code></p>
<p>We can instead set <code>re_formula=NA</code> to make predictions using only the fixed effects as seen below.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb23-1" aria-hidden="true" tabindex="-1"></a>y_post_pred_no_re <span class="ot">=</span> <span class="fu">predict</span> (model_both, <span class="at">re_formula =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p>This corresponds to the predictions made by this model:</p>
<p><code>height ~ A + G</code></p>
<p>We could also include a subset of random effects, for example including only the listener random intercepts as seen below:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb24-1" aria-hidden="true" tabindex="-1"></a>y_post_pred_some_re <span class="ot">=</span> <span class="fu">predict</span> (model_both, <span class="at">re_formula =</span> <span class="st">&quot;~(1|L)&quot;</span>)</span></code></pre></div>
<p>This would generate predictions made by the following model:</p>
<p><code>height ~ A + G + (1|L)</code></p>
<p>Below we sample from the posterior distribution but ask for only a single (randomly chosen) prediction. We do this for our full model and for a model that makes only fixed effects predictions.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb25-1" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">=</span> <span class="fu">predict</span> (model_both, <span class="at">ndraws =</span> <span class="dv">1</span>)</span>
<span id="cb25-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb25-2" aria-hidden="true" tabindex="-1"></a>y_hat_no_re <span class="ot">=</span> <span class="fu">predict</span> (model_both, <span class="at">re_formula =</span> <span class="cn">NA</span>, <span class="at">ndraws =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>In figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-6">7.6</a> we compare the distribution of our data to our posterior predictive distributions, without and with the inclusion of random effects.</p>
<div class="figure"><span style="display:block;" id="fig:F7-6"></span>
<img src="_main_files/figure-html/F7-6-1.jpeg" alt="(left) Distribution of apparent height judgments according to apparent speaker category (boy, girl, man, woman) for our real data. (middle) Posterior predictions made by `model_both` without random effects (RE). (right) Posterior predictions made by `model_both` with random effects (RE)." width="4800" />
<p class="caption">
Figure 7.6: (left) Distribution of apparent height judgments according to apparent speaker category (boy, girl, man, woman) for our real data. (middle) Posterior predictions made by <code>model_both</code> without random effects (RE). (right) Posterior predictions made by <code>model_both</code> with random effects (RE).
</p>
</div>
<p>There are some differences in the ‘widths’ of the boxes, but we will not discuss this for now. Instead, we would like to highlight differences in the relative positions of the boxes representing the four groups across the plots. Our data shows different average heights for men and women but no noticeable height difference between boys and girls. Despite this, both sets of our posterior predictions show a difference in height between boys and girls. This is particularly evident in our fixed effects predictions since the random effects can help represent many of the idiosyncrasies of any given data set. As we will discuss in the following section, the structure of our data (and our world knowledge) suggests that there is an <em>interaction</em> between apparent gender and apparent age, meaning that we should include the interaction between these predictors in our model.</p>
</div>
<div id="c7-interactions-and-plots" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Interactions and interaction plots<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-interactions-and-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can think of a single effect representing a difference between groups/conditions/levels as a slope. For example, in the left plot in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a> we plot mean apparent height for apparent females and males at arbitrary x-axis locations. The difference in the group means is 6 cm (females 157 cm, males 163 cm). We can use any arbitrary x axis distance to calculate slopes, as long as we are consistent. However, there are obvious practical advantages to choosing to calculate these slopes over the arbitrary ‘distance’ of 1. To do this, we can imagine that we plot the first level (female) at 0 and successive levels at sequential integer values along the x axis (i.e. 1, 2, 3, …). When we do this, the line formed by joining the averages of these groups has a slope of 6 (i.e., it rises 6 cm from 0 to 1, from one group to another, for a slope of 6/1).</p>
<div class="figure"><span style="display:block;" id="fig:F7-7"></span>
<img src="_main_files/figure-html/F7-7-1.jpeg" alt="Plots showing different ways to consider average apparent height judgments across levels of apparent age and gender." width="4800" />
<p class="caption">
Figure 7.7: Plots showing different ways to consider average apparent height judgments across levels of apparent age and gender.
</p>
</div>
<p>The plot highlighting the effect of apparent gender on apparent height in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a> is a <em>main effects</em> plot. Main effects (discussed in chapter 6) are the effects of one predictor averaged across everything else. Saying ‘averaged across everything else’ basically means we are ignoring everything else in our model. A person looking only at the left plot in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a> would have no idea our data also investigates the effect of apparent adultness. We have ‘erased’ the differences in apparent adultness from our data by averaging across all levels of that factor. Another way to think of main effects is that they are <em>marginal effects</em>, the overall, average, <em>unconditional</em> differences between the levels of the factor. So, if someone asks you “whats the average difference in apparent height between apparent males and females?” you can respond “about 6 cm”. However, as noted in the previous chapter, sometimes the answer is not so simple, and it starts more like: “well… it depends”. Interactions represent situations like these, where the effect of one variable depends on, or is <em>conditional</em> on, the value of some other variable.</p>
<p>The idea of conditional effects (interactions) may <em>feel</em> complicated, but it is something we all understand intuitively. For example, how much will a given person grow in height in the next 5 years? What if I told you that one person is 1 and the other is 60? You <em>know</em> that makes a difference, which is to say, that you <em>know</em> there is an interaction between age and rate of growth. In other words, the expected relationship between time and growth is different for young children and grown adults. Anyone who understands these varying effects <em>understands</em> interactions, whether or not they know how to relate this concept to the mathematical formalisms used to implement these in regression models.</p>
<p>To understand interactions we need to talk about <strong>simple effects</strong> or <strong>simple main effects</strong>, the effects of a factor at one specific level of another factor. Basically, main effects show you the overall effect for a factor and simple effects show you the effects of the factor <em>depending</em> on the value of other things. We split the single (main) effect for gender into two simple (main) effects of gender across the levels of apparent age, presented in the second plot in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a>. We can see clearly that the lines do not have the same slope, indicating the effect for gender varies across the levels of apparent age.</p>
<p>The second and fourth plots in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a> are sometimes called <strong>interaction plots</strong>. Knowing how to interpret interaction plots is extremely useful because they help you quickly understand the nature of any interactions in your data. Interaction plots show you the simple main effects of one predictor across the levels of the other. They do this by having one factor vary across the x-axis and using different lines for the levels of the other factor. For example in the second plot gender varies across the x axis and different lines are used for the levels of age, and in the fourth plot age varies across the x axis and different lines are used for gender. Note however that the same information is presented in the two interaction plots in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a>, it is just presented differently in each case. In fact, we can see that the y-axis values of the four line endpoints are equal across the two plots. The slopes of the lines in the second plot correspond to the differences between line endpoints in the fourth plot; one is small and one is near zero. The differences between the line endpoints in the second plot are the slopes of the fourth plot, both are large but one is larger.</p>
<p>Imagine what would happen if we began with a main effect plot like the first plot in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a>, and added/subtracted a single value to each end of the line segment. This single value could represent the main effect of some other factor, for example the main effect for apparent age. Since a single number would be added to both points on the line, the line representing the effect of apparent gender would <em>slide</em> up/down the y-axis, however, the line would not change its slope. We might imagine trying to slide the line in the first plot in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a> up and down the y axis to try to get it to match the simple effects presented in the second plot of the same figure. However, we will not be successful because these two lines do not share a slope. In order to make the lower and upper lines <em>not</em> be parallel, we need to add different values to each side of the main effects line.</p>
<p>The varying effect for apparent gender at different levels of apparent age indicates that these effects <em>interact</em> in our data. Interactions between our factors are detectable visually in the form of a lack of parallel lines in interaction plots (i.e. varying slopes in the simple effects). In the absence of an interaction, all lines in such a plot should be parallel, save for variation due to random error. We can see that the lines in the second and fourth plots in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-7">7.7</a> are <em>not</em> parallel, suggesting an interaction between apparent age and gender in our data. In the absence of an interaction, we could just answer the question “whats the average difference between apparent height between males and females?” with a number like 6 cm. In the presence of an interaction we need to consider the <em>conditional effects</em> of each predictor at the levels of the other predictor (i.e., the simple effects). So, the most important thing to remember about interpreting main effects is:</p>
<ul>
<li><p>If there are no interactions between factors, focus on main effects.</p></li>
<li><p>If there are interactions between factors, you must inspect the simple effects to understand the nature of the interaction.</p></li>
</ul>
</div>
<div id="investigating-interactions-with-a-model" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Investigating interactions with a model<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#investigating-interactions-with-a-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-6">7.6</a> we made posterior predictions of our data with and without the inclusion of the speaker random effects, and presented these as boxplots. We present these same predictions as interaction plots in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-8">7.8</a>. We can see in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-8">7.8</a> that the predictions made using only fixed effects (middle plot) are systematically wrong, and that the problem with our predictions is that our predicted lines are parallel, while those for our real data are not. As we’ve just discussed, in the absence of interactions, interaction plots contain only parallel lines. Since our model (<code>model_both</code>) does not include interaction terms it cannot represent interactions, and so is only capable of making predictions along parallel lines. This means our model is not capable of representing the pattern in our data using only fixed effects.</p>
<div class="figure"><span style="display:block;" id="fig:F7-8"></span>
<img src="_main_files/figure-html/F7-8-1.jpeg" alt="Interaction plots comparing our real data to posterior predictions, with and without random effects (RE). In each case the top line represents height judgments for apparent males." width="4800" />
<p class="caption">
Figure 7.8: Interaction plots comparing our real data to posterior predictions, with and without random effects (RE). In each case the top line represents height judgments for apparent males.
</p>
</div>
<p>We can see that when random effects are included, prediction is better. This is not surprising since the listener and speaker-specific intercept adjustments allow for deviations from the fixed effects predictions to still be captured by the model. However, if accurate prediction is only possible using random effects, that limits the generalizability of our model to new levels of the grouping variable, e.g. subject or listener. In other words, the absence of good fixed-effects prediction limits the generalizability of our model and may be a cause for concern.</p>
<p>Our model is a little universe we made up, and it only includes the information, and structures, we included in it. This ‘universe’ only contains parallel lines because we only gave it that capability. So, the fact that our model generates parallel lines does not in any way ‘prove’ that the lines are parallel, because they were bound to be. This is a little bit like taking black and white photographs and then using this as evidence that the scene does not contain color. In order to properly investigate whether the lines are parallel, the model must be built in a way that allows it to (at least potentially) represent the interactions in our data, i.e., to represent lines that are <em>not</em> parallel.</p>
<p>Before fitting a model with an interaction term we want to remind you that you cannot estimate interactions between factors that are not crossed: If you did not observe all combinations of factor levels, you are not in a position to talk about how effects vary for those combinations. So, it is extremely important to be sure to only include interactions in your model when these predictors are <em>crossed</em>, or your model may run into all sorts of problems.</p>
<div id="data-and-research-questions-2" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Data and research questions<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We load our data and packages again (again) just in case:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (brms)</span>
<span id="cb26-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (bmmb)</span>
<span id="cb26-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&#39;contr.sum&#39;</span>,<span class="st">&#39;contr.sum&#39;</span>))</span>
<span id="cb26-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span> (exp_data)</span></code></pre></div>
<p>We’re going to a use the very same variables from our data frame that we used in the previous model. These are:</p>
<ul>
<li><code>L</code>: A number from 1-15 indicating which <em>listener</em> responded to the trial.</li>
<li><code>height</code>: A number representing the <em>height</em> (in centimeters) reported for the speaker on each trial.</li>
<li><code>S</code>: A number from 1-139 indicating which <em>speaker</em> produced the trial stimulus.</li>
<li><code>G</code>: The <em>apparent gender</em> of the speaker indicated by the listener, <code>f</code> (female) or <code>m</code> (male).</li>
<li><code>A</code>: The <em>apparent age</em> of the speaker indicated by the listener, <code>a</code> (adult) or <code>c</code> (child).</li>
</ul>
<p>And we’re going to address our two previous research questions, and add one more:</p>
<p>(Q1) Does average apparent height differ across levels of apparent age?</p>
<p>(Q2) Does average apparent height differ across levels of apparent gender?</p>
<p>(Q3) Is there an interaction between the effects of apparent gender and age on apparent height?</p>
</div>
<div id="model-formulas" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Model formulas<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#model-formulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The model presented above (<code>model_both</code>) requires only a slight tweak to include the interaction in our data. There are two ways to include interactions in R model formulas, either:</p>
<p><code>height ~ A + G + A:G + (A + G + A:G|L) + (1|S)</code></p>
<p>Or:</p>
<p><code>height ~ A * G + (A * G|L) + (1|S)</code></p>
<p>The first way includes an explicit interaction term, <code>A:G</code>. The syntax for these is <code>X:Z</code> for an interaction between effects <code>X</code> and <code>Z</code>, <code>W:X:Z</code> for a three-way interaction, and so on. The second way uses <code>*</code> between our two predictors. This tells R to include those predictors, and all the interactions between them. This can be much faster than specifying all interactions, but you lose control over which ones you include. For example, this formula:</p>
<p><code>y ~ Z * X * W</code></p>
<p>Implies this one:</p>
<p><code>y ~ Z + X + W + Z:X + Z:W + X:W + Z:X:W</code></p>
<p>But cannot represent this one (since it omits the <code>Z:W</code> interaction):</p>
<p><code>y ~ Z + X + W + Z:X + X:W + Z:X:W</code></p>
<p>Actually, we could represent the model above using the following formula:</p>
<p><code>y ~ Z * X * W - Z:W</code></p>
<p>Where we use <code>-</code> to remove specific terms from the model formula. We can also use parentheses in model formulas to organize our interactions as in the following formula:</p>
<p><code>y ~ (Z + X) * W</code></p>
<p>Which is equivalent to:</p>
<p><code>y ~ Z + X + W + Z:W + X:W</code></p>
<p>We can also use <code>^</code> to find all interactions up to a certain order/degree, as in:</p>
<p><code>y ~ (Z + X + W)^2</code>
<code>y ~ (Z + X + W)^3</code></p>
<p>Which are equivalent to:</p>
<p><code>y ~ Z + X + W + Z:X + Z:W + X:W</code>
<code>y ~ Z + X + W + Z:X + Z:W + X:W + Z:X:W</code></p>
<p>Finally, all of this applies to both our fixed and random effects predictors as in the following possible formula:</p>
<p><code>y ~ (Z + X) * W * V - W:V:X + ((Z + X) * W * V - W:V:X|L)</code></p>
<p>In our formulas, the <code>:</code> and <code>|</code> both basically mean <em>given</em>, and indicate that conditional effects are being estimated. The difference between these is syntactic, much like the difference in R between <code>[]</code> and <code>()</code>. A colon (<code>:</code>) is used to indicate interactions between ‘fixed’ effects, that is effects estimated using fixed prior distributions. The pipe (<code>|</code>) indicates that the formula to its left is being estimated for each level of the predictor to the right of the pipe, and that this estimation is being carried out using adaptive partial pooling. In the formula above, the use of <code>:</code> and <code>|</code> for different purposes makes <code>((Z + X) * W * V - W:V:X|L)</code> interpretable: It means that, effectively, sub-models equivalent to <code>(Z + X) * W * V - W:V:X</code> will be fit for each level of <code>L</code>.</p>
</div>
<div id="description-of-our-model-1" class="section level3 hasAnchor" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Description of our model<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#description-of-our-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our full model specification is presented in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-8">(7.8)</a>, once again omitting the equation specifying <span class="math inline">\(\mathrm{\Sigma}\)</span>. The model now includes an <em>interaction</em> term (<span class="math inline">\(A \colon G\)</span>) that can help explain variation that cannot be explained by the independent effects of adultness and gender. This interaction term helps us model the <em>conditional</em> effect of one predictor given the other. Our model also actually contains a three-way interaction as well (<span class="math inline">\(A \colon G \colon L_{[\mathsf{L}_{[i]}]}\)</span>), though it may not seem that way to us superficially. This is the ‘random’ effect of the interaction between <span class="math inline">\(A\)</span> and <span class="math inline">\(G\)</span> for each level of listener, <code>(A:G|L)</code> in our model. This is a three-way interaction because it represents the interaction between the two-way interaction of <span class="math inline">\(A\)</span> and <span class="math inline">\(G\)</span> with our listener factor: The listener dependent two-way interaction between <span class="math inline">\(A\)</span> and <span class="math inline">\(G\)</span>.</p>
<p><span class="math display" id="eq:7-8">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{t} (\nu, \mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{Intercept} + A + G + A \colon G + \\
L_{[\mathsf{L}_{[i]}]} + A \colon L_{[\mathsf{L}_{[i]}]} + G \colon L_{[\mathsf{L}_{[i]}]} + A \colon G \colon L_{[\mathsf{L}_{[i]}]} + S_{[\mathsf{S}_{[i]}]} \\ \\
\mathrm{Priors:} \\
S_{[\bullet]} \sim \mathrm{t}(3,0,\sigma_S) \\
\begin{bmatrix} L_{[\bullet]} \\ A \colon L_{[\bullet]} \\ G \colon L_{[\bullet]} \\ A \colon G \colon L_{[\bullet]} \end{bmatrix} \sim \mathrm{MVNormal} \left( \begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \\ \end{bmatrix}, \mathrm{\Sigma} \right) \\ \\
\\
\mathrm{Intercept} \sim \mathrm{t}(3,156,12) \\
A, G, A \colon G \sim \mathrm{t}(3,0,12) \\
\sigma_L, \sigma_{A \colon L}, \sigma_{G \colon L}, \sigma_{A \colon G \colon L}, \sigma_S \sim \mathrm{t}(3,0,12) \\
\sigma \sim \mathrm{t}(3,0,12) \\
\nu \sim \mathrm{gamma}(2, 0.1) \\
R \sim \mathrm{LKJCorr} (2)
\end{split}
\tag{7.8}
\end{equation}
\]</span></p>
<p>Our updated plain English description now says:</p>
<blockquote>
<p>We are modeling apparent height as coming from a t distribution with unknown nu (<span class="math inline">\(\nu\)</span>), mean (<span class="math inline">\(\mu\)</span>), and scale (<span class="math inline">\(\sigma\)</span>) parameters. The expected value for any given trial (<span class="math inline">\(\mu\)</span>) is modeled as the sum of an intercept, an effect for apparent speaker age (<span class="math inline">\(A\)</span>), gender (<span class="math inline">\(G\)</span>), and their interaction (<span class="math inline">\(A \colon G\)</span>), a listener effect (<span class="math inline">\(L\)</span>), a listener dependent effect for apparent age (<span class="math inline">\(A \colon L\)</span>), apparent gender (<span class="math inline">\(G \colon L\)</span>), their interaction (<span class="math inline">\(A \colon G \colon L\)</span>), and a speaker effect (<span class="math inline">\(S\)</span>). The speaker effects were drawn from a univariate normal distribution with a standard deviation (<span class="math inline">\(\sigma_S\)</span>) estimated from the data. The four listener effects were drawn from a multivariate normal distribution with individual standard deviations (<span class="math inline">\(\sigma_L,\sigma_{A \colon L},\sigma_{G \colon L},\sigma_{A \colon G \colon L}\)</span>) and a correlation matrix (<span class="math inline">\(R\)</span>) that was estimated from the data. The remainder of the ‘fixed’ effects and correlations were given prior distributions appropriate for their expected range of values.</p>
</blockquote>
<p>Before continuing, we want to address the fact that we’ve included the same structure in our ‘fixed effects’ as for our listener ‘random effects’. We will do this for all the models we fit in this book whenever possible. There are a couple of reasons for this, and we will discuss these with respect to the ‘random effect’ of apparent age by listener (i.e. the <span class="math inline">\(A \colon L\)</span> interaction). Not including this predictor is equivalent to setting it to zero for all listeners (and setting <span class="math inline">\(\sigma_{A \colon L}=0\)</span>), meaning we expect the effect for apparent age to be the same across all levels of listener. However, we saw in the previous chapter that this is not the case and that there is substantial variation in the effect for apparent age across listeners. So, omitting random effects relies on the assumption that the variation across listeners (or whatever variable defines the random effects) is equal to zero, which may not be well founded a priori.</p>
<p>Furthermore, in chapter 6 we fit models with and without random effects and saw that the model <em>with</em> random effects produced substantially wider credible intervals for the apparent age ‘fixed’ effect, reflecting increased uncertainty in the parameter estimate. In that case, assuming listener-variation in the parameter was zero when it was not resulted in an overly precise estimate of the apparent age parameter. So, we see that omitting random effects means assuming they are equal to zero, and can affect the amount of uncertainty we get in our resulting parameter estimates. The only way to know whether a listener-dependent parameter shows substantial variation or not is to include the possibility for listener-dependent variation in your model, at least initially. Of course, the inclusion of any ‘random effect’ in your model assumes that: 1) Your model is designed in a way that the ‘random’ effect can be estimated, and 2) You have enough data to estimate those parameters. These issues will be discussed further in chapter 11.</p>
</div>
<div id="fitting-and-interpreting-the-model-4" class="section level3 hasAnchor" number="7.6.4">
<h3><span class="header-section-number">7.6.4</span> Fitting and interpreting the model<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below we fit the model including an interaction term. Remember that the line <code>set_prior("student_t(3, 0, 12)", class = "b")</code> sets the prior for all non-intercept ‘Population-Level’ predictors (i.e. fixed effects). This includes all of our main effects predictors and our interaction terms.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb27-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,156, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb27-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-3" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb27-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-4" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb27-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-5" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (2)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>), </span>
<span id="cb27-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-6" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;gamma(2, 0.1)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;nu&quot;</span>),</span>
<span id="cb27-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-7" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb27-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-9" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">=</span>  </span>
<span id="cb27-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-10" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G <span class="sc">+</span> (A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), </span>
<span id="cb27-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb27-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb27-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">thin =</span> <span class="dv">4</span>, <span class="at">prior =</span> priors, <span class="at">family =</span> <span class="st">&quot;student&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb28-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb28-2" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;7_model_interaction.RDS&#39;</span>)</span></code></pre></div>
<p>We are primarily interested in discussing interactions, but we want to spend a moment looking at the listener random effects in our model, since there are now several.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect fixed effects</span></span>
<span id="cb29-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-2" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">short_summary</span> (model_interaction)</span>
<span id="cb29-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula:  height ~ A + G + A:G + (A + G + A:G | L) + (1 | S)</span></span>
<span id="cb29-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects:</span></span>
<span id="cb29-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ~L (Number of levels: 15)</span></span>
<span id="cb29-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb29-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)            4.24      0.79     2.96     6.03</span></span>
<span id="cb29-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(A1)                   4.47      0.85     3.13     6.42</span></span>
<span id="cb29-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(G1)                   2.10      0.49     1.37     3.22</span></span>
<span id="cb29-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(A1:G1)                1.34      0.36     0.76     2.13</span></span>
<span id="cb29-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,A1)       -0.71      0.13    -0.90    -0.38</span></span>
<span id="cb29-13"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,G1)       -0.20      0.22    -0.59     0.24</span></span>
<span id="cb29-14"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(A1,G1)              -0.24      0.21    -0.62     0.20</span></span>
<span id="cb29-15"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,A1:G1)     0.17      0.23    -0.29     0.58</span></span>
<span id="cb29-16"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(A1,A1:G1)           -0.02      0.23    -0.46     0.43</span></span>
<span id="cb29-17"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(G1,A1:G1)           -0.34      0.24    -0.74     0.18</span></span>
<span id="cb29-18"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-19"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ~S (Number of levels: 139)</span></span>
<span id="cb29-20"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb29-21"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)     2.36      0.31     1.79     2.99</span></span>
<span id="cb29-22"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-23"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects:</span></span>
<span id="cb29-24"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb29-25"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   158.46      1.12   156.22   160.62</span></span>
<span id="cb29-26"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="do">## A1           10.78      1.21     8.39    13.15</span></span>
<span id="cb29-27"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="do">## G1           -2.87      0.60    -4.07    -1.72</span></span>
<span id="cb29-28"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="do">## A1:G1        -1.64      0.41    -2.44    -0.81</span></span>
<span id="cb29-29"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-30"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters:</span></span>
<span id="cb29-31"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb29-32"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma     5.01      0.16     4.70     5.34</span></span>
<span id="cb29-33"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="do">## nu        3.44      0.33     2.87     4.15</span></span></code></pre></div>
<p>We can see in the short model summary above that we’ve estimated four standard deviation terms for our listener-dependent predictors. These correspond to <span class="math inline">\(\sigma_{L}\)</span> (<code>sd(Intercept)</code>), <span class="math inline">\(\sigma_{A \colon L}\)</span> (<code>sd(A1)</code>), <span class="math inline">\(\sigma_{G \colon L}\)</span> (<code>sd(G1)</code>), and <span class="math inline">\(\sigma_{A \colon G \colon L}\)</span> (<code>sd(A1:G1)</code>). We’ve also estimated six correlation terms for our listener random effects. Recall that our random effects are drawn from a multivariate normal distribution. We have four terms which means this four-dimensional distribution is associated with a 4$$4 correlation matrix and 16 correlation terms. Of the correlations, four (on the main diagonal) equal one and can be ignored. This leaves 12 terms. Of these, only half are unique because the correlation of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> equals the correlation of <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>. This is how we end up with six estimated correlations for our four listener-dependent predictors.</p>
<p>We can now focus on the fixed effects (<code>Population-Level Effects</code>), of which there are four: An intercept, two main effects terms and an interaction. The interaction term is just another element of your prediction equation intended to help explain variation that can’t be predicted by the main effects of predictors involved in the interaction. If there is no interaction in your data, then the value of the interaction term will be close to zero and your model will look just as if you had not included the interaction at all. A look at the model output above indicates that our interaction is much smaller than the age effect, but not much smaller than the gender effect. This suggests it has the potential to influence our conclusions about gender more than our conclusions about age.</p>
<p>Why is there only a single interaction? Basically for the same reason that we can only estimate a single effect for apparent age and gender (i.e., linear dependence, discussed in section <a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-contrasts">5.6</a> and <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-identifiability">8.8</a>). The number of levels of a factor that you can estimate is generally one fewer than the number of levels in the factor. For interaction terms, the number of parameters you can estimate is equal to (number of levels of factor A - 1)<span class="math inline">\(\times\)</span>(number of levels of factor B - 1) for two factors. Since each of our factors have two levels, we can only estimate one parameter, <span class="math inline">\((2-1) \times (2-1)=1\)</span>.</p>
<p>The <code>A1:G1</code> term can be read aloud as “the effect of <code>A1</code> given (conditional on) the level of <code>G1</code>”. For individual factors, our models cannot estimate <code>A2</code> because <code>-A1 = A2</code>. For interactions between factors with two levels, the model cannot estimate <code>A2:G1</code> because <code>-A1:G1 = A2:G1</code>. For interactions between factors with two levels, every time you want to change <code>A1</code> or <code>G1</code> to <code>A2</code> or <code>G2</code> you flip the sign of the <code>A1:G1</code> term instead. As a result, going left to right and changing one level at a time we get <code>A1:G1 = -A2:G1 = A2:G2  = -A1:G2</code>, which is precisely why we can’t estimate more than one interaction for this model. Why does this happen? Looking at how interaction plots are built up out of main effects and interactions may help illustrate the reason for this.</p>
<p>Figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-9">7.9</a> presents an example of how our interaction plot can be built up from the components in our fixed effects above, and is very useful for understanding the geometry of main effects and interactions. In the top left plot we see that the intercept lifts up a line from 0 to the level of the overall mean apparent height of 158 cm. Then, the effect for <code>A1</code> (adult, +11 cm) and <code>-A1</code> (children, -11 cm) are added to this value, causing the separation between the lines indicating a ‘main effect’ for adultness. Notice that the lines are parallel with respect to each other, and also parallel to the x-axis. This is because we have not added an effect for gender, which will be indicated as a slope along the x axis. In the middle plot in the top row we see the addition of the gender effect: <code>G1</code> (female, -2.8 cm), and <code>-G1</code> (male, 2.8 cm). Notice that the effect is added to one end of each line segment and subtracted from the other end of the line segment. This is what causes a (single) slope along the x axis for both lines. The right plot in the top row shows the addition of all of the effects shown in the top row, the result of a model that includes both main effects but the same non-zero slope for both lines (i.e. no interaction yet).</p>
<div class="figure"><span style="display:block;" id="fig:F7-9"></span>
<img src="../wrong_plots/Figure 7.9.jpg" alt="An interaction plot built up from its individual components." width="100%" />
<p class="caption">
Figure 7.9: An interaction plot built up from its individual components.
</p>
</div>
<p>In the middle plot in the bottom row of figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-9">7.9</a>, we add the gender interaction <code>A1:G1</code>, which was -1.6 cm, to each end point for both lines. Notice that the interaction effect has different signs when added to the same line, and also for each end of each line segment. In each case, the sign is determined by the specific speaker category it is applied to. For example, we know that <code>A1:G1</code> represents female adults (top left point). So, we flip the sign for adult children in the bottom-left point (i.e. <code>-A1:G1 = A2:G1</code>), and we flip the sign again for male children in the bottom right point (i.e. <code>A1:G1 = A2:G2</code>). The sign flips result in opposing interactions at each x axis position across lines, but also for different endpoints along the same line. We can see that beginning with the parallel lines in bottom-left, the interaction added in the bottom middle plot constitutes an equal ‘pinch’ of one end of the lines and a spreading of the other side of the lines. This equal pinch and spreading is necessary in order to maintain the same average slope across both lines (the gender main effect) and the same average spacing between both ends of the lines (the age main effect). This is effectively why we get only a single interaction term in a model with this fixed effects structure.</p>
</div>
<div id="c7-calc-means" class="section level3 hasAnchor" number="7.6.5">
<h3><span class="header-section-number">7.6.5</span> Caulculating group means in the presence of interactions<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-calc-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recovering the predicted group means using the model coefficients is straightforward, but can be tedious for larger models: We must now either add or subtract the value of the interaction term (<code>A1:G1</code>) from each group as determined by the combination of main effects. We can easily determine which to do for this model because the sign on the interaction term is the product of the signs on the relevant ‘main effects’ terms. So, two positive or negative main effects result in a positive interaction term, while mismatched positive and negative main effects result in a negative interaction.</p>
<p>Below, we use <code>short_hypothesis</code> to reconstruct expected group means given the model fixed effects. The fourth hypothesis we’re testing below is the simplest to understand, so we will start there. This hypothesis asks whether the sum of the <code>Intercept</code>, <code>A1</code> (the effect for adultness), <code>G1</code> (the effect for femaleness), and <code>A1:G1</code> (the interaction of adult and female), is equal to zero. Because of the specific parameters we combined, this results in the comparison of the mean height for women to zero. The first hypothesis below says <code>Intercept + -A1 + -G1 + A1:G1 = 0</code>. Since we flipped the sign on <code>A1</code> and <code>G1</code>, these now correspond to the effects of ‘child’ and ‘male’ (i.e. boy). Since both <code>A1</code> and <code>G1</code> are negative, we flip the sign on the interaction term twice and it remains positive. Note that for all of our hypotheses below, the sign on the interaction terms always depends on the signs of the corresponding main effects terms.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept, boys, girls, men, women</span></span>
<span id="cb30-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb30-2" aria-hidden="true" tabindex="-1"></a>means_pred_interaction <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">short_hypothesis</span> (</span>
<span id="cb30-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  model_interaction, </span>
<span id="cb30-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Intercept + -A1 + -G1 +  A1:G1 = 0&quot;</span>,  <span class="co"># boys</span></span>
<span id="cb30-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Intercept + -A1 +  G1 + -A1:G1 = 0&quot;</span>,  <span class="co"># girl</span></span>
<span id="cb30-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Intercept +  A1 + -G1 + -A1:G1 = 0&quot;</span>,  <span class="co"># men</span></span>
<span id="cb30-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Intercept +  A1 +  G1 +  A1:G1 = 0&quot;</span>)) <span class="co"># women</span></span></code></pre></div>
<p>Below we compare the actual mean apparent height for each group to the predictions made without and with an interaction term. We can see that in each case, the prediction made by the model with an interaction are closer to the data means than those made by the model without an interaction. In addition, the predictions made including an interaction finally do reflect the fact that the difference in apparent height between apparent boys and girls is much smaller than that between apparent men and women.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># actual data means</span></span>
<span id="cb31-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span> (exp_data<span class="sc">$</span>height, exp_data<span class="sc">$</span>C, mean)</span>
<span id="cb31-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">##     b     g     m     w </span></span>
<span id="cb31-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 146.9 145.0 174.5 165.6</span></span>
<span id="cb31-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions with no interaction term</span></span>
<span id="cb31-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-7" aria-hidden="true" tabindex="-1"></a>means_pred[,<span class="dv">1</span>]</span>
<span id="cb31-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 150.9 146.5 170.8 166.4</span></span>
<span id="cb31-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions with interaction term</span></span>
<span id="cb31-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-11" aria-hidden="true" tabindex="-1"></a>means_pred_interaction[,<span class="dv">1</span>]</span>
<span id="cb31-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 148.9 146.4 173.8 164.7</span></span></code></pre></div>
</div>
<div id="calculating-simple-effects-in-the-presence-of-interactions" class="section level3 hasAnchor" number="7.6.6">
<h3><span class="header-section-number">7.6.6</span> Calculating simple effects in the presence of interactions<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#calculating-simple-effects-in-the-presence-of-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We know that we have an interaction in our data, and that this interaction needs to be investigated by considering the simple effects for each factor. Below we use <code>short_hypothesis</code> to find the simple effects of age across levels of gender, and of gender across levels of age. To recover the simple effect for a predictor, we add the main effect term to the appropriate interaction term (including the appropriate sign). To figure out which sign to use, you just need to think about which group is referred to by each interaction. For example, in the first line below we add <code>A1</code>, the age main effect, to <code>A1:G1</code>. Since it has a <code>G1</code> in it and we are adding and not subtracting, we know this refers to female speakers. As a result, <code>A1 + A1:G1</code> results in the simple effect for apparent age for apparent females. In the second line we again use <code>A1</code> but now add <code>-A1:G1</code>, which we know is equal to <code>A1:G2</code> (which does not exist). As a result, <code>A1 - A1:G1</code> results in the simple effect of apparent age for apparent males.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept, boys, girls, men, women</span></span>
<span id="cb32-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-2" aria-hidden="true" tabindex="-1"></a>simple_effects <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">short_hypothesis</span> (</span>
<span id="cb32-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  model_interaction, </span>
<span id="cb32-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;A1 + A1:G1 = 0&quot;</span>,  <span class="co"># effect for apparent age for adults (G1)</span></span>
<span id="cb32-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;A1 - A1:G1 = 0&quot;</span>,  <span class="co"># effect for apparent age for children (-G1)</span></span>
<span id="cb32-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;G1 + A1:G1 = 0&quot;</span>,  <span class="co"># effect for apparent gender for adults (A1)</span></span>
<span id="cb32-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;G1 - A1:G1 = 0&quot;</span>)) <span class="co"># effect for apparent gender for children (-A1)</span></span>
<span id="cb32-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions with interaction term</span></span>
<span id="cb32-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-10" aria-hidden="true" tabindex="-1"></a>simple_effects</span>
<span id="cb32-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="do">##    Estimate Est.Error   Q2.5   Q97.5     hypothesis</span></span>
<span id="cb32-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="do">## H1    9.142    1.2792  6.639 11.5977 (A1+A1:G1) = 0</span></span>
<span id="cb32-13"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="do">## H2   12.424    1.2707  9.938 14.9913 (A1-A1:G1) = 0</span></span>
<span id="cb32-14"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="do">## H3   -4.514    0.6174 -5.731 -3.3177 (G1+A1:G1) = 0</span></span>
<span id="cb32-15"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="do">## H4   -1.232    0.8192 -2.860  0.3919 (G1-A1:G1) = 0</span></span></code></pre></div>
<p>We will provide a verbal description of the calculations involved in estimating simple effects. We will use our fixed effects estimates, rounded to make the discussion easier to follow. We’ve previously warned against averaging parameters first and combining them second. However, this approach can be useful for a quick investigation of our model parameters and is fine for our purposes.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span> (brms<span class="sc">::</span><span class="fu">fixef</span> (model_interaction))</span>
<span id="cb33-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error Q2.5 Q97.5</span></span>
<span id="cb33-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept      158         1  156   161</span></span>
<span id="cb33-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="do">## A1              11         1    8    13</span></span>
<span id="cb33-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="do">## G1              -3         1   -4    -2</span></span>
<span id="cb33-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="do">## A1:G1           -2         0   -2    -1</span></span></code></pre></div>
<p>First, we will calculate the simple effects for apparent age at the levels of apparent gender. The average apparent height across all groups is 158 cm. There is an age-based 11 cm deviation from the intercept, meaning the difference between apparent adults and children is 22 cm (11 <span class="math inline">\(\cdot\)</span> 2). This means that the averages for apparent adults and children are about 169 and 147 cm (158 ± 11). However, the <code>A1:G1</code> interaction is -2 cm. This means that when the speaker was identified as female (<code>G1</code>), the affect for adultness decreased from 11 cm to 9 cm (11 - 2, <code>A1+A1:G1</code>), meaning the difference across women and girls was 18 cm (2 <span class="math inline">\(\cdot\)</span> 9). In contrast, when the speaker was identified as male (<code>-G1</code>), the affect for adultness increased from 11 cm to 13 cm (11+2, <code>A1-A1:G1</code>), meaning the difference between boys and men was about 26 cm. Notice that in the calculations above, the effect for apparent age would be equal across apparent genders in the case that there is no interaction (i.e. <code>A1:G1=0</code>).</p>
<p>We could instead consider the simple effects for apparent gender given apparent age. There is a gender-based 3 cm deviation from the intercept, meaning the difference between apparent adults and children is -6 cm (-3 <span class="math inline">\(\cdot\)</span> 2). This means that, overall, the female and male averages are about 155 and 161 cm respectively (158 ± -3). However, the <code>A1:G1</code> interaction is -2 cm. This means that when the speaker was an adult (<code>A1</code>) the effect for gender increased in magnitude from -3 cm to -5 cm (-3 + -2, <code>G1+A1:G1</code>), resulting in a difference between groups of 10 cm (-5 <span class="math inline">\(\cdot\)</span> 2). However, when the speaker was a child (<code>-A1</code>), the effect for gender decreased in magnitude from -3 cm to 1 cm (-3+2, <code>G1-A1:G1</code>), resulting in a difference in groups of 2 cm based on apparent gender (1 <span class="math inline">\(\cdot\)</span> 2).</p>
</div>
<div id="assessing-model-fit-bayesian-r2" class="section level3 hasAnchor" number="7.6.7">
<h3><span class="header-section-number">7.6.7</span> Assessing model fit: Bayesian <span class="math inline">\(R^2\)</span><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#assessing-model-fit-bayesian-r2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can assess the fit for our model including interaction terms by making more posterior predictions with our new model. We will focus on the average predictions for each data point since our objective is to see to what extent the fixed effects can represent the patterns in the data.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb34-1" aria-hidden="true" tabindex="-1"></a>y_post_pred_int <span class="ot">=</span> <span class="fu">predict</span> (model_interaction)</span>
<span id="cb34-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb34-2" aria-hidden="true" tabindex="-1"></a>y_post_pred_no_re_int <span class="ot">=</span> <span class="fu">predict</span> (model_interaction, <span class="at">re_formula =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p>In figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-10">7.10</a> we compare our data, the predictions of our original model, and the predictions of our model that includes interactions (both models with and without random effects). Whereas the model with no interactions enforced parallelism on the simple effects, our new model is able to capture the interaction in our data by representing different effects for gender at different levels of age (and vice versa). Although both of our models are able to capture the pattern in the data when random effects are included, only one of these is able to do so with its fixed effect structure.</p>
<div class="figure"><span style="display:block;" id="fig:F7-10"></span>
<img src="_main_files/figure-html/F7-10-1.jpeg" alt="Interaction plots comparing observed apparent height judgmentss to different posterior predictions. Posterior predictions with no interaction come from `model_both` and predictions with interactions come from `model_interaction`. With RE (random effects) refers to predictions made using random effects, and no RE refers to predictions made without random effects." width="4800" />
<p class="caption">
Figure 7.10: Interaction plots comparing observed apparent height judgmentss to different posterior predictions. Posterior predictions with no interaction come from <code>model_both</code> and predictions with interactions come from <code>model_interaction</code>. With RE (random effects) refers to predictions made using random effects, and no RE refers to predictions made without random effects.
</p>
</div>
<p>We can compare the models with and without the interaction term using leave one out cross-validation, discussed in section <a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-out-sample-crossval">6.4.3</a>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb35-1" aria-hidden="true" tabindex="-1"></a>model_both <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span> (model_both, <span class="at">criterion=</span><span class="st">&quot;loo&quot;</span>)</span>
<span id="cb35-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb35-2" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span> (model_interaction, <span class="at">criterion=</span><span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<p>The comparison suggests a large difference between the models, but also some uncertainty regarding the difference.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb36-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">loo_compare</span> (model_both, model_interaction)</span>
<span id="cb36-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                   elpd_diff se_diff</span></span>
<span id="cb36-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="do">## model_interaction   0.0       0.0  </span></span>
<span id="cb36-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="do">## model_both        -29.1      11.2</span></span></code></pre></div>
<p>To some extent the difference may appear to be smaller than it is because our random effects do a good job of explaining listener and speaker-dependent deviations from the expectations set out by the fixed effects. Explaining things with ‘random’ effects is less useful for understanding the out-of-sample characteristics of your data. If we were to replicate this experiment with new speakers and listeners, we would expect all the random effects to change. However, if the relations between apparent age and gender and apparent height expressed in our model are ‘true’, we would expect the ‘fixed’ effects in the replication to be about the same. For this reason, it is extremely useful to consider fixed effects prediction in addition to the predictive power of a complete model including both fixed and random effects.</p>
<p>To quantify how well our models fit our data we can also use <strong>Bayesian <span class="math inline">\(R^2\)</span></strong>. There are potentially several ways to define <span class="math inline">\(R^2\)</span> in a Bayesian context. The account of Bayesian <span class="math inline">\(R^2\)</span> presented here is a summary of the proposal outlined in Gelman et al. (2019). In addition, the discussion of <span class="math inline">\(R^2\)</span> to follow assumes that your model involves either Gaussian or t-distributed errors and a continuous dependent variable.</p>
<p><span class="math inline">\(R^2\)</span> is a measure of model fit that breaks down the total variance in your dependent variable into two parts: 1) The variance that your model <em>can</em> explain, and 2) the variance that your model <em>cannot</em> explain (the residual error, which we’ve been calling <span class="math inline">\(\sigma\)</span>). This is shown in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-9">(7.9)</a>.</p>
<p><span class="math display" id="eq:7-9">\[
\begin{equation}
\sigma^2_{total} = \sigma^2_{explained} + \sigma^2_{error}
\tag{7.9}
\end{equation}
\]</span></p>
<p><span class="math inline">\(R^2\)</span> is the ratio of the explained variance to the total variance, as seen in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-10">(7.10)</a>. Since the explained variance cannot be less than zero nor can it be greater than the total variance, values of <span class="math inline">\(R^2\)</span> range from zero to one. As a result, <span class="math inline">\(R^2\)</span> can be interpreted as the proportion of variance in the dependent variable that is explained by the model</p>
<p><span class="math display" id="eq:7-10">\[
\begin{equation}
R^2 = \frac{ \sigma^2_{explained} }{ \sigma^2_{total} } = \frac{ \sigma^2_{explained} }{ \sigma^2_{explained} + \sigma^2_{error} }
\tag{7.10}
\end{equation}
\]</span></p>
<p>To make <span class="math inline">\(R^2\)</span> a <em>Bayesian</em> <span class="math inline">\(R^2\)</span>, we need to incorporate the posterior distribution of parameter values into our estimation. This is done, in part, by calculating a value of <span class="math inline">\(R^2\)</span> for every individual set of posterior samples, as shown in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-11">(7.11)</a>. For every posterior sample of parameter values <span class="math inline">\(s\)</span> (from <span class="math inline">\(S\)</span> total samples) we calculate: 1) The variance in the predicted values (<span class="math inline">\(\hat{y}\)</span>) of the dependent variable for our <span class="math inline">\(n\)</span> data points (<span class="math inline">\(V_{i=1}^n \; \hat{y}^s_n\)</span>), and 2) the variance of the residual error for our <span class="math inline">\(n\)</span> data points (<span class="math inline">\(V_{i=1}^n \; \hat{e}^s_i\)</span>).</p>
<p><span class="math display" id="eq:7-11">\[
\begin{equation}
R^2_s = \frac{V_{i=1}^n \; \hat{y}^s_i}{ V_{i=1}^n \; \hat{y}^s_i + V_{i=1}^n \; \hat{e}^s_i}
\tag{7.11}
\end{equation}
\]</span></p>
<p>The residual error is the difference between predicted (<span class="math inline">\(\hat{y}\)</span>) and observed (<span class="math inline">\(y\)</span>) values for each data point, shown in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-11">(7.11)</a>. Notice that the predictions and residuals vary across the <span class="math inline">\(s\)</span> samples, but our observed data does not.</p>
<p><span class="math display" id="eq:7-12">\[
\begin{equation}
\hat{e}^s_i = \hat{y}^s_i - y_i
\tag{7.12}
\end{equation}
\]</span></p>
<p>This results in a <em>distribution</em> of <span class="math inline">\(R^2\)</span> values, unlike more ‘traditional’ estimates of <span class="math inline">\(R^2\)</span> that result in point estimates. The <code>brms</code> package includes a function called <code>bayes_R2</code> that helps you calculate Bayesian <span class="math inline">\(R^2\)</span> for <code>brm</code> models. However, we’re going to use the <code>r2_bayes</code> function from the <code>bmmb</code> package instead because this function allows you to modify (or omit) the fixed effects included in the prediction. Below we calculate <span class="math inline">\(R^2\)</span> for the models we fit this chapter, including all random effects.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb37-1" aria-hidden="true" tabindex="-1"></a>r2_both <span class="ot">=</span> <span class="fu">r2_bayes</span>(model_both)</span>
<span id="cb37-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb37-2" aria-hidden="true" tabindex="-1"></a>r2_interaction <span class="ot">=</span> <span class="fu">r2_bayes</span>(model_interaction)</span></code></pre></div>
<p>We can inspect the output and see that they have very similar values. This is not surprising given their similarities seen in figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-10">7.10</a>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb38-1" aria-hidden="true" tabindex="-1"></a>r2_both</span>
<span id="cb38-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error   Q2.5  Q97.5</span></span>
<span id="cb38-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]   0.7755  0.005566 0.7641 0.7858</span></span>
<span id="cb38-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb38-5" aria-hidden="true" tabindex="-1"></a>r2_interaction</span>
<span id="cb38-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error   Q2.5  Q97.5</span></span>
<span id="cb38-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]   0.7802  0.005347 0.7694 0.7901</span></span></code></pre></div>
<p>Just as we can omit the random effects when we use <code>predict</code>, we can omit random effects from our calculations of <span class="math inline">\(R^2\)</span> by setting <code>re_formula = NA</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb39-1" aria-hidden="true" tabindex="-1"></a>r2_both_no_re <span class="ot">=</span> <span class="fu">r2_bayes</span>(model_both, <span class="at">re_formula =</span> <span class="cn">NA</span>)</span>
<span id="cb39-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb39-2" aria-hidden="true" tabindex="-1"></a>r2_interaction_no_re <span class="ot">=</span> <span class="fu">r2_bayes</span>(model_interaction, <span class="at">re_formula =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p>Now a comparison reveals a more substantial difference in explanatory power between the models.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb40-1" aria-hidden="true" tabindex="-1"></a>r2_both_no_re</span>
<span id="cb40-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error   Q2.5  Q97.5</span></span>
<span id="cb40-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    0.503   0.07258 0.3411 0.6216</span></span>
<span id="cb40-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb40-5" aria-hidden="true" tabindex="-1"></a>r2_interaction_no_re</span>
<span id="cb40-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error   Q2.5  Q97.5</span></span>
<span id="cb40-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]   0.5732   0.05909 0.4389 0.6678</span></span></code></pre></div>
<p>We would rather explain as much variation as possible using fixed as opposed to random effects. In addition, the interactions ‘makes sense’ given our domain knowledge. What we mean by this is that we know that the difference in veridical height between boys and girls 10-12 years old is inconsistent and may be about zero on average. So, we should not be too surprised if the effect for apparent gender on apparent height is small for apparent children. However, there is a larger and more consistent difference in average veridical height between adult males and females. As a result, we <em>do</em> expect a meaningful effect for apparent gender on the apparent heights of adults. For these reasons, it would be surprising if there were <em>not</em> an interaction, and we prefer the model with the interaction despite the middling support provided by our cross-validation model comparison.</p>
<p><span class="math inline">\(R^2\)</span> is not really going to prove anything, and shouldn’t form the basis of your model selection. We believe that it is a useful method to be aware of in addition to, and not instead of, other approaches such as <span class="math inline">\(\mathrm{elpd}\)</span>). The primary utility of <span class="math inline">\(R^2\)</span> is that since it reflects a proportion between 0 and 1, it is more easily interpretable for humans. For example, the difference in <span class="math inline">\(\mathrm{elpd}\)</span> between <code>model_both</code> and <code>model_interaction</code> is about 29, which is large enough to be statistically meaningful. However, how much does this difference actually matter at the level of our dependent variable? Well, the proportion of variance explained by the two models is only different by about 0.5%, suggesting that these models do not offer substantially different predictions. In contrast, we might imagine the same difference in <span class="math inline">\(\mathrm{elpd}\)</span> being associated with a 10% change in the variance explained, which will likely be a noticeable difference. In this way, <span class="math inline">\(R^2\)</span> can be a useful indicator of how much our predictions are really changing, provided in a measure that many readers will find relatively intuitive.</p>
</div>
</div>
<div id="c7-answering" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Answering our research questions<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-answering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will answer our research questions based on <code>model_interaction</code>. In addition, we used the <code>forpaper</code> function, like this <code>forpaper(fixef(model_interaction))</code> to generate standard output of the form <code>(mean = --, s.d. = --, 95% C.I = [--, --])</code> from the typical <code>brms</code> coefficient table output.</p>
<p>Results indicate that the average apparent height across all speaker groups (i.e. the intercept) was 158.5 (s.d. = 1.12, 95% C.I = [156.22, 160.62]). We also found an average effect of 10.8 cm for apparent speaker age (s.d. = 1.21, 95% C.I = [8.39, 13.15]) and -2.9 cm for apparent speaker gender (s.d. = 0.6, 95% C.I = [-4.07, -1.72]). In addition, we found an interaction between the effects of apparent age and apparent gender on apparent heights (mean = -1.64, s.d. = 0.41, 95% C.I = [-2.44, -0.81]). The result of these effects are that apparent adults were perceived as taller than apparent children and apparent males were perceived as taller than apparent females. However, the difference in apparent height due to apparent gender was larger for adults than for children (and the effect for apparent age was larger for males than for females). Figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-11">7.11</a> presents the model fixed effects other than the intercept (whose value is too large to plot in this range).</p>
<div class="figure"><span style="display:block;" id="fig:F7-11"></span>
<img src="_main_files/figure-html/F7-11-1.jpeg" alt="(left) Fixed effect means and 95% credible intervals (minus the intercept) for `model_interaction`. (right) Means and 95% credible intervals for the pairwise differences between predicted means for different apparent speaker categories (boys, girls, men and women)." width="4800" />
<p class="caption">
Figure 7.11: (left) Fixed effect means and 95% credible intervals (minus the intercept) for <code>model_interaction</code>. (right) Means and 95% credible intervals for the pairwise differences between predicted means for different apparent speaker categories (boys, girls, men and women).
</p>
</div>
<p>The fixed effects all have 95% credible intervals that do not overlap with zero. Historically, this sort of result has been thought of as indicating that the effect is ‘real’, as in not equal to zero. In contrast, when the 95% (or some other) credible interval of an effect overlaps with zero, researchers will often conclude that this effect is not ‘real’, i.e. that it is exactly equal to zero. Gelman et al. (2012) note that effects are rarely exactly equal to zero, and that an inability to conclusively distinguish the value of an effect from zero is not the same thing as thinking that the most probable value of an effect is exactly zero.</p>
<p>As a result, rather than focusing on whether any given interval crosses zero or not, Gelman and Carlin (2014) recommend thinking about data analysis in terms of avoiding <strong>type S</strong> and <strong>type M</strong> errors. Type S (sign) errors occur when you think an effect is negative but its actually positive (or vice versa). A type M (magnitude) error is when you think an effect is large but it’s actually small (or vice versa). Focusing on type M and S errors rather than whether an interval crosses zero forces researchers to focus on the magnitude of the predictor, its practical importance, and the uncertainty involved in the estimate. That being said, if a parameter has a ‘large’ magnitude (in the context of the dependent variable) and a ‘small’ amount of uncertainty (relative to the magnitude), this predictor is likely to be important for understanding the dependent variable in the context of your model.</p>
<p>Figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-11">7.11</a> also presents the pairwise difference between all four apparent speaker groups (boys, girls, women, and men). The difference between pairs of group means is calculated by extracting the samples from the group means we reconstructed in section <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-calc-means">7.6.5</a> (<code>means_pred_interaction</code>). The result of this is a matrix with four columns, each representing a group effect, with individual posterior samples differing along rows. To find the difference between group means between each pair of groups, we subtract the columns representing the group effects and inspect the distribution of the differences. This process is shown below and the distribution of pairwise group differences is presented in the right plot of figure <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fig:F7-11">7.11</a>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get group mean predictions</span></span>
<span id="cb41-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-2" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">attributes</span>(means_pred_interaction)<span class="sc">$</span>samples</span>
<span id="cb41-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># find pairwise differences</span></span>
<span id="cb41-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-5" aria-hidden="true" tabindex="-1"></a>pairwise_diffs <span class="ot">=</span> <span class="fu">cbind</span>(<span class="st">&quot;b-g&quot;</span><span class="ot">=</span>C[,<span class="dv">1</span>]<span class="sc">-</span>C[,<span class="dv">2</span>], <span class="st">&quot;b-w&quot;</span><span class="ot">=</span>C[,<span class="dv">1</span>]<span class="sc">-</span>C[,<span class="dv">3</span>],</span>
<span id="cb41-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;b-m&quot;</span><span class="ot">=</span>C[,<span class="dv">1</span>]<span class="sc">-</span>C[,<span class="dv">4</span>], <span class="st">&quot;g-w&quot;</span><span class="ot">=</span>C[,<span class="dv">2</span>]<span class="sc">-</span>C[,<span class="dv">3</span>],</span>
<span id="cb41-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;g-m&quot;</span><span class="ot">=</span>C[,<span class="dv">2</span>]<span class="sc">-</span>C[,<span class="dv">4</span>], <span class="st">&quot;w-m&quot;</span><span class="ot">=</span>C[,<span class="dv">3</span>]<span class="sc">-</span>C[,<span class="dv">4</span>])</span>
<span id="cb41-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize these</span></span>
<span id="cb41-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb41-10" aria-hidden="true" tabindex="-1"></a>pairwise_diffs_summary <span class="ot">=</span> <span class="fu">posterior_summary</span>(pairwise_diffs)</span></code></pre></div>
<p>We can think about these differences in the context of our type M and S errors. All of the group differences (save for boy-girl) have values of about 10 cm (or more), which is a meaningful (and noticeable) difference in human height. In addition, the credible intervals around these differences are small relative to their magnitudes. From this we can conclude that these differences are unlikely to <em>really</em> be the opposite sign (a type S error). In addition, since the group differences (save for boy-girl) are mostly large and the credible intervals do not go anywhere near zero, these differences seem unlikely to actually be some small and insignificant value near zero (a type S error).</p>
<p>But what about the boy-girl difference? The 95% credible interval of the difference between groups overlaps with zero. Does this mean there is no difference between the groups, i.e. <span class="math inline">\(\mu_{boy}=\mu_{girl}\)</span> and <span class="math inline">\(\mu_{boy}-\mu_{girl}=0\)</span>? No, it doesn’t. It just means that 0 is a value that is not so implausible for the difference between groups. The most probable difference is still 2.5. Consider a replication that found a group difference with a mean and 95% credible interval of 2.6 and [0.1, 5.1] respectively, rather than our values of 2.5 and [-0.8, 5.7]. Would such a difference constitute a successful replication or an opposing finding? If we focus on whether intervals cross zero to decide if effects are ‘real’, we might decide that these experiments do not agree: We found no difference in our first experiment but the replication <em>did</em> find a difference. In contrast, if we focus on the sign and magnitude of the effects and the uncertainty around their estimates, the two experiments have extremely compatible results and constitute a successful replication.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of difference between boy and girl means</span></span>
<span id="cb42-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb42-2" aria-hidden="true" tabindex="-1"></a>pairwise_diffs_summary[<span class="dv">1</span>,]</span>
<span id="cb42-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Estimate Est.Error      Q2.5     Q97.5 </span></span>
<span id="cb42-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    2.4643    1.6384   -0.7837    5.7199</span></span></code></pre></div>
<p>We might wonder, under what conditions can we accept that an effect or group difference is <em>actually</em> equal to zero. If the 95% (or some other high number) credible interval is relatively narrow and (more or less) centered around zero, the parameter value may very well be zero. It may also be a small number that has no practical effect on your dependent variable so that it doesn’t really matter what it is even if its not exactly equal to <span class="math inline">\(0.0000000 \dots\)</span> . In either case, a coefficient with a narrow interval (roughly) centered at zero may not have an important role in the way you interpret your model in order to tell the ‘story’ of your data. However, it is extremely important to keep in mind that under a different parametrization of your model, or given a slightly different experimental design, it’s possible that an equivalent parameter may exhibit a clearly non-zero value.</p>
<p>Another thing to think about is, how large does an effect need to be before it matters, even if it is not zero? This is a similar approach to Kruschke’s <strong>Region of Practical Equivalence</strong> (ROPE, Kruschke 2018). Rather than worrying about whether things are exactly zero or not, Kruschke suggests we think about when things are so small that they may as well be zero. For human height, apparent and veridical, we define meaningful differences as those that 1) are likely to be different from zero, <em>and</em> 2) have magnitudes of at least around 1 cm (about 0.5 inches). We establish this lower limit simply based off the fact that people may describe themselves as 175 cm (or 5’10.5”) but rarely make distinctions smaller than that (e.g. people rarely distinguish 175 cm and 175.2 cm). In addition, governments, doctors, and even institutions like the NBA which are extremely interested in height will rarely measure to within less than 1 cm (half an inch). As a result, although a difference of 0.1 cm may very well be consistently different from zero, in the context of human height a difference of this magnitude has little to no practical significance in most situations.</p>
<p>In our case, we will conclude that the difference in apparent height between boys and girls may very well be ‘real’ and may reflect stereotypes that male speakers are generally taller than female speakers, whether or not this is actually true for speakers of this age. We might also suggest that if we want to know more about the precise value of this difference, future research might investigate this question with a larger number of speakers, listeners, or repetitions. By increasing the sample size, researchers would narrow the parameter likelihoods (discussed in section <a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods-2">2.7.3</a>), thereby narrowing their posterior credible intervals (given new data that’s roughly the same as the data we have).</p>
<p>Finally, we want to directly address the fact that our discussion above regarding accepting effects as ‘real’ or as ‘zero’ may seem to be full of vagueness and equivocation. This is by design. Sometimes, researchers want to wash their hands of a difficult decision and let the model decide. However, the researcher cannot ‘pass the buck’ and let the model ‘prove’ that something is zero or non-zero. The model can certainly tell you that, given your data and model structure, something is likely to be zero or non zero. However, transferring that knowledge to the ‘real world’ is an epistemological or ontological claim (or both), and <em>not</em> a statistical one. To some extent, the statistical claim underlies the claim about the real world, but it is not enough on its own. To <em>really</em> make a claim about an effect being zero or not, the researcher requires statistical evidence in addition to domain knowledge about the real world. As a result, we can give general (vague) guidelines about situations when your models suggest something is zero or non zero, but we cannot say with certainty that in such and such a situation you can always make claims about the real world based <em>solely</em> on your statistical model.</p>
<p>For example, because of the relationship between sample size, likelihoods, and credible intervals, any arbitrarily small effect will be distinguishable from zero given a large enough sample. Imagine a situation where we have an effect of 0.1 cm that that has a 95% credible interval of [0.09, 0.11]. Our model is telling us that this effect is extremely unlikely to equal zero, and yet we are unlikely to care much about an effect this small. However, we can only know this by knowing something about human height and meaningful variation therein, and this is domain-specific knowledge that must come from the researcher interpreting the model.</p>
</div>
<div id="factors-with-more-than-two-levels" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Factors with more than two levels<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#factors-with-more-than-two-levels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before moving on, we want to provide an example of how to recover interaction terms that are not estimated by your model when you have factors with more than two levels. This is a modest extension of the principles we have discussed so far, however, it’s useful to provide an explicit example. Below, we generate some toy data that includes two factors with four levels each (<code>A, B</code>), and an interaction between them (<code>AB</code>).</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">rep</span> (<span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">each =</span> <span class="dv">60</span>)</span>
<span id="cb43-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">rep</span> (<span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="dv">60</span>)</span>
<span id="cb43-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-4" aria-hidden="true" tabindex="-1"></a>A_ <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb43-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-5" aria-hidden="true" tabindex="-1"></a>B_ <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb43-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-6" aria-hidden="true" tabindex="-1"></a>AB_ <span class="ot">=</span> <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb43-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-7" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb43-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-8" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb43-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-9" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb43-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-11" aria-hidden="true" tabindex="-1"></a>error <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">240</span>)</span>
<span id="cb43-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> A_[A] <span class="sc">+</span> B_[B] <span class="sc">+</span> AB_[<span class="fu">cbind</span>(A,B)] <span class="sc">+</span> error</span>
<span id="cb43-14"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb43-15" aria-hidden="true" tabindex="-1"></a>toy_data <span class="ot">=</span> <span class="fu">data.frame</span> (y, A, B)</span></code></pre></div>
<p>We use this to fit a simple model with <code>brms</code>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb44-1" aria-hidden="true" tabindex="-1"></a>toy_model <span class="ot">=</span> <span class="fu">brm</span> (y <span class="sc">~</span> A<span class="sc">*</span>B, <span class="at">data =</span> toy_data)</span>
<span id="cb44-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Compiling Stan program...</span></span>
<span id="cb44-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Start sampling</span></span></code></pre></div>
<p>And inspect the fixed effects:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span> (toy_model)</span>
<span id="cb45-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error     Q2.5   Q97.5</span></span>
<span id="cb45-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   0.1095   0.06176 -0.01202  0.2315</span></span>
<span id="cb45-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="do">## A1         -1.9965   0.09829 -2.18868 -1.8044</span></span>
<span id="cb45-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="do">## A2          1.0740   0.10336  0.87110  1.2754</span></span>
<span id="cb45-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="do">## A3          1.9056   0.09874  1.70910  2.1009</span></span>
<span id="cb45-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="do">## B1          3.8246   0.10339  3.62104  4.0266</span></span>
<span id="cb45-8"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="do">## B2          2.1631   0.10516  1.95049  2.3690</span></span>
<span id="cb45-9"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="do">## B3         -3.1125   0.10133 -3.30826 -2.9101</span></span>
<span id="cb45-10"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="do">## A1:B1      -1.3946   0.18342 -1.74290 -1.0213</span></span>
<span id="cb45-11"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="do">## A2:B1       1.4003   0.18033  1.04754  1.7507</span></span>
<span id="cb45-12"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="do">## A3:B1      -1.0869   0.17996 -1.43684 -0.7329</span></span>
<span id="cb45-13"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="do">## A1:B2       1.1895   0.17501  0.83919  1.5318</span></span>
<span id="cb45-14"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="do">## A2:B2      -1.1781   0.17639 -1.51823 -0.8342</span></span>
<span id="cb45-15"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="do">## A3:B2       0.8884   0.17807  0.54226  1.2453</span></span>
<span id="cb45-16"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="do">## A1:B3      -1.0807   0.17961 -1.42655 -0.7256</span></span>
<span id="cb45-17"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="do">## A2:B3       0.5558   0.17936  0.19655  0.9171</span></span>
<span id="cb45-18"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="do">## A3:B3      -0.6623   0.18180 -1.02043 -0.3095</span></span></code></pre></div>
<p>As expected, we see that we estimate 3 of 4 factor levels for the <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> factors respectively. This means that we will be missing the fourth level of each factor. Below, we present factor levels in a grid, and indicate the missing level in parentheses.</p>
<p><span class="math display" id="eq:7-13">\[
\begin{equation}
\begin{split}
\begin{bmatrix}
A1 &amp; A2 &amp; A3 &amp; (A4) \\
\end{bmatrix} \\\\
\begin{bmatrix}
B1 &amp; B2 &amp; B3 &amp; (B4) \\
\end{bmatrix}
\end{split}
\tag{7.13}
\end{equation}
\]</span></p>
<p>In order to recover the missing levels of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> (under sum coding), we have to find the negative sum of the estimated levels. We place this value in the corresponding grid location seen below.</p>
<p><span class="math display" id="eq:7-13">\[
\begin{equation}
\begin{split}
\begin{bmatrix}
A1 &amp; A2 &amp; A3 &amp; -(A1+A2+A3) \\
\end{bmatrix} \\\\
\begin{bmatrix}
B1 &amp; B2 &amp; B3 &amp; -(B1+B2+B3) \\
\end{bmatrix}
\end{split}
\tag{7.13}
\end{equation}
\]</span></p>
<p>As noted above, the number of interaction terms we can estimate will generally be equal to (the number of levels in <span class="math inline">\(A\)</span> - 1)<span class="math inline">\(\times\)</span>(the number of levels in <span class="math inline">\(B\)</span> - 1). As a result, we know that we will only be able to estimate 9 out of the 16 total interaction terms. We have arranged these terms in a similar grid as seen above, and again placed the missing terms in parentheses. In the grid below, levels of <span class="math inline">\(A\)</span> vary across columns and levels of <span class="math inline">\(B\)</span> vary across rows.</p>
<p><span class="math display" id="eq:7-14">\[
\begin{equation}
\begin{bmatrix}
A1 \colon B1 &amp; A2 \colon B1 &amp; A3 \colon B1 &amp; (A4 \colon B1)\\
A1 \colon B2 &amp; A2 \colon B2 &amp; A3 \colon B2 &amp; (A4 \colon B2)\\
A1 \colon B3 &amp; A2 \colon B3 &amp; A3 \colon B3 &amp; (A4 \colon B3)\\
(A1 \colon B4) &amp; (A2 \colon B4) &amp; (A3 \colon B4) &amp; (A4 \colon B4)\\
\end{bmatrix}\tag{7.14}
\end{equation}
\]</span></p>
<p>Recovering missing interaction values is no more complicated but can be a bit tedious for large numbers of missing interactions. The missing values at the end of each row are simply the negative sum of the elements present in the row, and the missing values at the end of each column are simply the negative sum of the elements present in the column. We show this for only one row and one column so that the matrix will fit on the page, but the same process can be applied to all rows and columns in the matrix.</p>
<p><span class="math display" id="eq:7-14">\[
\begin{equation}
\begin{bmatrix}
A1 \colon B1 &amp; A2 \colon B1 &amp; A3 \colon B1 &amp; -(A1 \colon B1+A2 \colon B1+A3 \colon B1) \\
A1 \colon B2 &amp; A2 \colon B2 &amp; A3 \colon B2 &amp; (A4 \colon B2)\\
A1 \colon B3 &amp; A2 \colon B3 &amp; A3 \colon B3 &amp; (A4 \colon B3)\\
-(A1 \colon B1+A1 \colon B2+A1 \colon B3) &amp; (A2 \colon B4) &amp; (A3 \colon B4) &amp; (A4 \colon B4)\\
\end{bmatrix}\tag{7.14}
\end{equation}
\]</span></p>
<p>You can get the missing element in the bottom right corner above by following the same process once you have recovered the remaining elements from the final row or column. For example, the interaction in the bottom corner is the negative sum of the other three terms in the final column <em>and</em> in the final row.</p>
<p><span class="math display" id="eq:7-14">\[
\begin{equation}
\begin{split}
A4 \colon B4 = -(A4 \colon B1+A4 \colon B2+A4 \colon B3) \\
A4 \colon B4 = -(A1 \colon B4+A2 \colon B4+A3 \colon B4) \\
\end{split}
\tag{7.14}
\end{equation}
\]</span></p>
<p>Of course, these values can all be recovered easily using the <code>hypothesis</code> (or <code>short_hypothesis</code>) function.</p>
</div>
<div id="c7-frequentist" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> ‘Traditionalists’ corner<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-frequentist" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In traditionalists corner, we’re going to compare the output of <code>brms</code> to some more ‘traditional’ approaches. We’re not going to talk about the traditional models in any detail, the focus of this section is simply to highlight the similarities between different approaches, and to point out where to find equivalent information in the different models. If you are already familiar with these approaches, these sections may be helpful. If not, some of the information provided here may not make much sense, although it may still be helpful. If you want to know more about the statistical methods being discussed here, please see the preface for a list of suggested background reading in statistics.</p>
<div id="bayesian-multilevel-models-vs.-lmer-1" class="section level3 hasAnchor" number="7.9.1">
<h3><span class="header-section-number">7.9.1</span> Bayesian multilevel models vs. lmer<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#bayesian-multilevel-models-vs.-lmer-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is going to be a short one. One shortcoming when it comes to using <code>lmer</code> to fit models including factors with many levels is that there is no easy way to compare group effects solely based on the information contained in the model. For example, we can fit the model below which encodes the difference between each group mean and the overall mean.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb46-1" aria-hidden="true" tabindex="-1"></a>lmer_four_groups <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span> (height <span class="sc">~</span> C <span class="sc">+</span> (C<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), <span class="at">data =</span> exp_data)</span>
<span id="cb46-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (lmer_four_groups)<span class="sc">$</span>coefficients</span>
<span id="cb46-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value</span></span>
<span id="cb46-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  158.344      1.040 152.228</span></span>
<span id="cb46-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="do">## C1            -9.543      1.300  -7.341</span></span>
<span id="cb46-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="do">## C2           -11.126      1.332  -8.355</span></span>
<span id="cb46-7"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="do">## C3            14.604      1.371  10.655</span></span></code></pre></div>
<p>The results provided by <code>lmer</code> are very similar to those provided by <code>brm</code>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb47-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">fixef</span> (model_four_groups)</span>
<span id="cb47-2"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error   Q2.5   Q97.5</span></span>
<span id="cb47-3"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept  158.581     1.083 156.41 160.685</span></span>
<span id="cb47-4"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="do">## C1          -9.318     1.310 -11.87  -6.682</span></span>
<span id="cb47-5"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="do">## C2         -12.082     1.494 -15.07  -9.110</span></span>
<span id="cb47-6"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="do">## C3          15.286     1.327  12.59  17.950</span></span></code></pre></div>
<p>However, it is not as straightforward to test for differences between parameter values in our <code>lmer</code> models. The same could be said for the combination of parameters as is necessary for the investigation of group means and simple effects. The investigation of differences and combinations of parameters is definitely possible in <code>lmer</code> for many cases, however this will involve either the re-parametrization of the model or the use of additional packages that allow for these sorts of questions to be asked. As a result, the comparisons or transformations that can be carried out is limited by the functionalities of the packages that carry out these comparison This can be contrasted with the ease and flexibility with which we can compare parameter estimates using Bayesian models.</p>
</div>
</div>
<div id="exercises-6" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> Exercises<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#exercises-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The analyses in the main body of the text all involve only the unmodified ‘actual’ resonance level (in <code>exp_data</code>). Responses for the stimuli with the simulate ‘big’ resonance are reserved for exercises throughout. You can get the ‘big’ resonance in the <code>exp_ex</code> data frame, or all data in the <code>exp_data_all</code> data frame.</p>
<p>Fit and interpret one or more of the suggested models:</p>
<ol style="list-style-type: decimal">
<li><p>Easy: Analyze the (pre-fit) model that’s exactly like <code>model_interaction</code>, except using the data in <code>exp_ex</code> (<code>bmmb::get_model("7_model_interaction_ex.RDS")</code>).</p></li>
<li><p>Medium: Fit a model like <code>model_interaction</code>, but replace either apparent gender or apparent age with the resonance factor.</p></li>
<li><p>Hard: Fit a model including apparent age, apparent gender, and resonance. Include all interactions between these factors for both fixed and random effects.</p></li>
</ol>
<p>In any case, describe the model, present and explain the results, and include some figures.</p>
</div>
<div id="references-4" class="section level2 hasAnchor" number="7.11">
<h2><span class="header-section-number">7.11</span> References<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#references-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Gelman, A., Hill, J., &amp; Yajima, M. (2012). Why we (usually) don’t have to worry about multiple comparisons. Journal of Research on Educational Effectiveness, 5(2), 189–211.</p>
<p>Gelman, A., &amp; Carlin, J. (2014). Beyond power calculations: Assessing type S (sign) and type M (magnitude) errors. Perspectives on Psychological Science, 9(6), 641-651.</p>
<p>Gelman, A., Goodrich, B., Gabry, J., &amp; Vehtari, A. (2019). R-squared for Bayesian regression models. The American Statistician.</p>
<p>Kruschke, J. K. (2018). Rejecting or accepting parameter values in Bayesian estimation. Advances in methods and practices in psychological science, 1(2), 270-280.</p>

</div>
</div>
<!-- Default Statcounter code for statsbook
https://santiagobarreda.github.io/stats-class/ -->
<script type="text/javascript">
var sc_project=12454226; 
var sc_invisible=1; 
var sc_security="a1959418"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/12454226/0/a1959418/1/"
alt="Web Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->
            </section>

          </div>
        </div>
      </div>
<a href="variation-in-parameters-random-effects-and-model-comparison.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
