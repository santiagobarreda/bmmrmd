<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Inspecting a ‘single group’ of observations using a Bayesian multilevel model | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R</title>
  <meta name="description" content="Bayesian Models for Repeated Measures" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Inspecting a ‘single group’ of observations using a Bayesian multilevel model | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Bayesian Models for Repeated Measures" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Inspecting a ‘single group’ of observations using a Bayesian multilevel model | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R" />
  
  <meta name="twitter:description" content="Bayesian Models for Repeated Measures" />
  

<meta name="author" content="Santiago Bareda and Noah Silbert" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fitting-bayesian-regression-models-with-brms.html"/>
<link rel="next" href="comparing-two-groups-of-observations-factors-and-contrasts.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Repeated Measures data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bayesian-multilevel-models-and-repeated-measures-data"><i class="fa fa-check"></i>Bayesian Multilevel models and repeated measures data</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#whats-missing-from-this-book"><i class="fa fa-check"></i>What’s missing from this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistics-as-procedural-knowledge"><i class="fa fa-check"></i>Statistics as Procedural knowledge</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#practice-vs-brain-power"><i class="fa fa-check"></i>Practice vs brain power</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supplemental-resources"><i class="fa fa-check"></i>Supplemental Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#our-target-audience"><i class="fa fa-check"></i>Our target audience</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-self-starter"><i class="fa fa-check"></i>The self-starter</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-convert"><i class="fa fa-check"></i>The convert</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-instructor"><i class="fa fa-check"></i>The instructor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-need-installed-to-use-this-book"><i class="fa fa-check"></i>What you need installed to use this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-go-bayesian"><i class="fa fa-check"></i>Why go Bayesian?</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-brms"><i class="fa fa-check"></i>Why brms?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#it-takes-a-village-of-books"><i class="fa fa-check"></i>It takes a village (of books)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html"><i class="fa fa-check"></i><b>1</b> Introduction: Experiments and Variables</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#chapter-pre-cap"><i class="fa fa-check"></i><b>1.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-and-effects"><i class="fa fa-check"></i><b>1.2</b> Experiments and effects</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-and-inference"><i class="fa fa-check"></i><b>1.2.1</b> Experiments and inference</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp"><i class="fa fa-check"></i><b>1.3</b> Our experiment</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-intro"><i class="fa fa-check"></i><b>1.3.1</b> Our experiment: Introduction</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-methods"><i class="fa fa-check"></i><b>1.3.2</b> Our experimental methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-research-questions"><i class="fa fa-check"></i><b>1.3.3</b> Our research questions</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-data"><i class="fa fa-check"></i><b>1.3.4</b> Our experimental data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-variables"><i class="fa fa-check"></i><b>1.4</b> Variables</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-pops-and-samps"><i class="fa fa-check"></i><b>1.4.1</b> Populations and samples</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-dep-and-indep"><i class="fa fa-check"></i><b>1.4.2</b> Dependent and Independent Variables</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-categorical"><i class="fa fa-check"></i><b>1.4.3</b> Categorical variables and ‘factors’</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-quantitative"><i class="fa fa-check"></i><b>1.4.4</b> Quantitative variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-logical"><i class="fa fa-check"></i><b>1.4.5</b> Logical variables</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting"><i class="fa fa-check"></i><b>1.5</b> Inspecting our data</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-categorical"><i class="fa fa-check"></i><b>1.5.1</b> Inspecting categorical variables</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-quantitative"><i class="fa fa-check"></i><b>1.5.2</b> Inspecting quantitative variables</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-together"><i class="fa fa-check"></i><b>1.5.3</b> Exploring continuous and categorical variables together</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#references"><i class="fa fa-check"></i><b>1.7</b> References</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#plot-code"><i class="fa fa-check"></i><b>1.8</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html"><i class="fa fa-check"></i><b>2</b> Probabilities, likelihood, and inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#chapter-pre-cap-1"><i class="fa fa-check"></i><b>2.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="2.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-data"><i class="fa fa-check"></i><b>2.2</b> Data and research questions</a></li>
<li class="chapter" data-level="2.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-empirical-prob"><i class="fa fa-check"></i><b>2.3</b> Empirical Probabilities</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-conditional"><i class="fa fa-check"></i><b>2.3.1</b> Conditional and marginal probabilities</a></li>
<li class="chapter" data-level="2.3.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-joint"><i class="fa fa-check"></i><b>2.3.2</b> Joint probabilities</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-theoretical"><i class="fa fa-check"></i><b>2.4</b> Probability distributions</a></li>
<li class="chapter" data-level="2.5" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-normal"><i class="fa fa-check"></i><b>2.5</b> The normal distribution</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-sample-mean"><i class="fa fa-check"></i><b>2.5.1</b> The sample mean</a></li>
<li class="chapter" data-level="2.5.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-sample-variance"><i class="fa fa-check"></i><b>2.5.2</b> The sample variance (or standard deviation)</a></li>
<li class="chapter" data-level="2.5.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-normal-density"><i class="fa fa-check"></i><b>2.5.3</b> The normal density</a></li>
<li class="chapter" data-level="2.5.4" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-standard-normal"><i class="fa fa-check"></i><b>2.5.4</b> The standard normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-models-and-inference"><i class="fa fa-check"></i><b>2.6</b> Models and inference</a></li>
<li class="chapter" data-level="2.7" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-likelihoods"><i class="fa fa-check"></i><b>2.7</b> Probabilities of events and likelihoods of parameters</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods"><i class="fa fa-check"></i><b>2.7.1</b> Characteristics of likelihoods</a></li>
<li class="chapter" data-level="2.7.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-logarithms"><i class="fa fa-check"></i><b>2.7.2</b> A brief aside on logarithms</a></li>
<li class="chapter" data-level="2.7.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods-2"><i class="fa fa-check"></i><b>2.7.3</b> Characteristics of likelihoods, continued</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-inference-and-likelihood"><i class="fa fa-check"></i><b>2.8</b> Answering our research questions</a></li>
<li class="chapter" data-level="2.9" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#exercises-1"><i class="fa fa-check"></i><b>2.9</b> Exercises</a></li>
<li class="chapter" data-level="2.10" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#references-1"><i class="fa fa-check"></i><b>2.10</b> References</a></li>
<li class="chapter" data-level="2.11" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#plot-code-1"><i class="fa fa-check"></i><b>2.11</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html"><i class="fa fa-check"></i><b>3</b> Fitting Bayesian regression models with <em>brms</em></a>
<ul>
<li class="chapter" data-level="3.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#chapter-pre-cap-2"><i class="fa fa-check"></i><b>3.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="3.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-what-is-reg"><i class="fa fa-check"></i><b>3.2</b> What are regression models?</a></li>
<li class="chapter" data-level="3.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-whats-bayes"><i class="fa fa-check"></i><b>3.3</b> What’s ‘Bayesian’ about these models?</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-priors"><i class="fa fa-check"></i><b>3.3.1</b> Prior probabilities</a></li>
<li class="chapter" data-level="3.3.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-posterior"><i class="fa fa-check"></i><b>3.3.2</b> Posterior distributions</a></li>
<li class="chapter" data-level="3.3.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-characteristics-posteriors"><i class="fa fa-check"></i><b>3.3.3</b> Posterior distributions and shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-sampling"><i class="fa fa-check"></i><b>3.4</b> Sampling from the posterior using <em>Stan</em> and <em>brms</em></a></li>
<li class="chapter" data-level="3.5" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-estimating"><i class="fa fa-check"></i><b>3.5</b> Estimating a single mean with the <code>brms</code> package</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-data-qs-1"><i class="fa fa-check"></i><b>3.5.1</b> Data and Research Questions</a></li>
<li class="chapter" data-level="3.5.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-description-1"><i class="fa fa-check"></i><b>3.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="3.5.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-errors-and-residuals"><i class="fa fa-check"></i><b>3.5.3</b> Errors and residuals</a></li>
<li class="chapter" data-level="3.5.4" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-model-formula"><i class="fa fa-check"></i><b>3.5.4</b> The model formula</a></li>
<li class="chapter" data-level="3.5.5" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-calling-brm"><i class="fa fa-check"></i><b>3.5.5</b> Fitting the model: Calling the <em>brm</em> function</a></li>
<li class="chapter" data-level="3.5.6" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-interpreting-print"><i class="fa fa-check"></i><b>3.5.6</b> Interpreting the model: The print statement</a></li>
<li class="chapter" data-level="3.5.7" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-seeing-samples"><i class="fa fa-check"></i><b>3.5.7</b> Seeing the samples</a></li>
<li class="chapter" data-level="3.5.8" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-getting-residuals"><i class="fa fa-check"></i><b>3.5.8</b> Getting the residuals</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-checking-convergence"><i class="fa fa-check"></i><b>3.6</b> Checking model convergence</a></li>
<li class="chapter" data-level="3.7" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-specifying-priors"><i class="fa fa-check"></i><b>3.7</b> Specifying prior probabilities</a></li>
<li class="chapter" data-level="3.8" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-log-posterior"><i class="fa fa-check"></i><b>3.8</b> The log prior and log posterior densities</a></li>
<li class="chapter" data-level="3.9" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-answering-qs"><i class="fa fa-check"></i><b>3.9</b> Answering our research questions</a></li>
<li class="chapter" data-level="3.10" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-frequentist"><i class="fa fa-check"></i><b>3.10</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-vs-ttest"><i class="fa fa-check"></i><b>3.10.1</b> One-sample t-test vs. intercept-only Bayesian models</a></li>
<li class="chapter" data-level="3.10.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-vs-ols"><i class="fa fa-check"></i><b>3.10.2</b> Intercept-only ordinary-least-squares regression vs. intercept-only Bayesian models</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#exercises-2"><i class="fa fa-check"></i><b>3.11</b> Exercises</a></li>
<li class="chapter" data-level="3.12" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#plot-code-2"><i class="fa fa-check"></i><b>3.12</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><i class="fa fa-check"></i><b>4</b> Inspecting a ‘single group’ of observations using a Bayesian multilevel model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#chapter-pre-cap-3"><i class="fa fa-check"></i><b>4.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="4.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-multilevel"><i class="fa fa-check"></i><b>4.2</b> Repeated measures data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-levels"><i class="fa fa-check"></i><b>4.2.1</b> Multilevel models and ‘levels’ of variation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-many-levels"><i class="fa fa-check"></i><b>4.3</b> Representing predictors with many levels</a></li>
<li class="chapter" data-level="4.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-strategies"><i class="fa fa-check"></i><b>4.4</b> Strategies for estimating factors with many levels</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-complete-pooling"><i class="fa fa-check"></i><b>4.4.1</b> Complete pooling</a></li>
<li class="chapter" data-level="4.4.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-no-pooling"><i class="fa fa-check"></i><b>4.4.2</b> No pooling</a></li>
<li class="chapter" data-level="4.4.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-partial-pooling"><i class="fa fa-check"></i><b>4.4.3</b> (Adaptive) Partial pooling</a></li>
<li class="chapter" data-level="4.4.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#hyperpriors"><i class="fa fa-check"></i><b>4.4.4</b> Hyperpriors</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-estimating1"><i class="fa fa-check"></i><b>4.5</b> Estimating a multilevel model with <code>brms</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-data-and-qs-1"><i class="fa fa-check"></i><b>4.5.1</b> Data and Research questions</a></li>
<li class="chapter" data-level="4.5.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#description-of-the-model"><i class="fa fa-check"></i><b>4.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="4.5.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-fitting-1"><i class="fa fa-check"></i><b>4.5.3</b> Fitting the model</a></li>
<li class="chapter" data-level="4.5.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#interpreting-the-model"><i class="fa fa-check"></i><b>4.5.4</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-random-effects"><i class="fa fa-check"></i><b>4.6</b> ‘Random’ Effects</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-inspecting-random-effects"><i class="fa fa-check"></i><b>4.6.1</b> Inspecting the random effects</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-simulating"><i class="fa fa-check"></i><b>4.7</b> Simulating data using our model parameters</a></li>
<li class="chapter" data-level="4.8" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-second-random-effect"><i class="fa fa-check"></i><b>4.8</b> Adding a second random effect</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-updating-model"><i class="fa fa-check"></i><b>4.8.1</b> Updating the model description</a></li>
<li class="chapter" data-level="4.8.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fitting-and-interpreting-the-model"><i class="fa fa-check"></i><b>4.8.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-investigating-shrinkage"><i class="fa fa-check"></i><b>4.9</b> Investigating ‘shrinkage’</a></li>
<li class="chapter" data-level="4.10" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-answering-question"><i class="fa fa-check"></i><b>4.10</b> Answering our research questions</a></li>
<li class="chapter" data-level="4.11" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-frequentist"><i class="fa fa-check"></i><b>4.11</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-vs-lmer"><i class="fa fa-check"></i><b>4.11.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#exercises-3"><i class="fa fa-check"></i><b>4.12</b> Exercises</a></li>
<li class="chapter" data-level="4.13" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#references-2"><i class="fa fa-check"></i><b>4.13</b> References</a></li>
<li class="chapter" data-level="4.14" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#plot-code-3"><i class="fa fa-check"></i><b>4.14</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html"><i class="fa fa-check"></i><b>5</b> Comparing two groups of observations: Factors and contrasts</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#chapter-pre-cap-4"><i class="fa fa-check"></i><b>5.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#comparing-two-groups"><i class="fa fa-check"></i><b>5.2</b> Comparing two groups</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#distribution-of-repeated-measures-across-factor-levels"><i class="fa fa-check"></i><b>5.3</b> Distribution of repeated measures across factor levels</a></li>
<li class="chapter" data-level="5.4" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-data-and-qs"><i class="fa fa-check"></i><b>5.4</b> Data and research questions</a></li>
<li class="chapter" data-level="5.5" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-two-means"><i class="fa fa-check"></i><b>5.5</b> Estimating the difference between two means with ‘brms’</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-the-model"><i class="fa fa-check"></i><b>5.5.1</b> Fitting the model</a></li>
<li class="chapter" data-level="5.5.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#interpreting-the-model-1"><i class="fa fa-check"></i><b>5.5.2</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-contrasts"><i class="fa fa-check"></i><b>5.6</b> Contrasts</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-treatment-coding"><i class="fa fa-check"></i><b>5.6.1</b> Treatment coding</a></li>
<li class="chapter" data-level="5.6.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-sum-coding"><i class="fa fa-check"></i><b>5.6.2</b> Sum coding</a></li>
<li class="chapter" data-level="5.6.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-comparison-sum-treatment"><i class="fa fa-check"></i><b>5.6.3</b> Comparison of sum and treatment coding</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-refittin-sum"><i class="fa fa-check"></i><b>5.7</b> Sum coding and the decomposition of variation</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-description-1"><i class="fa fa-check"></i><b>5.7.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.7.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-the-model-1"><i class="fa fa-check"></i><b>5.7.2</b> Fitting the model</a></li>
<li class="chapter" data-level="5.7.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#comparison-of-sum-and-treatment-coding"><i class="fa fa-check"></i><b>5.7.3</b> Comparison of sum and treatment coding</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-working-with-posteriors"><i class="fa fa-check"></i><b>5.8</b> Inspecting and manipulating the posterior samples</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-using-hypothesis"><i class="fa fa-check"></i><b>5.8.1</b> Using the <em>hypothesis</em> function</a></li>
<li class="chapter" data-level="5.8.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-manipulating-random-effects"><i class="fa fa-check"></i><b>5.8.2</b> Working with the random effects</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-robustness"><i class="fa fa-check"></i><b>5.9</b> Making our models more robust: The (non-standardized) t distribution</a></li>
<li class="chapter" data-level="5.10" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#re-fitting-with-t-distributed-errors."><i class="fa fa-check"></i><b>5.10</b> Re-fitting with t-distributed errors</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#description-of-the-model-1"><i class="fa fa-check"></i><b>5.10.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.10.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-and-interpreting-the-model-1"><i class="fa fa-check"></i><b>5.10.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-simulating"><i class="fa fa-check"></i><b>5.11</b> Simulating the two-group model</a></li>
<li class="chapter" data-level="5.12" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-answering-qs"><i class="fa fa-check"></i><b>5.12</b> Answering our research questions</a></li>
<li class="chapter" data-level="5.13" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-frequentist"><i class="fa fa-check"></i><b>5.13</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#bayesian-multilevel-models-vs.-lmer"><i class="fa fa-check"></i><b>5.13.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#exercises-4"><i class="fa fa-check"></i><b>5.14</b> Exercises</a></li>
<li class="chapter" data-level="5.15" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#plot-code-4"><i class="fa fa-check"></i><b>5.15</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html"><i class="fa fa-check"></i><b>6</b> Variation in parameters (‘random effects’) and model comparison</a>
<ul>
<li class="chapter" data-level="6.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#chapter-pre-cap-5"><i class="fa fa-check"></i><b>6.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="6.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-data-and-qs"><i class="fa fa-check"></i><b>6.2</b> Data and research questions</a></li>
<li class="chapter" data-level="6.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-variation-sources"><i class="fa fa-check"></i><b>6.3</b> Variation in parameters across sources of data</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#description-of-our-model"><i class="fa fa-check"></i><b>6.3.1</b> Description of our model</a></li>
<li class="chapter" data-level="6.3.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-correlations"><i class="fa fa-check"></i><b>6.3.2</b> Correlations between random parameters</a></li>
<li class="chapter" data-level="6.3.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-random-and-mvn"><i class="fa fa-check"></i><b>6.3.3</b> Random effects and the multivariate normal distribution</a></li>
<li class="chapter" data-level="6.3.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-mvn-priors"><i class="fa fa-check"></i><b>6.3.4</b> Specifying priors for a multivariate normal distribution</a></li>
<li class="chapter" data-level="6.3.5" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#updating-our-model-description"><i class="fa fa-check"></i><b>6.3.5</b> Updating our model description</a></li>
<li class="chapter" data-level="6.3.6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-fitting"><i class="fa fa-check"></i><b>6.3.6</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-model-comparison"><i class="fa fa-check"></i><b>6.4</b> Model Comparison</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-in-and-out-prediction"><i class="fa fa-check"></i><b>6.4.1</b> In-sample and out-of-sample prediction</a></li>
<li class="chapter" data-level="6.4.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-out-sample-adjust"><i class="fa fa-check"></i><b>6.4.2</b> Out-of-sample prediction: Adjusting predictive accuracy</a></li>
<li class="chapter" data-level="6.4.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-out-sample-crossval"><i class="fa fa-check"></i><b>6.4.3</b> Out-of-sample prediction: Cross validation</a></li>
<li class="chapter" data-level="6.4.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#selecting-a-model"><i class="fa fa-check"></i><b>6.4.4</b> Selecting a model</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-answering"><i class="fa fa-check"></i><b>6.5</b> Answering our research questions</a></li>
<li class="chapter" data-level="6.6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-frequentist"><i class="fa fa-check"></i><b>6.6</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-vs-lmer"><i class="fa fa-check"></i><b>6.6.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#exercises-5"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
<li class="chapter" data-level="6.8" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#references-3"><i class="fa fa-check"></i><b>6.8</b> References</a></li>
<li class="chapter" data-level="6.9" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#plot-code-5"><i class="fa fa-check"></i><b>6.9</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><i class="fa fa-check"></i><b>7</b> Comparing many groups, interactions, and posterior predictive checks</a>
<ul>
<li class="chapter" data-level="7.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#chapter-pre-cap-6"><i class="fa fa-check"></i><b>7.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="7.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#comparing-four-or-any-number-of-groups"><i class="fa fa-check"></i><b>7.2</b> Comparing four (or any number of) groups</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions"><i class="fa fa-check"></i><b>7.2.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.2.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-description-1"><i class="fa fa-check"></i><b>7.2.2</b> Description of our model</a></li>
<li class="chapter" data-level="7.2.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-2"><i class="fa fa-check"></i><b>7.2.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#investigating-multiple-factors-simultaneously"><i class="fa fa-check"></i><b>7.3</b> Investigating multiple factors simultaneously</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions-1"><i class="fa fa-check"></i><b>7.3.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.3.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#description-of-the-model-2"><i class="fa fa-check"></i><b>7.3.2</b> Description of the model</a></li>
<li class="chapter" data-level="7.3.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-3"><i class="fa fa-check"></i><b>7.3.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-posterior-prediction"><i class="fa fa-check"></i><b>7.4</b> Posterior prediction: Using our models to predict new data</a></li>
<li class="chapter" data-level="7.5" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-interactions-and-plots"><i class="fa fa-check"></i><b>7.5</b> Interactions and interaction plots</a></li>
<li class="chapter" data-level="7.6" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#investigating-interactions-with-a-model"><i class="fa fa-check"></i><b>7.6</b> Investigating interactions with a model</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions-2"><i class="fa fa-check"></i><b>7.6.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.6.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#model-formulas"><i class="fa fa-check"></i><b>7.6.2</b> Model formulas</a></li>
<li class="chapter" data-level="7.6.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#description-of-our-model-1"><i class="fa fa-check"></i><b>7.6.3</b> Description of our model</a></li>
<li class="chapter" data-level="7.6.4" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-4"><i class="fa fa-check"></i><b>7.6.4</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="7.6.5" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-calc-means"><i class="fa fa-check"></i><b>7.6.5</b> Caulculating group means in the presence of interactions</a></li>
<li class="chapter" data-level="7.6.6" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#calculating-simple-effects-in-the-presence-of-interactions"><i class="fa fa-check"></i><b>7.6.6</b> Calculating simple effects in the presence of interactions</a></li>
<li class="chapter" data-level="7.6.7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#assessing-model-fit-bayesian-r2"><i class="fa fa-check"></i><b>7.6.7</b> Assessing model fit: Bayesian <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-answering"><i class="fa fa-check"></i><b>7.7</b> Answering our research questions</a></li>
<li class="chapter" data-level="7.8" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#factors-with-more-than-two-levels"><i class="fa fa-check"></i><b>7.8</b> Factors with more than two levels</a></li>
<li class="chapter" data-level="7.9" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-frequentist"><i class="fa fa-check"></i><b>7.9</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#bayesian-multilevel-models-vs.-lmer-1"><i class="fa fa-check"></i><b>7.9.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#exercises-6"><i class="fa fa-check"></i><b>7.10</b> Exercises</a></li>
<li class="chapter" data-level="7.11" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#references-4"><i class="fa fa-check"></i><b>7.11</b> References</a></li>
<li class="chapter" data-level="7.12" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#plot-code-6"><i class="fa fa-check"></i><b>7.12</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html"><i class="fa fa-check"></i><b>8</b> Varying variances, more about priors, and prior predictive checks</a>
<ul>
<li class="chapter" data-level="8.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#chapter-pre-cap-7"><i class="fa fa-check"></i><b>8.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="8.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#data-and-research-questions-3"><i class="fa fa-check"></i><b>8.2</b> Data and Research questions</a></li>
<li class="chapter" data-level="8.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#more-about-priors"><i class="fa fa-check"></i><b>8.3</b> More about priors</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-prior-prediction"><i class="fa fa-check"></i><b>8.3.1</b> Prior predictive checks</a></li>
<li class="chapter" data-level="8.3.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#more-specific-priors"><i class="fa fa-check"></i><b>8.3.2</b> More specific priors</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#heteroskedasticity-and-distributional-or-mixture-models"><i class="fa fa-check"></i><b>8.4</b> Heteroskedasticity and distributional (or mixture) models</a></li>
<li class="chapter" data-level="8.5" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#a-simple-model-error-varies-according-to-a-single-fixed-effect"><i class="fa fa-check"></i><b>8.5</b> A ‘simple’ model: Error varies according to a single fixed effect</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#description-of-our-model-2"><i class="fa fa-check"></i><b>8.5.1</b> Description of our model</a></li>
<li class="chapter" data-level="8.5.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#prior-predictive-checks"><i class="fa fa-check"></i><b>8.5.2</b> Prior predictive checks</a></li>
<li class="chapter" data-level="8.5.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fitting-and-interpreting-the-model-5"><i class="fa fa-check"></i><b>8.5.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#a-complex-model-error-varies-according-to-fixed-and-random-effects"><i class="fa fa-check"></i><b>8.6</b> A ‘complex’ model: Error varies according to fixed and random effects</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-description-2"><i class="fa fa-check"></i><b>8.6.1</b> Description of our model</a></li>
<li class="chapter" data-level="8.6.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fitting-and-interpreting-the-model-6"><i class="fa fa-check"></i><b>8.6.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#answering-our-research-questions"><i class="fa fa-check"></i><b>8.7</b> Answering our research questions</a></li>
<li class="chapter" data-level="8.8" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-identifiability"><i class="fa fa-check"></i><b>8.8</b> Building identifiable and supportable models</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#collinearity"><i class="fa fa-check"></i><b>8.8.1</b> Collinearity</a></li>
<li class="chapter" data-level="8.8.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#predictable-values-of-categorical-predictors"><i class="fa fa-check"></i><b>8.8.2</b> Predictable values of categorical predictors</a></li>
<li class="chapter" data-level="8.8.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#saturated-and-nearly-saturated-models"><i class="fa fa-check"></i><b>8.8.3</b> Saturated, and ‘nearly-saturated’, models</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#exercises-7"><i class="fa fa-check"></i><b>8.9</b> Exercises</a></li>
<li class="chapter" data-level="8.10" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#references-5"><i class="fa fa-check"></i><b>8.10</b> References</a></li>
<li class="chapter" data-level="8.11" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#plot-code-7"><i class="fa fa-check"></i><b>8.11</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html"><i class="fa fa-check"></i><b>9</b> Quantitative predictors and their interactions with factors</a>
<ul>
<li class="chapter" data-level="9.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#chapter-pre-cap-8"><i class="fa fa-check"></i><b>9.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="9.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#data-and-research-questions-4"><i class="fa fa-check"></i><b>9.2</b> Data and research questions</a></li>
<li class="chapter" data-level="9.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#modeling-variation-along-lines"><i class="fa fa-check"></i><b>9.3</b> Modeling variation along lines</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-3"><i class="fa fa-check"></i><b>9.3.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.3.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-centering"><i class="fa fa-check"></i><b>9.3.2</b> Centering quantitative predictors</a></li>
<li class="chapter" data-level="9.3.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-an-interpreting-the-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting an interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-group-dependent-intercepts-but-shared-slopes"><i class="fa fa-check"></i><b>9.4</b> Models with group-dependent intercepts, but shared slopes</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-4"><i class="fa fa-check"></i><b>9.4.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.4.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-and-interpreting-the-model-7"><i class="fa fa-check"></i><b>9.4.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.4.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#interpreting-group-effects-in-the-presence-of-shared-non-zero-slopes"><i class="fa fa-check"></i><b>9.4.3</b> Interpreting group effects in the presence of shared (non-zero) slopes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-group-dependent-slopes-and-intercepts"><i class="fa fa-check"></i><b>9.5</b> Models with group-dependent slopes and intercepts</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-5"><i class="fa fa-check"></i><b>9.5.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.5.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-fitting-3"><i class="fa fa-check"></i><b>9.5.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.5.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#interpreting-group-effects-in-the-presence-of-varying-slopes"><i class="fa fa-check"></i><b>9.5.3</b> Interpreting group effects in the presence of varying slopes</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#answering-our-research-questions-interim-discussion"><i class="fa fa-check"></i><b>9.6</b> Answering our research questions: Interim discussion</a></li>
<li class="chapter" data-level="9.7" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#data-and-research-questions-updated"><i class="fa fa-check"></i><b>9.7</b> Data and research questions: Updated</a></li>
<li class="chapter" data-level="9.8" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-intercepts-and-slopes-for-each-level-of-a-grouping-factor-i.e.-random-slopes"><i class="fa fa-check"></i><b>9.8</b> Models with intercepts and slopes for each level of a grouping factor (i.e. ‘random slopes’)</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-6"><i class="fa fa-check"></i><b>9.8.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.8.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-and-interpreting-the-model-8"><i class="fa fa-check"></i><b>9.8.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-multiple-predictors-for-each-level-of-a-grouping-factor"><i class="fa fa-check"></i><b>9.9</b> Models with multiple predictors for each level of a grouping factor</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-7"><i class="fa fa-check"></i><b>9.9.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.9.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-fitting-5"><i class="fa fa-check"></i><b>9.9.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.9.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#model-selection"><i class="fa fa-check"></i><b>9.9.3</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#answering-our-research-questions-updated"><i class="fa fa-check"></i><b>9.10</b> Answering our research questions: Updated</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#a-word-on-causality"><i class="fa fa-check"></i><b>9.10.1</b> A word on causality</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#exercises-8"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
<li class="chapter" data-level="9.12" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#references-6"><i class="fa fa-check"></i><b>9.12</b> References</a></li>
<li class="chapter" data-level="9.13" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#plot-code-8"><i class="fa fa-check"></i><b>9.13</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html"><i class="fa fa-check"></i><b>10</b> Logistic regression and signal detection theory models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#chapter-pre-cap-9"><i class="fa fa-check"></i><b>10.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="10.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-dichotomous"><i class="fa fa-check"></i><b>10.2</b> Dichotomous variables and data</a></li>
<li class="chapter" data-level="10.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#generalizing-our-linear-models"><i class="fa fa-check"></i><b>10.3</b> Generalizing our linear models</a></li>
<li class="chapter" data-level="10.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logistic-regression"><i class="fa fa-check"></i><b>10.4</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logits"><i class="fa fa-check"></i><b>10.4.1</b> Logits</a></li>
<li class="chapter" data-level="10.4.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-inverse-logit"><i class="fa fa-check"></i><b>10.4.2</b> The inverse logit link function</a></li>
<li class="chapter" data-level="10.4.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#building-intuitions-about-logits-and-the-inverse-logit-function"><i class="fa fa-check"></i><b>10.4.3</b> Building intuitions about logits and the inverse logit function</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logistic-regression-with-one-quantitative-predictor"><i class="fa fa-check"></i><b>10.5</b> Logistic regression with one quantitative predictor</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#data-and-research-questions-5"><i class="fa fa-check"></i><b>10.5.1</b> Data and research questions</a></li>
<li class="chapter" data-level="10.5.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#description-of-the-model-8"><i class="fa fa-check"></i><b>10.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="10.5.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-fitting-0"><i class="fa fa-check"></i><b>10.5.3</b> Fitting the model</a></li>
<li class="chapter" data-level="10.5.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-fitting-1"><i class="fa fa-check"></i><b>10.5.4</b> Interpreting the model</a></li>
<li class="chapter" data-level="10.5.5" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-classification"><i class="fa fa-check"></i><b>10.5.5</b> Using logistic models to understand classification</a></li>
<li class="chapter" data-level="10.5.6" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#answering-our-research-question"><i class="fa fa-check"></i><b>10.5.6</b> Answering our research question</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#measuring-sensitivity-and-bias"><i class="fa fa-check"></i><b>10.6</b> Measuring sensitivity and bias</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#data-and-research-questions-6"><i class="fa fa-check"></i><b>10.6.1</b> Data and research questions</a></li>
<li class="chapter" data-level="10.6.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#description-of-the-model-9"><i class="fa fa-check"></i><b>10.6.2</b> Description of the model</a></li>
<li class="chapter" data-level="10.6.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#fitting-and-interpreting-the-model-9"><i class="fa fa-check"></i><b>10.6.3</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="10.6.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#answering-our-research-questions-1"><i class="fa fa-check"></i><b>10.6.4</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#exercises-9"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
<li class="chapter" data-level="10.8" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#references-7"><i class="fa fa-check"></i><b>10.8</b> References</a></li>
<li class="chapter" data-level="10.9" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#plot-code-9"><i class="fa fa-check"></i><b>10.9</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><i class="fa fa-check"></i><b>11</b> Multiple quantitative predictors, dealing with large models, and Bayesian ANOVA</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#chapter-pre-cap-10"><i class="fa fa-check"></i><b>11.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="11.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#models-with-multiple-quantitative-predictors"><i class="fa fa-check"></i><b>11.2</b> Models with multiple quantitative predictors</a></li>
<li class="chapter" data-level="11.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#interactions-between-quantitative-predictors"><i class="fa fa-check"></i><b>11.3</b> Interactions between quantitative predictors</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#centering-quantitative-predictors-when-including-interactions"><i class="fa fa-check"></i><b>11.3.1</b> Centering quantitative predictors when including interactions</a></li>
<li class="chapter" data-level="11.3.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#data-and-research-questions-7"><i class="fa fa-check"></i><b>11.3.2</b> Data and research questions</a></li>
<li class="chapter" data-level="11.3.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c11-description-1"><i class="fa fa-check"></i><b>11.3.3</b> Description of the model</a></li>
<li class="chapter" data-level="11.3.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-the-model-2"><i class="fa fa-check"></i><b>11.3.4</b> Fitting the model</a></li>
<li class="chapter" data-level="11.3.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#advantages-of-bayesian-multilevel-models-for-large-models"><i class="fa fa-check"></i><b>11.3.5</b> Advantages of Bayesian multilevel models for large models</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c11-BANOVA"><i class="fa fa-check"></i><b>11.4</b> Bayesian Analysis of Variance</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#getting-the-standard-deviations-from-our-models-manually"><i class="fa fa-check"></i><b>11.4.1</b> Getting the standard deviations from our models ‘manually’</a></li>
<li class="chapter" data-level="11.4.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#using-the-banova-function"><i class="fa fa-check"></i><b>11.4.2</b> Using the <code>banova</code> function</a></li>
<li class="chapter" data-level="11.4.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-and-comparing-the-reduced-model"><i class="fa fa-check"></i><b>11.4.3</b> Fitting and comparing the reduced model</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#a-logistic-regression-model-with-multiple-quantitative-predictors"><i class="fa fa-check"></i><b>11.5</b> A logistic regression model with multiple quantitative predictors</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#data-and-research-questions-8"><i class="fa fa-check"></i><b>11.5.1</b> Data and research questions</a></li>
<li class="chapter" data-level="11.5.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#description-of-the-model-10"><i class="fa fa-check"></i><b>11.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="11.5.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-and-the-model-and-applying-a-bayesian-anova"><i class="fa fa-check"></i><b>11.5.3</b> Fitting and the model and applying a Bayesian ANOVA</a></li>
<li class="chapter" data-level="11.5.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c12-2d-categorization"><i class="fa fa-check"></i><b>11.5.4</b> Categorization in two dimensions</a></li>
<li class="chapter" data-level="11.5.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#model-selection-and-misspecification"><i class="fa fa-check"></i><b>11.5.5</b> Model selection and misspecification</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#exercises-10"><i class="fa fa-check"></i><b>11.6</b> Exercises</a></li>
<li class="chapter" data-level="11.7" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#references-8"><i class="fa fa-check"></i><b>11.7</b> References</a></li>
<li class="chapter" data-level="11.8" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#plot-code-10"><i class="fa fa-check"></i><b>11.8</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html"><i class="fa fa-check"></i><b>12</b> Multinomial and Ordinal regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#chapter-pre-cap-11"><i class="fa fa-check"></i><b>12.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="12.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>12.2</b> Multinomial logistic regression</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#multinomial-logits-and-the-softmax-function"><i class="fa fa-check"></i><b>12.2.1</b> Multinomial logits and the softmax function</a></li>
<li class="chapter" data-level="12.2.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#comparison-to-logistic-regression"><i class="fa fa-check"></i><b>12.2.2</b> Comparison to logistic regression</a></li>
<li class="chapter" data-level="12.2.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#data-and-research-questions-9"><i class="fa fa-check"></i><b>12.2.3</b> Data and research questions</a></li>
<li class="chapter" data-level="12.2.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#description-of-our-model-3"><i class="fa fa-check"></i><b>12.2.4</b> Description of our model</a></li>
<li class="chapter" data-level="12.2.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#fitting-the-model-3"><i class="fa fa-check"></i><b>12.2.5</b> Fitting the model</a></li>
<li class="chapter" data-level="12.2.6" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#interpreting-the-model-2"><i class="fa fa-check"></i><b>12.2.6</b> Interpreting the model</a></li>
<li class="chapter" data-level="12.2.7" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#c12-multinomial-territorial-maps"><i class="fa fa-check"></i><b>12.2.7</b> Multinomial models and territorial maps</a></li>
<li class="chapter" data-level="12.2.8" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#refitting-the-model-without-speaker-random-effects"><i class="fa fa-check"></i><b>12.2.8</b> Refitting the model without speaker random effects</a></li>
<li class="chapter" data-level="12.2.9" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#answering-our-research-questions-2"><i class="fa fa-check"></i><b>12.2.9</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#ordinal-logistic-regression"><i class="fa fa-check"></i><b>12.3</b> Ordinal (logistic) regression</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#c12-cumulative-density"><i class="fa fa-check"></i><b>12.3.1</b> Cumulative distribution functions</a></li>
<li class="chapter" data-level="12.3.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#data-and-research-questions-10"><i class="fa fa-check"></i><b>12.3.2</b> Data and research questions</a></li>
<li class="chapter" data-level="12.3.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#description-of-the-model-11"><i class="fa fa-check"></i><b>12.3.3</b> Description of the model</a></li>
<li class="chapter" data-level="12.3.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#fitting-and-interpreting-the-model-10"><i class="fa fa-check"></i><b>12.3.4</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="12.3.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#listener-specific-discrimination-terms"><i class="fa fa-check"></i><b>12.3.5</b> Listener-specific discrimination terms</a></li>
<li class="chapter" data-level="12.3.6" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#answering-our-research-questions-3"><i class="fa fa-check"></i><b>12.3.6</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#exercises-11"><i class="fa fa-check"></i><b>12.4</b> Exercises</a></li>
<li class="chapter" data-level="12.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#references-9"><i class="fa fa-check"></i><b>12.5</b> References</a></li>
<li class="chapter" data-level="12.6" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#plot-code-11"><i class="fa fa-check"></i><b>12.6</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><i class="fa fa-check"></i><b>13</b> Writing up experiments: An investigation of the perception of apparent speaker characteristics from speech acoustics</a>
<ul>
<li class="chapter" data-level="13.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#introduction"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#fundamental-frequency-and-voice-pitch"><i class="fa fa-check"></i><b>13.1.1</b> Fundamental frequency and voice pitch</a></li>
<li class="chapter" data-level="13.1.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#variation-in-fundamental-frequency-between-speakers"><i class="fa fa-check"></i><b>13.1.2</b> Variation in fundamental frequency between speakers</a></li>
<li class="chapter" data-level="13.1.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#voice-resonance-and-vocal-tract-length"><i class="fa fa-check"></i><b>13.1.3</b> Voice resonance and vocal-tract length</a></li>
<li class="chapter" data-level="13.1.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-estimating-vtl"><i class="fa fa-check"></i><b>13.1.4</b> Estimating vocal-tracts length from speech</a></li>
<li class="chapter" data-level="13.1.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#variation-in-vocal-tract-length-between-speakers"><i class="fa fa-check"></i><b>13.1.5</b> Variation in vocal-tract length between speakers</a></li>
<li class="chapter" data-level="13.1.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-perception-of-chars"><i class="fa fa-check"></i><b>13.1.6</b> Perception of age, gender and size</a></li>
<li class="chapter" data-level="13.1.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#category-dependent-behavior"><i class="fa fa-check"></i><b>13.1.7</b> Category-dependent behavior</a></li>
<li class="chapter" data-level="13.1.8" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#the-current-experiment"><i class="fa fa-check"></i><b>13.1.8</b> The current experiment</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#methods"><i class="fa fa-check"></i><b>13.2</b> Methods</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#participants"><i class="fa fa-check"></i><b>13.2.1</b> Participants</a></li>
<li class="chapter" data-level="13.2.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-stimuli"><i class="fa fa-check"></i><b>13.2.2</b> Stimuli</a></li>
<li class="chapter" data-level="13.2.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#procedure"><i class="fa fa-check"></i><b>13.2.3</b> Procedure</a></li>
<li class="chapter" data-level="13.2.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#data-screening"><i class="fa fa-check"></i><b>13.2.4</b> Data screening</a></li>
<li class="chapter" data-level="13.2.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#loading-the-data-and-packages"><i class="fa fa-check"></i><b>13.2.5</b> Loading the data and packages</a></li>
<li class="chapter" data-level="13.2.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#statistical-analysis-apparent-height"><i class="fa fa-check"></i><b>13.2.6</b> Statistical Analysis: Apparent height</a></li>
<li class="chapter" data-level="13.2.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#statistical-analysis-apparent-gender"><i class="fa fa-check"></i><b>13.2.7</b> Statistical Analysis: Apparent gender</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#results-apparent-height-judgments"><i class="fa fa-check"></i><b>13.3</b> Results: Apparent height judgments</a></li>
<li class="chapter" data-level="13.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#discussion-apparent-height"><i class="fa fa-check"></i><b>13.4</b> Discussion: Apparent height</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#age-dependent-use-of-vtl-cues-on-apparent-height"><i class="fa fa-check"></i><b>13.4.1</b> Age-dependent use of VTL cues on apparent height</a></li>
<li class="chapter" data-level="13.4.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#the-effect-for-apparent-gender-on-apparent-height"><i class="fa fa-check"></i><b>13.4.2</b> The effect for apparent gender on apparent height</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#conclusion-apparent-height-judgments"><i class="fa fa-check"></i><b>13.5</b> Conclusion: Apparent height judgments</a></li>
<li class="chapter" data-level="13.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#results-apparent-gender-judgments"><i class="fa fa-check"></i><b>13.6</b> Results: Apparent gender judgments</a></li>
<li class="chapter" data-level="13.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#discussion-apparent-gender-judgments"><i class="fa fa-check"></i><b>13.7</b> Discussion: Apparent gender judgments</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#effect-of-apparent-age-on-the-perception-of-femaleness"><i class="fa fa-check"></i><b>13.7.1</b> Effect of apparent age on the perception of femaleness</a></li>
<li class="chapter" data-level="13.7.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#between-listener-variation-in-gender-perception"><i class="fa fa-check"></i><b>13.7.2</b> Between-listener variation in gender perception</a></li>
<li class="chapter" data-level="13.7.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#beyond-gross-acoustic-cues-in-gender-perception"><i class="fa fa-check"></i><b>13.7.3</b> Beyond gross acoustic cues in gender perception</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#conclusion-apparent-gender"><i class="fa fa-check"></i><b>13.8</b> Conclusion: Apparent gender</a></li>
<li class="chapter" data-level="13.9" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#next-steps"><i class="fa fa-check"></i><b>13.9</b> Next steps</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#research-design-variable-selection-etc."><i class="fa fa-check"></i><b>13.9.1</b> Research design, variable selection, etc.</a></li>
<li class="chapter" data-level="13.9.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#non-linear-models"><i class="fa fa-check"></i><b>13.9.2</b> Non-linear models</a></li>
<li class="chapter" data-level="13.9.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#other-data-distributions"><i class="fa fa-check"></i><b>13.9.3</b> Other data distributions</a></li>
<li class="chapter" data-level="13.9.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#multivariate-analyses"><i class="fa fa-check"></i><b>13.9.4</b> Multivariate analyses</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#references-10"><i class="fa fa-check"></i><b>13.10</b> References</a></li>
<li class="chapter" data-level="13.11" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#plot-code-12"><i class="fa fa-check"></i><b>13.11</b> Plot Code</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/santiagobarreda/bmmrmd" target="blank">Book GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Inspecting a ‘single group’ of observations using a Bayesian multilevel model<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the last chapter we built a Bayesian regression model suitable for inspecting the average of a single group of observations. However, as we noted multiple times this model was ‘wrong’ for the structure of our data. The reason for this is that this model did not properly account for the <em>repeated measures</em> structure in our data. To properly handle repeated measures data, we need a <em>multilevel model</em>. In this chapter we will explain what we mean by ‘repeated measures’ and ‘multilevel’, in addition to fitting our first proper multilevel Bayesian model using <code>brms</code>.</p>
<div id="chapter-pre-cap-3" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Chapter pre-cap<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#chapter-pre-cap-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, models comparing two groups are discussed and the concept of between and within-subjects factors is introduced. Factor coding is presented, and treatment and sum coding are compared. The decomposition of variation in the dependent variable into effects associated with independent variables is discussed, as is the difficulty of establishing causal relationships using statistical models. A sum coded model comparing two groups is fit and compared to a treatment coded model fit to the same data. There is a discussion on retrieving and manipulating the model posterior samples, including the importance of combining parameters before summarizing them. The <code>hypothesis</code> function is introduced, and the retrieval and combination of ‘random effect’ parameters is explained. Finally, there is a discussion of outliers and robustness, and the t distribution is presented. A model with t distributed errors is fit and compared to the model assuming normal errors.</p>
</div>
<div id="c4-multilevel" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Repeated measures data<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-multilevel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Depending on the field of study, experiments often produce <strong>repeated measures data</strong>, data where multiple observations come from the same experimental unit (e.g., individual listeners, as in the data used in this book). As a practical matter, setting up experiments is often time consuming such that it often makes more sense to collect, for example, 100 observations from each of 50 different people, rather than 1 observation from each of 5000 different people. In addition, collecting more than one measurement from each source can go a long way towards reducing uncertainty in a model. However, the statistical analysis of repeated measures data requires models that take the repeated nature of the measurements into account. Treating repeated measures data as if it were <em>not</em> repeated measures data can cause problems for the inferences we make using statistical models.</p>
<p>For example, in our experiment we are interested in the average apparent height of different speakers, or categories of speakers. Imagine we had an experiment with 10,000 total observations. Would it matter how these were distributed? What if we had 5,000 observations for each of two different speakers? In this case we would have a lot of information about the apparent height of these speakers but not much information about speakers in general. What if we had 10 observations for each of 1000 different speakers? In this case we would have much more information about the apparent height of speakers in general, given the same number of overall observations. However, we have a lot less information about any individual speaker in the sample. So, we see two situations with the same total number of observations but a substantially different internal structure.</p>
<p>In general, the reason repeated measures data can cause problems when not modeled appropriately is because the observations within each experimental unit are not independent: Multiple measurements from the same person are probably going to be similar to each other. This can give us a warped perspective regarding the degree and nature of the variability in a set of observations when repeated measures data is not modeled appropriately. For example, the final model we used to analyze our data in the last chapter looked like this:</p>
<p><span class="math display" id="eq:4-1">\[
\begin{equation}
\begin{split}
\\
height_{[i]} \sim \mathrm{N}(\mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{Intercept} \\
\\
\textrm{Priors:} \\
\mathrm{Intercept} \sim \mathrm{N}(176, 15) \\
\sigma \sim \mathrm{N}(0, 15) \\
\end{split}
\tag{4.1}
\end{equation}
\]</span></p>
<p>We’re going to consider the same data we discussed in Chapter 2 and 3, the apparent height judgments made for the adult male speakers in our experiment in the actual, unmodified resonance condition (see section <a href="introduction-experiments-and-variables.html#c1-exp">1.3</a>). Below we load the data that includes only these trials (<code>exp_data</code>) and subset to include only veridical male speakers:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (bmmb)</span>
<span id="cb86-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span> (exp_data)</span>
<span id="cb86-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb86-3" aria-hidden="true" tabindex="-1"></a>men <span class="ot">=</span> exp_data[exp_data<span class="sc">$</span>C_v<span class="sc">==</span><span class="st">&#39;m&#39;</span>,]</span>
<span id="cb86-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of height judgments</span></span>
<span id="cb86-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb86-6" aria-hidden="true" tabindex="-1"></a>mens_height <span class="ot">=</span> men<span class="sc">$</span>height</span></code></pre></div>
<p>Figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-1">4.1</a> presents the height judgments collected for adult male speakers in our experiment, organized in two different ways. In the left plot we see the marginal distribution of the data with no differentiation made for the data collected from different listeners. This boxplot shows the individual observations of our vector <span class="math inline">\(height_{[i]}\)</span> around the overall mean <span class="math inline">\(\mu\)</span> with a standard distribution equal to <span class="math inline">\(\sigma\)</span>. In other words, the left boxplot represents the model presented in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-1">(4.1)</a>. From the perspective of this model, an observation of 181 cm is +7 above the mean, regardless of who provided it, because 174 cm is the assumed mean for all listeners. As a consequence, all variation about the mean is noise. There is no systematic structure ‘inside’ that single giant box of data.</p>
<div class="figure"><span style="display:block;" id="fig:F4-1"></span>
<img src="_main_files/figure-html/F4-1-1.jpeg" alt="(left) Distribution of all apparent height judgments for adult male speakers. (right) Distribution of height judgments for adult male speakers, individually for each listener." width="4800" />
<p class="caption">
Figure 4.1: (left) Distribution of all apparent height judgments for adult male speakers. (right) Distribution of height judgments for adult male speakers, individually for each listener.
</p>
</div>
<p>In the right plot we see each listener’s height judgments in a different boxplot. Clearly, each listener has a general tendency so that certain values are more or less surprising for individual listeners. For example, a height response of 181 cm is perfectly average for listener 6 (blue box, 6th from the bottom). Thus, if you know listener 6 provided a response, an apparent height of 181 cm should not be surprising. In fact, this would represent an error of 0 cm when provided by this listener, considered relative to their expected apparent height judgment. In contrast, a response of 174 cm, the overall average response, would be a relatively atypical response for this listener.</p>
<p>The failure to acknowledge the fact that listeners provided non-independent responses might not seem like a big deal but it really is. Remember from section <a href="probabilities-likelihood-and-inference.html#c2-joint">2.3.2</a> that the calculation of joint probabilities (and densities) is ‘easy’ only if the model residuals are assumed to be independent. Well, in the right side of figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-1">4.1</a> we see that all of our errors (i.e. deviations from the intercept at 174 cm) are definitely <em>not</em> independent, which means that ignoring this fact is going to lead to inaccuracies throughout our models. It’s also a fact that we actually <em>do</em> have different listeners providing our data, and they do appear to vary from each other, and maybe we want to represent this in our model.</p>
<div id="c4-levels" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Multilevel models and ‘levels’ of variation<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can think of the repeated measures data presented in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-1">4.1</a> as having multiple ‘levels’ of variation. These levels are often referred to as <em>upper</em> and <em>lower</em> but this is entirely metaphorical/conceptual. Another way to think of them is as within-group variation (lower) and between-group variation (upper). We will describe these ‘levels’ of variation with respect to our repeated measures data involving the apparent heights of adult males presented in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-1">4.1</a>.</p>
<ul>
<li><p>The ‘lower’ level: The data-level distribution of individual observations given a certain listener. This is the distribution of data points inside of each of the little boxes in the right plot in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-1">4.1</a>. If not for this variation, the boxes in the plot would all be clustered about their respective listener means. So, the lower level of variation gives the listener boxes their widths, and causes one response provided by a listener to differ randomly from another response from the same listener. For the sake of simplicity, our models usually assume that the standard deviation is equal to <span class="math inline">\(\sigma\)</span> for all of the listener-dependent distributions, though our models can relax this assumption (see chapter 8).</p></li>
<li><p>The ‘upper’ level: The distribution of <em>parameters</em> between your sources of data. The upper level of variation causes the boxes in the right plot of figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-1">4.1</a> to not all be aligned at the grand mean. Although the listener mean is a parameter for the distribution of apparent height responses given a listener, it can also be thought of as a random variable. When we run an experiment we randomly ‘sample’ a small number of values of this variable by selecting a small number of humans to participate in our experiment. We might expect the average reported height for a single listener to be a relatively stable property such that a replication with the same listener should result in about the same listener mean. However, it’s impossible to know any given listener’s average apparent height judgment a priori. As a result, our listener means are as unpredictable to us as the individual responses provided by those listeners.</p></li>
</ul>
<p>A <strong>multilevel model</strong> is a special kind of regression model that’s able to simultaneously estimate random variation at multiple ‘levels’. A multilevel model fit to our height judgments would be able to estimate the average reported by each listener, the variation in listener means, and the random within-listener variation, all at the same time. Model parameters describe some tendency in the data. For now we’re just talking about average values. So, our model describes listeners in terms of their average response, which it encodes using parameters related to the listener means. As a result, when we say “the distribution of parameters” to refer to the distribution of listener means, we’re really saying “the distribution of listener characteristics”. So, when we say “multilevel models model variation at the data level and the parameter level”, we’re basically saying “multilevel models allow us to model the variation of data within listeners, and of parameters/characteristics between listeners”.</p>
<p>Figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-2">4.2</a> compares visual representations of the same data, the points <span class="math inline">\(y_{[1]} \dots y_{[6]}\)</span>, represented as unilevel or multilevel models. In the unilevel model there is only one distribution, the data distribution, and a single random source of variation, the data-level error <span class="math inline">\(\sigma\)</span>. Since there is no ‘upper’ level describing between-listener variation, our model doesn’t ‘know’ our data contains repeated observations from a small number of listeners. In addition, our model has no mechanism by which to explain, for example, why <span class="math inline">\(y_{[1]}\)</span> and <span class="math inline">\(y_{[2]}\)</span> have such low values. This model treats all deviations from the mean as random and therefore acts as if systematic between-listener variation did not exist. It also treats all variation around the mean as totally independent, which we know it is not.</p>
<div class="figure"><span style="display:block;" id="fig:F4-2"></span>
<img src="../wrong_plots/Figure 4.2.jpg" alt="Comparison of the structure of a statistical model with only a single level of variation (a 'unilevel model', left), to a model with multiple levels of variation (a multilevel model, right)." width="100%" />
<p class="caption">
Figure 4.2: Comparison of the structure of a statistical model with only a single level of variation (a ‘unilevel model’, left), to a model with multiple levels of variation (a multilevel model, right).
</p>
</div>
<p>In contrast, the multilevel model in the same figure introduces an intervening second level between the observations and the grand mean <span class="math inline">\(\mu\)</span>. This level features some new symbols, these are:</p>
<ol style="list-style-type: decimal">
<li><p>listener-specific effects representing the difference between the listener mean and the grand mean, <span class="math inline">\(L_{[j]}\)</span> for listener j.</p></li>
<li><p><span class="math inline">\(\sigma_L\)</span>, the standard deviation of the listener effects.</p></li>
</ol>
<p>Notice that we are now estimating two variance components, the data-level error (<span class="math inline">\(\sigma\)</span>) and the random between-listener variation <span class="math inline">\(\sigma_L\)</span>. This seemingly small difference in structure results in important changes in our model. For example, since the total amount of variation in the data is fixed, as variation in the second level (<span class="math inline">\(\sigma_L\)</span>) grows larger, variation at the first level (<span class="math inline">\(\sigma\)</span>) <em>necessarily</em> gets smaller.</p>
<p>We can see this happening in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-2">4.2</a>. In the unilevel model, <span class="math inline">\(y_{[1]}\)</span> and <span class="math inline">\(y_{[2]}\)</span> where low values ‘for no reason’, resulting in large deviations from our expectations and a large <span class="math inline">\(\sigma\)</span> (the blue distribution). Now, we know that <span class="math inline">\(y_{[1]}\)</span> and <span class="math inline">\(y_{[2]}\)</span> are low because listener 2 (<span class="math inline">\(L_{[2]}\)</span>) tends to provide low values. As a result, the large deviations between <span class="math inline">\(y_{[1]}\)</span>, <span class="math inline">\(y_{[2]}\)</span>, and the grand mean (<span class="math inline">\(\mu\)</span>) are mainly attributed to <span class="math inline">\(\sigma_L\)</span> (the green distribution) rather than <span class="math inline">\(\sigma\)</span>. In the multilevel model, it is only the relatively small amount of within-listener variation that is directly attributed to <span class="math inline">\(\sigma\)</span>, resulting in a substantial reduction in the data-level error.</p>
<p>One thing to note is that if there is no between-listener variation, i.e. if <span class="math inline">\(\sigma_L=0\)</span>, the the multilevel model above converges <em>structurally</em> on the unilevel model. For example, if <span class="math inline">\(\sigma_L\)</span> is near zero all the listener effects would need to have very small values. If this occurred, all the densities at the lower level in the right plot in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-2">4.2</a> would overlap, and look a lot like the single density in the left side of the figure. In addition, the second level distribution would effectively be meaningless/useless since it would represent no systematic variation between listeners. This potential equivalence is a very important feature of multilevel models. Since the multilevel model <em>estimates</em> values of <span class="math inline">\(L\)</span> and <span class="math inline">\(\sigma_L\)</span>, the outcome <span class="math inline">\(\sigma_L \approx 0\)</span> is within the realm of possibility. So, fitting a multilevel model allows one to investigate the very existence of systematic variation in parameters across research units (e.g. listeners) but does not necessarily <em>impose</em> this on data if such systematic variation is not present.</p>
</div>
</div>
<div id="c4-many-levels" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Representing predictors with many levels<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-many-levels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before moving on to a discussion of multilevel models and parameter estimation strategies, we want to take a moment to discuss some practical and notational issues that arise when your models include factors with large numbers of levels. First, we will discuss a way to efficiently represent models including factors with many levels as predictors. After that, we will discuss some ‘quirks’ in the way that R names model parameters and the way that we’ve chosen to represent this in our model notation.</p>
<p>R treats nominal, categorical predictors (such as listener) as <em>factors</em> and assumes that each different label represents a different group. Each value of a factor is called a <em>level</em>. Although we can indicate listeners using numbers, we’re not treating this predictor as numerical or otherwise quantitative. Instead, we treat listener (<code>L</code>) as a factor, and the individual listeners in the experiments are its levels. As far as our models are concerned, participant/speaker/subject/listener has no special status as a predictor and it is just a factor with (usually) many levels.</p>
<p>In order to estimate a separate effect for each listener, we need to add 15 parameters to our model, <span class="math inline">\(L_{[1]},...,L_{[15]}\)</span>, one for each listener. In order to represent these predictors, our model descriptions could include a predictor for each listener coefficient that would equal one or zero based on whether the row was contributed by that listener (1) or not (0). For example, in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-2">(4.2)</a> we see a line consisting of a set of 15 predictors associated with the <span class="math inline">\(L\)</span> coefficients, all multiplied by zero save for the second one. The effect of this, seen in the second line in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-2">(4.2)</a>, is to only have the second listener coefficient contribute to the predicted value for observation <span class="math inline">\(i\)</span>. In other words, observation <span class="math inline">\(i\)</span> was contributed by listener 2 for this data.</p>
<p><span class="math display" id="eq:4-2">\[
\begin{equation}
\begin{split}
\mu_{[i]} = \mathrm{Intercept} + L_{[1]} \cdot 0 + L_{[2]} \cdot 1 + L_{[3]} \cdot 0 +\ldots + L_{[15]} \cdot 0 \\
\mu_{[i]} = \mathrm{Intercept} + L_{[2]}  \\
\end{split}
\tag{4.2}
\end{equation}
\]</span></p>
<p>This is actually how regression models represent these sorts of predictors ‘under the hood’. However, if every single factor level were to get an independent parameter represented in the regression equations in this book, these would become very long and difficult to interpret. For example, we have 139 different speakers in our data, meaning our prediction equation would be extremely long if we included each of these predictors as separate terms. Instead, we can treat the effects associated with the levels of a factor as a vector, and just pick the correct element of this vector for each observation in our data. In order to know which listener contributed each observation, we also need an index variable, a variable that equals a number from one to 15 that indicates which listener parameter to use on that trial. This is the <code>L</code> column in our data (<code>exp_data</code>), the listener predictor.</p>
<p>For example, below we see that our listener predictor has a value of 1 for observation 1 and a value of 8 for observation 1000. This tells us that the first listener provided the first observation and the 8th listener provided the 1000th observation. It tells our model to use <span class="math inline">\(L_{[1]}\)</span> for observation 1 and <span class="math inline">\(L_{[8]}\)</span> for observation 1000. In general, we should use <span class="math inline">\(L_{[j]}\)</span> for observation <span class="math inline">\(i\)</span> when the listener prediction is equal to <span class="math inline">\(j\)</span> for that observation (i.e., <code>exp_data$L[i]=j</code>).</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb87-1" aria-hidden="true" tabindex="-1"></a>exp_data<span class="sc">$</span>L[<span class="dv">1</span>]</span>
<span id="cb87-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb87-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb87-3" aria-hidden="true" tabindex="-1"></a>exp_data<span class="sc">$</span>L[<span class="dv">1000</span>]</span>
<span id="cb87-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 8</span></span></code></pre></div>
<p>Unfortunately, this leads to some notational strangeness. R names the vector of coefficients in your model using the same name as your predictor. So, the vector of listener effects in your model won’t have an interpretable name like <code>listener_effects</code>. Instead, we have a predictor called <code>L</code> which represents listeners, <em>and</em>, we have a set of coefficients called <span class="math inline">\(L\)</span> in our model that represent the effects for each of our listeners. As a result, our regression equations will include terms that look like this, <span class="math inline">\(L_{[\mathsf{L}_{[i]}]}\)</span>, which means: “Coefficient <span class="math inline">\(L\)</span>, and the level is the one indicated by value of the <code>L</code> predictor (<span class="math inline">\(\mathsf{L}\)</span>) for trial <span class="math inline">\(i\)</span>”. This term is now included in our prediction equation in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-3">(4.3)</a>, which says: The expected value for any given trial is equal to the intercept, plus the listener effect (<span class="math inline">\(L\)</span>) specific to the listener that contributed that trial as indicated by the <code>L</code> vector (<span class="math inline">\(\mathsf{L}\)</span> in our model).</p>
<p><span class="math display" id="eq:4-3">\[
\begin{equation}
\begin{split}
\mu_{[i]} = \mathrm{Intercept} + L_{[\mathsf{L}_{[i]}]}
\end{split}
\tag{4.3}
\end{equation}
\]</span></p>
<p>We think the <span class="math inline">\(L_{[\mathsf{L}_{[i]}]}\)</span> notation is potentially confusing, and not ideal. However, the only way we can have formal model descriptions that actually match the name of our model coefficients <em>and</em> the names of the predictors they are associated with is by giving these the same names. One thing we’ll do to try to make things clearer is use different font for the predictors (<span class="math inline">\(\mathsf{L}\)</span>) and the corresponding coefficients (<span class="math inline">\(L\)</span>). So, when you see terms like these <span class="math inline">\(L_{[\mathsf{L}_{[i]}]}\)</span> in your models, this is nothing more than a compact way of representing the same model structure shown in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-2">(4.2)</a>.</p>
<p>For example, if your data contains a predictor called <code>L</code> <span class="math inline">\((\mathsf{L})\)</span> whose first three values are 2, 4, and 1, then we need parameters <span class="math inline">\(L_{[2]}\)</span>, <span class="math inline">\(L_{[4]}\)</span>, and <span class="math inline">\(L_{[1]}\)</span> for the first three trials. We can get the correct listener effect for each trial using the information in our listener predictor. We can see how this would work in the example in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-3a">(4.4)</a>, showing the combination of intercepts and listener effects for the first three observations in our hypothetical example. In each case, we find the value of the predictor <span class="math inline">\(\mathsf{L}\)</span> for observation <span class="math inline">\(i\)</span> and use this to fetch the correct listener effect (<span class="math inline">\(L\)</span>) for our regression equation for that observation.</p>
<p><span class="math display" id="eq:4-3a">\[
\begin{equation}
\begin{split}
\mathsf{L}_{[1]} = 2, \mathsf{L}_{[2]}=4,\mathsf{L}_{[3]}=1,  \dots \\ \\
\mu_{[i=1]} = \mathrm{Intercept} + L_{[\mathsf{L}_{[i=1]}]} = \mathrm{Intercept} + L_{[2]} \\
\mu_{[i=2]} = \mathrm{Intercept} + L_{[\mathsf{L}_{[i=2]}]} = \mathrm{Intercept} + L_{[4]} \\
\mu_{[i=3]} = \mathrm{Intercept} + L_{[\mathsf{L}_{[i=3]}]} = \mathrm{Intercept} + L_{[1]} \\
\dots
\end{split}
\tag{4.4}
\end{equation}
\]</span></p>
<p>The example above says: We add the intercept to the effect for listener 2 to get our expected value for observation 1 (i.e. observation 1 was contributed by listener 2), we add the intercept to the effect for listener 4 to get our expected value for observation 2 (i.e. observation 2 was contributed by listener 4), and so on, for all observations in our data.</p>
</div>
<div id="c4-strategies" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Strategies for estimating factors with many levels<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We know that the 15 values of <span class="math inline">\(L\)</span> are related by being different listeners in our experiment. The way you tell your model that these coefficients are related is by treating them as levels of the same factor rather than as unrelated coefficients. One way to think of factors is that they represent ‘batches’ of coefficients in your model that are thematically or conceptually related (more on this in chapter 11). Once you encode the fact that there are ‘batches’ of parameters in your model, you have several options with respect to how these batches are estimated.</p>
<p>Gelman and colleagues (Gelman and Hill 2006; Gelman et al. 2013) distinguish three general ways that parameters related to levels of a factor can be estimated: 1) <em>Complete pooling</em>, 2) <em>No pooling</em>, and 3) <em>Partial pooling</em>. The distinction between complete, no, and partial pooling is made for each factor in a model. So, one factor may be estimated using partial pooling while another may be estimated using no pooling. This makes understanding the distinction between these approaches very important.</p>
<div id="c4-complete-pooling" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Complete pooling<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-complete-pooling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Last chapter we carried out a <strong>complete pooling</strong> analysis of our data, presented in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-1">(4.1)</a>. That is, we threw everything into one big pile and analyzed it as if it came from one undifferentiated group (as in the unilevel model in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-2">4.2</a>). There are several problems with this approach when applied to our experimental data. First, the complete pooling approach does not allow us to make any statements about variation between listeners since it does not estimate values of <span class="math inline">\(L\)</span>. In fact, this model assumes that <span class="math inline">\(\sigma_L\)</span> is equal to zero (or does not exist). As noted earlier, if listeners do not differ from each other in any way, then <span class="math inline">\(\sigma_L\)</span> will be equal to zero and the two models in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-2">4.2</a> will converge on each other. However, if <span class="math inline">\(\sigma_L\)</span> is <em>not</em> zero, then this approach will miss out on important information.</p>
<p>There is perhaps a more serious problem with the complete pooling approach for repeated measures data. The complete pooling model assumes that all deviations from the mean are due to random error. Recall that regression models assume that all random variation around expected values (i.e. the residuals) are independent. Since independence is assumed, likelihoods are calculated the ‘easy’ way by multiplying individual marginal probabilities (see sections <a href="probabilities-likelihood-and-inference.html#c2-joint">2.3.2</a> and <a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods">2.7.1</a>). However, as we can see in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-1">4.1</a>, each listener had a slightly different average judged height. This means that the residuals associated with each individual listener are not independent and may be related. For example, we expect almost all of listener 12’s residuals to be positive (i.e. larger than average) since nearly all of this listener’s responses were above the overall average <span class="math inline">\(\mu\)</span>. The violation of the assumption of independent residuals means that if we’re using a complete-pooling approach for our repeated measures data we are calculating likelihoods the ‘wrong’ way. Basically, our data has 675 rows but not 675 totally-independent observations, but our model doesn’t know this. As a result, the information provided by our model may not be reliable.</p>
<p>We’ve previously mentioned that our models are not exactly ‘right’ or ‘true’, so why does it matter all of the sudden that the complete pooling model is ‘wrong’? Recall that in section <a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods">2.7.1</a> we mentioned that the likelihood function gets narrower as a function of the sample size n. This applies only to n <em>independent</em> observations, but not necessarily to <em>dependent</em> observations. As a result, when we treat dependent observations as independent our likelihood may end up being narrower than is warranted. This gives us a false sense of security about how precise our parameter estimates are. Basically, spherical models of billiards balls are wrong but useful, while cubic models of the balls are wrong and less useful. Treating residuals both within and across listeners as independent is kind of like using a cubic model of a billiard ball.</p>
</div>
<div id="c4-no-pooling" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> No pooling<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-no-pooling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To account for systematic variation between listeners in the data we can include listener predictors (<span class="math inline">\(L\)</span>) in our model, as in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-4">(4.5)</a>. When we estimate the levels of this factor with <strong>no pooling</strong>, we estimate every level of the factor totally independently. One way to model this mathematically is to think of these coefficients as coming from a uniform distribution that extends from negative to positive infinity. The uniform distribution is just a flat line, meaning any value in the interval is equally likely. So, a uniform distribution extending from positive to negative infinity places absolutely no restrictions on the possible values of a parameter and says absolutely any value is equally likely. This is equivalent to setting <span class="math inline">\(\sigma_L=\infty\)</span>. As a result, we can see complete and no pooling as two extremes, in one case we assume there is no between-listener variation at all and in the other we assume that between-listener variation can potentially be infinitely large.</p>
<p>In <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-4">(4.5)</a> we see that in our no pooling model, the expected value (<span class="math inline">\(\mu\)</span>) for each trial is the sum of our intercept and the listener predictor, and that each of the <span class="math inline">\(L\)</span> terms is drawn from the same uniform distribution. We introduce the notation <span class="math inline">\([\bullet]\)</span> to represent every individual level of a factor. Below, we note that each of the 15 listener effects (<span class="math inline">\(L_{[\bullet]}\)</span>) were individually drawn from the same uniform distribution.</p>
<p><span class="math display" id="eq:4-4">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{N}(\mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{Intercept} + L_{[\mathsf{L}_{[i]}]}  \\
\\
\textrm{Priors:} \\
L_{[\bullet]} \sim \mathrm{uniform}(-\infty, \infty) \\\\
\mathrm{Intercept} \sim \mathrm{N}(176, 15) \\
\end{split}
\tag{4.5}
\end{equation}
\]</span></p>
<p>There are two main weaknesses to this approach. First, assuming that <span class="math inline">\(\sigma_L=\infty\)</span> does not allow <strong>regularization</strong> (also known as <em>shrinkage</em>, see section <a href="fitting-bayesian-regression-models-with-brms.html#c3-characteristics-posteriors">3.3.3</a>) to occur across the levels of the factor. Shrinkage occurs when an estimate is pulled towards its prior mean. However, a perfectly uniform prior does not exert any influence on posterior distributions, so that these are completely reflective of the likelihood function. In the absence of shrinkage, the characteristics of each listener are estimated as if only a single listener had taken part in our experiment. But we don’t have one listener, we have 15, and they all performed the experiment in quite similar ways. Clearly, it may be useful if our model could consider what it knows about the values of <span class="math inline">\(L\)</span> in general when it estimates the value of <span class="math inline">\(L_{[j]}\)</span> for any given listener <span class="math inline">\(j\)</span>.</p>
<p>A second weakness of a no pooling approach is that these models do not represent information about the range of credible values for the levels of a factor. For example, below we see some quantiles for the average apparent height reported for adult male speakers by the listeners in our experiment:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb88-1" aria-hidden="true" tabindex="-1"></a>listener_means <span class="ot">=</span> <span class="fu">tapply</span> (men<span class="sc">$</span>height, men<span class="sc">$</span>L, mean)</span>
<span id="cb88-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(listener_means)</span>
<span id="cb88-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    0%   25%   50%   75%  100% </span></span>
<span id="cb88-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 167.8 170.5 174.1 175.9 180.9</span></span></code></pre></div>
<p>These listeners each carried out this experiment independently and did not know each other. Despite this, we see below that half of listeners’ average height judgments are between 171 and 176 cm, and that all listener averages fell between 168 and 181 cm. The consistency of these judgments suggest a common behavior between listeners, and an underlying similarity in listener characteristics and parameters. Given this, it might be surprising if a new listener carried out the experiment and provided an average height judgment of 130 cm for adult males. Although our model does include information about individual listeners, it cannot represent information about more or less likely values for listener effects.</p>
</div>
<div id="c4-partial-pooling" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> (Adaptive) Partial pooling<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-partial-pooling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Complete pooling and no pooling offer extremes: We either assume <span class="math inline">\(\sigma_L\)</span> is zero or we assume it is infinite. Partial pooling offers a sort of middle ground between complete pooling and no pooling, a potential ‘just right’ compromise solution. <strong>Partial pooling</strong> estimates the values of <span class="math inline">\(L\)</span> using non-zero values of <span class="math inline">\(\sigma_L\)</span>, meaning that the parameters representing the levels of a factor are neither completely independent nor totally merged. This allows the parameter estimates to share information, and often results in the parameters being more similar to each other compared to when they are fit using no pooling.</p>
<p>Technically speaking, we can fit a model with partial pooling by specifying any finite prior probability for our parameters. So, simply drawing the <span class="math inline">\(L\)</span> parameters from any given shared distribution (e.g. <span class="math inline">\(L_{[\bullet]} \sim \mathrm{N}(0,30)\)</span>) would constitute a partial pooling estimate of the parameters. However, we know that our prior probability can help to pull parameters towards the prior mean (as discussed in section <a href="fitting-bayesian-regression-models-with-brms.html#c3-posterior">3.3.2</a>), resulting in <em>shrinkage</em>. In order for this to work effectively, the variance of the prior needs to be set at a reasonable value given the amount of variation in the data. Below, we see that the standard deviation of listener means is 3.6 cm. It would be nice to be able to use a value close to this, since we know this to be a good fit to our data. Unfortunately, if we did this it would not really be a <em>prior</em> probability anymore, since we would be analyzing the data, finding the most likely parameter values, and then using that to set what is supposed to be the <em>prior</em> probability.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(listener_means)</span>
<span id="cb89-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3.594</span></span></code></pre></div>
<p>Instead of doing this, we can estimate <span class="math inline">\(\sigma_L\)</span> using our data. This allows us to have a prior distribution for our parameters that is tailored to the data, without us having to actually specify it a priori. When standard deviation parameters like <span class="math inline">\(\sigma_L\)</span> are estimated from the data rather than specified a priori, this is called <strong>adaptive partial pooling</strong>. Often, the ‘adaptive’ part is dropped and authors may describe the method as partial pooling when they mean specifically <em>adaptive</em> partial pooling. So, when you read that a factor was estimated using ‘partial pooling’, most often that means that the standard deviation parameter corresponding to that factor (e.g. <span class="math inline">\(\sigma_L\)</span> for <span class="math inline">\(L\)</span>) was estimated from the data. We will refer to it as <em>adaptive pooling</em>, tending to drop the ‘partial’, in order to clearly communicate when we refer to parameters whose variance parameters (e.g. <span class="math inline">\(\sigma_L\)</span>) are estimated from the data.</p>
<p>The adaptive (partial) pooling version of our model is presented in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-5">(4.6)</a>. There are two important differences with respect to the model in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-4">(4.5)</a>. First, the <span class="math inline">\(L_{[\bullet]}\)</span> terms are drawn from a normal distribution with a mean of zero and a standard deviation equal to <span class="math inline">\(\sigma_L\)</span>. The reason the mean of the distribution is equal to zero is that our listener coefficients only encode deviations relative to the intercept, and not the listener average. So, a listener that is perfectly average will have a coefficient equal to 0. Second, since the <span class="math inline">\(\sigma_L\)</span> term is estimated from the data a prior distribution for <span class="math inline">\(\sigma_L\)</span> is specified. This is because prior probabilities must be specified for all estimated parameters in our model, and <span class="math inline">\(\sigma_L\)</span> is now being estimated.</p>
<p><span class="math display" id="eq:4-5">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{N}(\mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{Intercept} + L_{[\mathsf{L}_{[i]}]} \\
\\
\mathrm{Priors:} \\
L_{[\bullet]} \sim \mathrm{N}(0,\sigma_L) \\
\\
\mathrm{Intercept} \sim \mathrm{N}(176,15) \\
\sigma \sim \mathrm{N}(0,15) \\
\sigma_L \sim \mathrm{N}(0,15)
\end{split}
\tag{4.6}
\end{equation}
\]</span></p>
<p>This approach is called adaptive partial pooling because the estimate of each level of <span class="math inline">\(L\)</span> is <em>partially</em> influenced by every other level of <span class="math inline">\(L\)</span> by virtue of being drawn from the same distribution <span class="math inline">\(\mathrm{N}(0,\sigma_L)\)</span>. For example, we saw that half of listener mean height judgments were between 170 and 176 cm, and our model will now take that into account when estimating the individual coefficients that make up <span class="math inline">\(L\)</span>. So, unlike the complete pooling case we do not ignore variation between listeners, and unlike in the no pooling case we do not ignore the similarities between them. In addition, the amount of blending that occurs across levels is determined by the data, and so the method is ‘adaptive’ to the specific situation.</p>
</div>
<div id="hyperpriors" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Hyperpriors<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#hyperpriors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may have noticed that in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-5">(4.6)</a> we assign a prior distribution to <span class="math inline">\(\sigma_L\)</span>. However, <span class="math inline">\(\sigma_L\)</span> is a parameter in the prior distribution of our listener parameters <span class="math inline">\(L_{[\bullet]}\)</span>. So actually, the prior for <span class="math inline">\(\sigma_L\)</span> is the prior of a prior. We might call this a ‘grand prior’ (like grandparent) but the actual term for it is <strong>hyperprior</strong>. One way to think of it is that in a multilevel model, each level effectively acts as the prior for the level below it. This leads to a nested or hierarchical model structure (sometimes multilevel models are called <strong>hierarchical models</strong> for this reason).</p>
<p>We’re going to update the equation defining our posterior distributions (originally presented in <a href="fitting-bayesian-regression-models-with-brms.html#eq:3-12">(3.12)</a>) to take into account the structure of our partial pooling models. Our model will now reflect not only our prior beliefs but also the information encoded in our hyperpriors, and it will estimate the distribution of <span class="math inline">\(\sigma_L\)</span> from the data. We can begin with the posterior probability of observing a given value of <span class="math inline">\(L_{[\bullet]}\)</span> for a single listener in isolation. Equation <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-6">(4.7)</a> says that the posterior probability of some listener effect (<span class="math inline">\(L_{[\bullet]}\)</span>) given the data <span class="math inline">\(y\)</span> is equal to the product of the likelihood of <span class="math inline">\(L_{[\bullet]}\)</span> given the data (<span class="math inline">\(P(y|L_{[\bullet]})\)</span>) and the prior of <span class="math inline">\(L_{[\bullet]}\)</span> (<span class="math inline">\(P(L_{[\bullet]})\)</span>), divided by the marginal probability of the data (<span class="math inline">\(P(y)\)</span>).</p>
<p><span class="math display" id="eq:4-6">\[
\begin{equation}
\begin{split}
P(L_{[\bullet]}|y) = \frac{P(y|L_{[\bullet]}) \cdot P(L_{[\bullet]})}{P(y)}
\tag{4.7}
\end{split}
\end{equation}
\]</span></p>
<p>If we want to consider the posterior probability of <span class="math inline">\(\sigma_L\)</span> given the data, we can add <span class="math inline">\(\sigma_L\)</span> to every term that previously included <span class="math inline">\(L_{[\bullet]}\)</span> in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-6">(4.7)</a>. Basically, we’re saying <span class="math inline">\(\sigma_L\)</span> <em>and</em> <span class="math inline">\(L_{[\bullet]}\)</span>, instead of just <span class="math inline">\(L_{[\bullet]}\)</span>. Equation <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-7">(4.8)</a> can be read aloud as “the posterior probability of observing a certain listener effect <em>and</em> a certain amount of between-listener variation given some data (<span class="math inline">\(P(L_{[\bullet]},\sigma_L|y)\)</span>) is equal to the likelihood of the data given the listener effect and the amount of variation between listeners (<span class="math inline">\(P(y|L_{[\bullet]} , \sigma_L)\)</span>), times the joint prior probability of the listener effect and the amount of variation between listeners (<span class="math inline">\(P(L_{[\bullet]},\sigma_L)\)</span>), divided by the marginal probability of the data (<span class="math inline">\(P(y)\)</span>)”.</p>
<p><span class="math display" id="eq:4-7">\[
\begin{equation}
\begin{split}
P(L_{[\bullet]},\sigma_L|y) = \frac{P(y|L_{[\bullet]} , \sigma_L) \cdot P(L_{[\bullet]},\sigma_L)}{P(y)}
\tag{4.8}
\end{split}
\end{equation}
\]</span></p>
<p>We know that we can represent the joint probability of a listener effect and the listener standard deviation, <span class="math inline">\(P(L_{[\bullet]},\sigma_L)\)</span>, using normalized conditional probabilities as in <span class="math inline">\(P(L_{[\bullet]}|\sigma_L) \cdot P(\sigma_L)\)</span> (see chapter 2). We can also remove the listener standard deviation (<span class="math inline">\(\sigma_L\)</span>) from the likelihood of <span class="math inline">\(L_{[\bullet]}\)</span> given the data (<span class="math inline">\(P(y|L_{[\bullet]})\)</span>), because we know that the probability of any given data point in a normal distribution depends only on the mean of the distribution and not the standard deviation of means <em>between</em> distributions (i.e. <span class="math inline">\(\sigma_L\)</span>). These two changes are reflected in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-8">(4.9)</a>. The first term in the numerator on the right hand side is the likelihood, this was in our original equation in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-6">(4.7)</a>. The second term is the prior distribution of listener effects. This also appeared in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-6">(4.7)</a>, however, this distribution now allows for variation in the value of <span class="math inline">\(\sigma_L\)</span>. Finally, the third term (<span class="math inline">\(P(\sigma_L)\)</span>) represents the hyperprior, the prior distribution of one of the parameters of another prior distribution.</p>
<p><span class="math display" id="eq:4-8">\[
\begin{equation}
\begin{split}
P(L_{[\bullet]},\sigma_L|y) = \frac{P(y|L_{[\bullet]})  \cdot P(L_{[\bullet]}|\sigma_L)  \cdot P(\sigma_L)}{P(y)}
\tag{4.9}
\end{split}
\end{equation}
\]</span></p>
<p>Our posterior estimates of <span class="math inline">\(L_{[\bullet]}\)</span> may differ from our no pooling estimates of the listener effects. This is because in addition to the individual parameter likelihoods, the posterior probability of <span class="math inline">\(L_{[\bullet]}\)</span> in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-8">(4.9)</a> takes into account the estimates of <span class="math inline">\(\sigma_L\)</span>. When our posterior estimates of the listener (or any other) effects are more similar to the population average, and to each other, than the no pooling estimates, <em>regularization</em> has occurred. Importantly, the amount of pooling/shrinkage that will occur will be determined by <span class="math inline">\(\sigma_L\)</span>, which is estimated from the data itself.</p>
</div>
</div>
<div id="c4-estimating1" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Estimating a multilevel model with <code>brms</code><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-estimating1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’re going to fit a model to the same data we investigated in Chapter 3, however, we’re going to use a multilevel model that reflects the repeated measures nature of the data.</p>
<div id="c4-data-and-qs-1" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Data and Research questions<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-data-and-qs-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below we load and subset our full data to only include those trials involving adult male speakers, and only when the actual resonance size was presented. This is the same data we considered in chapters 2 and 3.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load book package and brms</span></span>
<span id="cb90-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (bmmb)</span>
<span id="cb90-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (brms)</span>
<span id="cb90-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load and subset experimental data</span></span>
<span id="cb90-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span> (exp_data)</span>
<span id="cb90-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb90-7" aria-hidden="true" tabindex="-1"></a>men <span class="ot">=</span> exp_data[exp_data<span class="sc">$</span>C_v<span class="sc">==</span><span class="st">&#39;m&#39;</span>,]</span></code></pre></div>
<p>Once again, we’re going to try to address the following basic research questions:</p>
<p>(Q1) How tall does the average adult male sound?</p>
<p>(Q2) Can we set limits on credible average apparent heights based on the data we collected?</p>
<p>To analyze our data using <code>brms</code> in R we need it to be in a data frame with each row containing a different observation. We need one column representing our dependent variable (the variable we want to analyze) and one column that indicates the ‘source’ of the data. The relevant columns in our data are:</p>
<ul>
<li><code>L</code>: An integer from 1-15 indicating which <em>listener</em> responded to the trial.</li>
<li><code>height</code>: A floating-point number representing the <em>height</em> (in centimeters) reported for the speaker on each trial.</li>
</ul>
<p>We can see that our data satisfies these conditions below, where the relevant columns (for this model) are <code>L</code> for listeners, and <code>height</code> for our dependent variable.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (men)</span>
<span id="cb91-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     L C height R  S C_v  vtl  f0 dur G A G_v A_v</span></span>
<span id="cb91-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 93  1 m  169.9 a 47   m 14.8 172 339 m a   m   a</span></span>
<span id="cb91-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 95  1 m  173.5 a 48   m 15.6 108 236 m a   m   a</span></span>
<span id="cb91-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 97  1 m  172.0 a 49   m 15.5  96 315 m a   m   a</span></span>
<span id="cb91-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 99  1 b  157.7 a 50   m 14.5 134 240 m c   m   a</span></span>
<span id="cb91-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 101 1 m  153.4 a 51   m 15.0 122 241 m a   m   a</span></span>
<span id="cb91-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 103 1 m  174.2 a 52   m 14.8 101 259 m a   m   a</span></span></code></pre></div>
<p>Often, experiments (or data more generally) will feature a single factor that indicated the ‘source’ of information. However, in this experiment we have both speakers producing our data and listeners providing judgments about our data. This leads to non-independent observations based on both speaker <em>and</em> listener. For example, a speaker who sounded tall to one person may have sounded tall to other listeners, and listeners who identified all speakers as generally tall/short would have done so in a similar way across all speakers. We’ll begin by building a model that only incorporates information about listeners before discussing a model that includes information regarding both speakers and listeners later in the chapter.</p>
</div>
<div id="description-of-the-model" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Description of the model<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#description-of-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To specify a multilevel model, you need to write a slightly more complicated model formula. This explanation assumes that you have a data frame where one column contains the variable you are interested in predicting (in this case <code>height</code>), and another column contains a vector containing unique labels for each grouping factor (e.g., speaker, listener, participant) in this case a unique listener label <code>L</code>. Before, the model formula looked like this:</p>
<p><code>height ~ 1</code></p>
<p>Which meant ‘predict height using only an overall intercept’. To indicate that your model contains an ‘upper’ level where you have repeated measures clusters of data coming from different sources, you have to put another model formula <em>inside</em> your main model formula. The formula corresponding to the model shown in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-5">(4.6)</a> looks like this:</p>
<p><code>height ~ 1 + ( 1 | L)</code></p>
<p>Which means ‘predict height using an overall intercept and separate intercepts for each level of the L (listener) factor’. In mathematical notation, this symbol <code>|</code> (called ‘pipe’) means “given that” or “conditional on”. It can effectively be interpreted in the same way in our models: “estimate an intercept <em>given</em> each level of the <code>L</code> predictor”. So, when you place a predictor in parenthesis on the right-hand-side of a pipe <code>|</code>, like this <code>( | predictor )</code>, you tell <code>brm</code> that you would like to estimate separate parameters for each level of the factor. Whatever you put in the left-hand-side of the parentheses <code>( in here | predictor )</code> specifies the parameters you wish to estimate for each level of the factor. In addition, any parameters specified on the left-hand side of the pipes in parentheses, <code>( in here | predictor )</code>, will be estimated using adaptive partial pooling. By convention, effects estimated using adaptive pooling are modeled as coming from a normal distribution with a mean of zero, so that aspect of the model does not need to be directly specified.</p>
<p>So, the model formula <code>height ~ 1 + ( 1 | L)</code> tells <code>brms</code> to build an intercept only model with a separate intercept for each listener, and that the listener intercept terms should be estimated with adaptive pooling. This model formula specifies a subset of the information provided in our full model specification shown in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-9">(4.10)</a> (originally <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-5">(4.6)</a>).</p>
<p><span class="math display" id="eq:4-9">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{N}(\mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{Intercept} + L_{[\mathsf{L}_{[i]}]} \\
\\
\mathrm{Priors:} \\
L_{[\bullet]} \sim \mathrm{N}(0,\sigma_L) \\
\\
\mathrm{Intercept} \sim \mathrm{N}(176,15) \\
\sigma \sim \mathrm{N}(0,15) \\
\sigma_L \sim \mathrm{N}(0,15)
\end{split}
\tag{4.10}
\end{equation}
\]</span></p>
<p>As a reminder, we use the notation <span class="math inline">\(L_{[\bullet]}\)</span> to indicate that this prior distribution applies individually to every member of the set. In our case, each of our 15 listener effects is drawn from the same normal distribution, one at a time (i.e. <span class="math inline">\(L_{[1]} \sim \mathrm{N}(0,\sigma_L), \dots , L_{[15]} \sim \mathrm{N}(0,\sigma_L)\)</span>). In plain English, the model above says:</p>
<blockquote>
<p>We expect height judgments to be normally distributed around the expected value for any given trial, <span class="math inline">\(\mu_{[i]}\)</span>, with some unknown standard deviation <span class="math inline">\(\sigma\)</span>. The expected value for a trial is equal to a fixed overall average (Intercept) and some value associated with the individual listener who made a perceptual judgment on the trial (<span class="math inline">\(L_{[\mathsf{L}_{[i]}]}\)</span>). The listener coefficients (<span class="math inline">\(L_{[\bullet]}\)</span>) were modeled as coming from a normal distribution with a mean of zero and a standard deviation (<span class="math inline">\(\sigma_L\)</span>) that was estimated from the data.</p>
</blockquote>
<p>There is a very important difference in how the ‘unilevel’ (complete pooling) model from Chapter 3, and this model partition the variance in apparent talker heights. The initial complete pooling model broke down the total variation in the data (<span class="math inline">\(\sigma_{total}\)</span>) like this:</p>
<p><span class="math display" id="eq:4-10">\[
\begin{equation}
\sigma^2_{total} = \sigma^2
\tag{4.11}
\end{equation}
\]</span></p>
<p>In other words, all variation was error. We don’t know why values vary from the mean, so all variation is just random noise. Our multilevel model views the variation in our data like this:</p>
<p><span class="math display" id="eq:4-11">\[
\begin{equation}
\sigma^2_{total} = \sigma^2_{L} + \sigma^2
\tag{4.12}
\end{equation}
\]</span></p>
<p>The total variance is equal to the within listener variance (<span class="math inline">\(\sigma^2\)</span>) plus the between-listener variance (<span class="math inline">\(\sigma_L^2\)</span>). From the perspective of this model, the variation <em>within</em> a speaker’s individual boxplot is (data-level) error. The differences from listener to listener represent random between-listener variation in apparent height judgments (i.e., listener-level error). To some extent, investigating the <em>effects</em> for the different listeners in our sample involves asking how much the listener averages tended to differ from the overall response. So, a crucial part of investigating the overall effect of different listeners on our results is understanding the magnitude of <span class="math inline">\(\sigma_L\)</span>.</p>
</div>
<div id="c4-fitting-1" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Fitting the model<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-fitting-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use <code>brms</code> to fit a model that more closely resembles our model specification in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-9">(4.10)</a>. To do this we need to use the formula given above, and we also need to specify priors for three estimated parameters: <span class="math inline">\(\mathrm{Intercept}\)</span>, <span class="math inline">\(\sigma_L\)</span>, and <span class="math inline">\(\sigma\)</span>. We can confirm our expectations using the <code>get_prior</code> function as seen below. This time we use a clone of the function in the <code>bmmb</code> package simply because the output of the ‘real’ function sometimes doesn’t like it when you omit columns from the output (which we need to so that it will fit on the page).</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb92-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">get_prior</span> (height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>L), <span class="at">data =</span> men)[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)]</span>
<span id="cb92-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                     prior     class      coef group resp dpar  source</span></span>
<span id="cb92-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  student_t(3, 174.5, 7.1) Intercept                           default</span></span>
<span id="cb92-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3, 0, 7.1)        sd                           default</span></span>
<span id="cb92-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3, 0, 7.1)        sd               L           default</span></span>
<span id="cb92-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3, 0, 7.1)        sd Intercept     L           default</span></span>
<span id="cb92-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3, 0, 7.1)     sigma                           default</span></span></code></pre></div>
<p>We see a new <code>class</code> of prior, <code>sd</code>. Our classes of priors are now:</p>
<ul>
<li><code>Intercept</code>: This is a unique class, only for intercepts.</li>
<li><code>sd</code>: This is for standard deviation parameters related to ‘batches’ of parameters, e.g. <code>sd(Intercept)</code> for <code>L</code> (<span class="math inline">\(\sigma_{L}\)</span>).</li>
<li><code>sigma</code>: The data-level error term.</li>
</ul>
<p>The information presented by <code>get_prior</code> does not just list the priors that must be specified, but also different ways that priors can be set, so there are some redundancies. This is not so necessary for our very simple models now but it will become very useful later so it is worth understanding now while it’s still relatively simple. Top to bottom, here is the information presented in the output above. First, you can specify a prior for the <code>Intercept</code>, which is its own unique class. Second, you can specify a prior for <em>all</em> <code>sd</code> parameters in your model. Third, you can specify a prior for all the <code>sd</code> parameters, specifically for your <code>L</code> group. The fourth line indicates that you can also specify a prior <em>only</em> for the <code>Intercept</code> for your <code>L</code> group (i.e. <span class="math inline">\(L\)</span>) and not to any other listener-related predictors in your model (there are none for now). The fifth line lets you specify the prior for the error in the model (i.e. <span class="math inline">\(\sigma\)</span>). Right now, we only have one <code>sd</code> parameter and so all this flexibility is not so useful, but later on we might want to specify different priors for different <code>sd</code> parameters and so this will come in handy.</p>
<p>Below we fit a model and specify prior distributions for our intercept, for <em>all</em> variables in the <code>sd</code> class, and for the error term (basically the first, second, and fifth lines above).</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb93-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb93-2" aria-hidden="true" tabindex="-1"></a>model_multilevel <span class="ot">=</span>  brms<span class="sc">::</span><span class="fu">brm</span> (</span>
<span id="cb93-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>L), <span class="at">data =</span> men, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb93-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>,</span>
<span id="cb93-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(176, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb93-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb93-6" aria-hidden="true" tabindex="-1"></a>            brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb93-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb93-7" aria-hidden="true" tabindex="-1"></a>            brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb94-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb94-2" aria-hidden="true" tabindex="-1"></a>model_multilevel <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;4_model_multilevel.RDS&#39;</span>)</span></code></pre></div>
</div>
<div id="interpreting-the-model" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Interpreting the model<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#interpreting-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can inspect the model print statement:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb95-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-2" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">short_summary</span> (model_multilevel)</span>
<span id="cb95-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula:  height ~ 1 + (1 | L)</span></span>
<span id="cb95-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb95-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects:</span></span>
<span id="cb95-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ~L (Number of levels: 15)</span></span>
<span id="cb95-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb95-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)     3.78      0.87     2.47     5.84</span></span>
<span id="cb95-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb95-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects:</span></span>
<span id="cb95-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb95-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept    173.8      1.02    171.8    175.8</span></span>
<span id="cb95-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb95-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters:</span></span>
<span id="cb95-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb95-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma     7.03      0.19     6.67     7.41</span></span></code></pre></div>
<p>This model contains one new chunk in its print statement, the <code>Group-Level Effects</code>, which tells us the standard deviation of the listener-dependent intercepts (<code>sd(Intercept)</code>) in the sample, <span class="math inline">\(\sigma_L\)</span>. Below, we calculate the listener mean height values, the standard deviation of these, and the amount of within-listener variation in apparent height judgments. We can see that these resemble the value of the analogous parameters in our model.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find mean height for each listener</span></span>
<span id="cb96-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-2" aria-hidden="true" tabindex="-1"></a>listener_means <span class="ot">=</span> <span class="fu">aggregate</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">FUN =</span> mean) </span>
<span id="cb96-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># find the within listener standard deviation </span></span>
<span id="cb96-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the within-talker &#39;error&#39;.</span></span>
<span id="cb96-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-6" aria-hidden="true" tabindex="-1"></a>listener_sigmas <span class="ot">=</span> <span class="fu">aggregate</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">FUN =</span> sd) </span>
<span id="cb96-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the mean of the listener means corresponds to our Intercept</span></span>
<span id="cb96-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span> (listener_means<span class="sc">$</span>height)</span>
<span id="cb96-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 173.8</span></span>
<span id="cb96-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co"># the standard deviation of the listener means corresponds </span></span>
<span id="cb96-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co"># to &#39;sd(Intercept)&#39;, the estimate of the standard deviation </span></span>
<span id="cb96-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co"># of listener intercepts</span></span>
<span id="cb96-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span> (listener_means<span class="sc">$</span>height)</span>
<span id="cb96-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3.594</span></span>
<span id="cb96-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co"># the average within-listener standard deviation corresponds to &#39;sigma&#39;, </span></span>
<span id="cb96-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="co"># the estimated error</span></span>
<span id="cb96-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span> (listener_sigmas<span class="sc">$</span>height)</span>
<span id="cb96-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb96-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 6.822</span></span></code></pre></div>
<p>We’re going to discuss the calculations we made above in terms of what they represent in the boxplot in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-3">4.3</a>, our model coefficients in the print statement above, and in our model definition in <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#eq:4-9">(4.10)</a>.</p>
<div class="figure"><span style="display:block;" id="fig:F4-3"></span>
<img src="_main_files/figure-html/F4-3-1.jpeg" alt="Listener-specific boxplots for apparent height judgments made for adult male speakers. The horizontal line represents the model intercept." width="4800" />
<p class="caption">
Figure 4.3: Listener-specific boxplots for apparent height judgments made for adult male speakers. The horizontal line represents the model intercept.
</p>
</div>
<p>The overall mean height in our data (173.8) corresponds quite well to our model intercept of 173.8, seen in the horizontal line in the figure. The standard deviation of the listener means is 3.6 cm. This is very similar to our model estimate of 3.8 cm (<code>sd(Intercept)</code>). The standard deviation of the listener effects reflects the average distance from each speaker’s average to the overall average, and reflects <span class="math inline">\(\sigma_L\)</span> in our model. Finally, the average of the within-speaker standard deviations in our data (6.8 cm) corresponds closely to our model’s error estimate (<code>sigma</code> = 7.0), represented by <span class="math inline">\(\sigma\)</span> in our model. This reflects the average spread of each speaker’s data relative to their own mean, within their own little box in the figure. We can see that the information provided by <code>brms</code> is quite similar to what we can estimate directly using our data. However, <em>brms</em> does this all for us, in addition to giving us information regarding credible intervals for different parameters.</p>
</div>
</div>
<div id="c4-random-effects" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> ‘Random’ Effects<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you have some familiarity with statistical modeling or the analysis of experimental or repeated measures data, you may have heard of <strong>random-effects models</strong> or <strong>mixed-effects models</strong>. People often distinguish the predictors in their models between those that are ‘fixed’ and those that are ‘random’. So, a researcher might describe their model as including ‘random effects’ for so and so and ‘fixed effects’ for some other predictor. In fact, a very common way of describing our model above would be that we used a ‘mixed-effect model with random intercepts by listener’. What makes a predictor fixed or random and what is the practical effect of this in our models? It turns out that although they are commonly used, the terms ‘fixed’ and ‘random’ effects do not have a single agreed-upon definition. Gelman (2005) highlights five different definitions of the terms given in the literature:</p>
<ol style="list-style-type: decimal">
<li><p>Fixed effects are constant across individuals/groups, while random effects can vary across them.</p></li>
<li><p>Effects are fixed when you are interested in them specifically, but random if you are actually interested in the population.</p></li>
<li><p>When a sample is the whole population, the effect is fixed. If the sample is a small part of the population, the effect is random.</p></li>
<li><p>If the effect is assumed to be an observation from a random variable, it is a random effect.</p></li>
<li><p>Fixed effects are estimated using maximum likelihood and no pooling. Random effects are estimated using partial pooling (and shrinkage).</p></li>
</ol>
<p>You will note that some of these definitions would have an effect change from random to fixed based on the researcher’s conception of it. Rather than focus on effects as fixed or random in <em>theory</em>, we may ask: What is the difference between these sorts of effects in <em>practice</em>? What special treatment are we referring to when we say that a certain predictor in our model is a ‘random effect’? The answer is that when researchers discuss the inclusion of <strong>random effects</strong> in their models, what they are usually (if not always) referring to is that the effects were estimated using adaptive partial pooling. When researchers indicate that their effects were <strong>fixed effects</strong>, they are usually saying that they were fit with no, or at least minimal, pooling (i.e., using flat or weak priors). This applies to both Bayesian models, and to models fit using more ‘traditional’ approaches such as the popular <code>lmer</code> function in the <code>lme4</code> package in R (Bates et al. 2015).</p>
<p>As a result, although researchers may define ‘random’ effects using any of the definitions above, in practice, terms labelled ‘random’ are usually those estimated using adaptive partial pooling. In light of this, Gelman and Hill (2006) recommend avoiding the terms ‘fixed’ and ‘random’, since these are vaguely defined and overly-broad. Although we agree with this position, the fact is that in many research areas it is still most common to refer to effects as being either fixed or random. For that reason we will follow this convention, although we will continuously highlight the relevant underlying distinction: That so-called ‘random’ effects are simply those that are estimated using adaptive partial pooling.</p>
<p>In general, when you have many levels of a factor, it may be a good idea to include these as ‘random’ effects, regardless of how ‘random’ they might actually be. There is not much downside to it: You get more information from the model (e.g., information about <span class="math inline">\(\sigma_{predictor}\)</span>), there are several modeling advantages associated with estimating large batches of coefficients with adaptive pooling (see chapter 11), and you can always fit multiple models to see what, if any differences, exist across the two approaches. Rather than considering the more ‘philosophical’ position outlined in 1-5 above, some useful things to consider when deciding between fixed and random effects are: Do you believe that treating a predictor as a ‘random’ effect offers a modeling advantage? Does it better reflect the process/relationships you’re trying to understand? Does it provide you with information you find useful? Is it realistic to fit this kind of model given the amount of data you have, and the nature of the relationships in the data? Right now the last point is not something we’ve talked about very much, but it is something we will need to worry about as our models become more complicated.</p>
<div id="c4-inspecting-random-effects" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Inspecting the random effects<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-inspecting-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may have noted that the estimates of our coefficients fit with adaptive pooling (<span class="math inline">\(L\)</span>) do not appear in the model print statement. Instead, only the standard deviation of the effects is presented (<span class="math inline">\(\sigma_L\)</span>, or <code>sd(Intercept)</code>). The reason for this is that there may sometimes be a very large number of random effects coefficients, which would result in models that are difficult to read if they were all shown. A second reason for this is that researchers are often not directly interested in the individual values of their random effects, but rather they are usually focused on the overall effects common to all listeners such as the model intercept. For example, to this point we have been talking about “what is the average apparent height of male speakers” and never “what did listener 04 think the average height of speaker 101 is?”. However, there are situations in which we may be interested in investigating the random effects, and the <code>brms</code> package has several functions to facilitate this process.</p>
<p>We will present two ways to consider the random listener effects using the <code>ranef</code> function, which gets information about your random effects from your <code>brms</code> model. In the first of these you set <code>summary=FALSE</code> in the call to <code>ranef</code> as shown below. This function returns a list of three-dimensional matrices, where each list element is named after the grouping factor it represents. Below, we collect the random effects and take the element named <code>L</code>, corresponding to a matrix representing our listener factor.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get random effects, without summarizing</span></span>
<span id="cb97-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb97-2" aria-hidden="true" tabindex="-1"></a>random_effects <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">ranef</span> (model_multilevel, <span class="at">summary =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get only the listener random effects</span></span>
<span id="cb97-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb97-5" aria-hidden="true" tabindex="-1"></a>listener_effects <span class="ot">=</span> random_effects<span class="sc">$</span>L</span></code></pre></div>
<p>The matrix representing each factor has three dimensions, with individual posterior samples varying across the first dimension (rows), factor levels varying along the second dimension (columns), and parameters varying across the third dimension. Basically, <code>listener_effects</code> is a set of two-dimensional matrices stuck together, one for each random parameter. Of course, this time we only have a single random effect for listeners, and so there is only one element along the third dimension.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (listener_effects)</span>
<span id="cb98-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  num [1:5000, 1:15, 1] -1.76 -2.74 -1.39 -6.66 -2.71 ...</span></span>
<span id="cb98-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  - attr(*, &quot;nchains&quot;)= int 4</span></span>
<span id="cb98-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  - attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb98-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ : NULL</span></span>
<span id="cb98-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ : chr [1:15] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span></span>
<span id="cb98-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ : chr &quot;Intercept&quot;</span></span></code></pre></div>
<p>You can select the matrix corresponding to the intercept by putting the name of the parameter in the third dimension of the matrix, as seen below. This reduces our three-dimensional matrix to a two-dimensional one representing the random listener intercepts in our model.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take only the intercept along the third dimension</span></span>
<span id="cb99-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb99-2" aria-hidden="true" tabindex="-1"></a>listener_intercepts <span class="ot">=</span> listener_effects[,,<span class="st">&quot;Intercept&quot;</span>]</span></code></pre></div>
<p>The above process results in a two-dimensional matrix representing the individual samples of our listener effects. We can see below that this matrix has 5000 rows, corresponding to the individual samples, and 15 columns, representing the individual listeners. We use the <code>head</code> function to see the first six samples of the listener effects. To be totally clear, each column represents the samples of <span class="math inline">\(P(L_{[\bullet]} | y)\)</span> for different speakers. So, the first column represents the individual posterior samples of the listener effect for listener 1 (<span class="math inline">\(P(L_{[1]} | y)\)</span>), and the second column represents the individual posterior samples of the listener effect for listener 2 (<span class="math inline">\(P(L_{[2]} | y)\)</span>),</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our matrix of posterior samples showing 5000 samples </span></span>
<span id="cb100-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for each of 15 listener effects</span></span>
<span id="cb100-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span> (listener_intercepts)</span>
<span id="cb100-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5000   15</span></span>
<span id="cb100-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the first six samples of the listener effect for 6 listeners</span></span>
<span id="cb100-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> ( <span class="fu">round</span> (listener_intercepts[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="dv">2</span>))</span>
<span id="cb100-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          1     2     3     4     5    6</span></span>
<span id="cb100-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,] -1.76 -2.12  3.24  1.29 -2.95 3.13</span></span>
<span id="cb100-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,] -2.74 -1.65  1.84  0.00 -2.93 5.85</span></span>
<span id="cb100-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,] -1.39 -2.99  2.47 -0.02 -5.25 2.98</span></span>
<span id="cb100-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,] -6.66 -5.17 -2.59 -1.72 -6.98 1.72</span></span>
<span id="cb100-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [5,] -2.71 -2.13  3.70 -0.83 -3.61 3.89</span></span>
<span id="cb100-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [6,] -3.20 -1.86  1.96 -1.74 -3.67 5.17</span></span></code></pre></div>
<p>If we were to find the average of the samples within each column, the result would be the posterior mean estimate for each of our individual listener effects.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span> (listener_intercepts)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb101-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     1     2     3     4     5     6     7     8     9    10 </span></span>
<span id="cb101-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="do">## -3.61 -2.65  1.49 -0.69 -3.80  3.81 -5.52  1.91  0.25  1.98</span></span></code></pre></div>
<p>We can repeat the process above but without specifying <code>summary=FALSE</code>. When you do this, rather than the individual samples you get summaries of the posterior distribution of each parameter. We will still get a list of three-dimensional matrices. However, this time factor levels vary across the first dimension (rows), information about each factor level varies across columns, and parameters vary across the third dimension. We again take the list element corresponding listeners (<code>L</code>) and take only the third dimension corresponding to our Intercept.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get random effects, *with* summarizing (by default)</span></span>
<span id="cb102-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb102-2" aria-hidden="true" tabindex="-1"></a>random_effects <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">ranef</span> (model_multilevel)</span>
<span id="cb102-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get only the listener random effects</span></span>
<span id="cb102-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb102-5" aria-hidden="true" tabindex="-1"></a>listener_effects <span class="ot">=</span> random_effects<span class="sc">$</span>L</span>
<span id="cb102-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># along the third (coefficient) dimension, take only the intercept dimension</span></span>
<span id="cb102-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb102-8" aria-hidden="true" tabindex="-1"></a>listener_intercepts <span class="ot">=</span> listener_effects[,,<span class="st">&quot;Intercept&quot;</span>]</span></code></pre></div>
<p>This time, the process results in a two-dimensional matrix representing a summary of the posterior, as seen below. The leftmost column of the output below represents the posterior mean effect estimated for each listener, the second column represents the standard deviation of posterior samples, and the third and fourth columns provide he 2.5% and 97.5% credible intervals for each parameter, respectively. We can see that the information in the first column below exactly matches the posterior means we calculated for each listener effect above. This is because they are the same thing. In the un-summarized representation above we were seeing the individual samples varying across columns, and we ‘summarized’ them by averaging across the columns. In the summarized representation we are seeing the same samples, summarized in each row.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb103-1" aria-hidden="true" tabindex="-1"></a>listener_intercepts[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,]</span>
<span id="cb103-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   Estimate Est.Error   Q2.5    Q97.5</span></span>
<span id="cb103-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  -3.6106     1.404 -6.388 -0.88497</span></span>
<span id="cb103-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  -2.6477     1.387 -5.419  0.07352</span></span>
<span id="cb103-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3   1.4902     1.387 -1.266  4.27533</span></span>
<span id="cb103-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  -0.6855     1.386 -3.393  2.04369</span></span>
<span id="cb103-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 5  -3.7971     1.382 -6.494 -1.11026</span></span>
<span id="cb103-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 6   3.8118     1.399  1.050  6.60174</span></span></code></pre></div>
<p>Notice that the listener averages vary around 0, and some are even negative. That is because the listener effects (and all random effects) are represented as deviations from the intercept, as noted above. We can verify this by calculating the average reported height for each listener and centering these values. We can then compare these centered means to our model random effects and see that they are very similar.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find listener means</span></span>
<span id="cb104-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-2" aria-hidden="true" tabindex="-1"></a>listener_means <span class="ot">=</span> <span class="fu">tapply</span> (men<span class="sc">$</span>height, men<span class="sc">$</span>L, mean)</span>
<span id="cb104-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># center them</span></span>
<span id="cb104-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-5" aria-hidden="true" tabindex="-1"></a>listener_means_centered <span class="ot">=</span> listener_means <span class="sc">-</span> <span class="fu">mean</span>(listener_means)</span>
<span id="cb104-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compare centered means (top row) to model random effects (bottom row)</span></span>
<span id="cb104-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span> (<span class="fu">rbind</span> (listener_means_centered, </span>
<span id="cb104-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">listener_random_effects =</span> listener_intercepts[,<span class="dv">1</span>]))</span>
<span id="cb104-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="do">##                          1  2 3  4  5 6  7 8 9 10 11 12 13 14 15</span></span>
<span id="cb104-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="do">## listener_means_centered -4 -3 2 -1 -4 4 -6 2 0  2 -4  7 -1  3  2</span></span>
<span id="cb104-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="do">## listener_random_effects -4 -3 1 -1 -4 4 -6 2 0  2 -3  6 -1  3  1</span></span></code></pre></div>
<p>We can use a simple plotting function included in the <code>bmmb</code> package (<code>brmplot</code>) to inspect the posterior distributions of our model coefficients. The function takes in the summary matrices made by <code>brms</code> and plots a point for each parameter mean/median, and lines indicating the credible intervals calculated by <code>brm</code> (usually 95% credible intervals). These matrices all have a standard form where parameters vary across rows, the first column is the posterior mean, the second is the posterior standard deviation (the estimated error), and the third and fourth columns are the 2.5% and 97.5% credible intervals. If you have a matrix like this you can easily plot it with <code>brmplot</code> as shown below.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb105-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">brmplot</span>(listener_intercepts)</span></code></pre></div>
<p>We can compare the estimates of our by-listener effects to the distribution of centered height responses arranged by subject. In figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-4">4.4</a> we plot centered listener responses using boxplots and then use <code>brmplot</code> to overlay the colored points and lines, representing the listener ‘random effects’, on top. We can see that the estimated listener parameters and the raw data shows a close correspondence.</p>
<div class="figure"><span style="display:block;" id="fig:F4-4"></span>
<img src="_main_files/figure-html/F4-4-1.jpeg" alt="Distribution of centered apparent height, individually for each listener. Colored points and lines indicate posterior mean estimates and 95% credible intervals for the listener-specific intercept effects (i.e. the listener 'random' effects)." width="4800" />
<p class="caption">
Figure 4.4: Distribution of centered apparent height, individually for each listener. Colored points and lines indicate posterior mean estimates and 95% credible intervals for the listener-specific intercept effects (i.e. the listener ‘random’ effects).
</p>
</div>
</div>
</div>
<div id="c4-simulating" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Simulating data using our model parameters<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-simulating" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Regression models break up variation in the dependent variables into component parts. One way to think about what all the numbers in our model mean is to simulate the dependent variable by building it from the individual component parts indicated by the model. Our model (<code>model_multilevel</code>) has just four components we need to include, one for every estimated parameter: The intercept, the listener-dependent intercepts (<span class="math inline">\(L\)</span>), the between-listener variation (<span class="math inline">\(\sigma_L\)</span>), and the within-listener variation, the error (<span class="math inline">\(\sigma\)</span>).</p>
<p>We do this in the code below. First we set the intercept to 174 cm. Then, we sample 15 random listener effects from a normal distribution, representing simulated listeners. The listener population has a mean of 0 and a standard deviation (<span class="math inline">\(\sigma_L\)</span>) equal to 3.8 as indicated by our model. These effects are stored in a vector called <code>L_</code>, and they represent the values of <span class="math inline">\(L\)</span> for our different listeners. After this we create an index vector <code>L</code> that tells us which value of <code>L_</code> to apply for any given trial. This vector contains the values from 1 to 15, representing each listener, repeated 45 times each in order to simulate 45 observations from each listener. Finally, we draw our error (i.e. <span class="math inline">\(\varepsilon \sim \mathrm{N}(0,\sigma)\)</span>) based on the magnitude of <code>sigma</code> in our model. Note that the error is just <span class="math inline">\(45 \cdot 15\)</span> random draws from this population. Since the model contains the same value of <span class="math inline">\(\sigma\)</span> for all trials, there is no distinction between one listener and another when it comes to the magnitude of the error.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># skip this line if you want a new simulated data set. </span></span>
<span id="cb106-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb106-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the value of our intercept</span></span>
<span id="cb106-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-4" aria-hidden="true" tabindex="-1"></a>Intercept <span class="ot">=</span> <span class="dv">174</span></span>
<span id="cb106-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># this is a vector of 15 listener effects</span></span>
<span id="cb106-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-6" aria-hidden="true" tabindex="-1"></a>L_ <span class="ot">=</span> <span class="fu">rnorm</span> (<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">3.8</span> )</span>
<span id="cb106-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this is a vector indicating which listener produced which utterance</span></span>
<span id="cb106-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-8" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="fu">rep</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">each =</span> <span class="dv">45</span>)</span>
<span id="cb106-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co"># this vector contains the error</span></span>
<span id="cb106-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb106-10" aria-hidden="true" tabindex="-1"></a>error <span class="ot">=</span> <span class="fu">rnorm</span> (<span class="dv">45</span> <span class="sc">*</span> <span class="dv">15</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span></code></pre></div>
<p>After creating our components, we add the Intercept, listener effects and random error to make our fake ‘replicated’ data. Since this data has the same statistical properties as our real data, it should look a lot like it.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the sum of an intercept, listener effects and random error </span></span>
<span id="cb107-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb107-2" aria-hidden="true" tabindex="-1"></a>height_rep <span class="ot">=</span> Intercept <span class="sc">+</span> L_[L] <span class="sc">+</span> error</span></code></pre></div>
<p>In figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-5">4.5</a> we compare the results of our simulation to our real data. The are reasonably similar, which tells us that our model is a good reflection of the data.</p>
<div class="figure"><span style="display:block;" id="fig:F4-5"></span>
<img src="_main_files/figure-html/F4-5-1.jpeg" alt="Comparison of real and simulated apparent height data. Each box represents data from one listener, the horizontal line represents the mean of the listener means. Which is the real data?" width="4800" />
<p class="caption">
Figure 4.5: Comparison of real and simulated apparent height data. Each box represents data from one listener, the horizontal line represents the mean of the listener means. Which is the real data?
</p>
</div>
<p>Below we make two data sets that are ‘incomplete’ with respect to the variation in our data. The first contains the intercept and noise only, the second contains the intercept and listener effects only.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this fake data is missing between listener variation</span></span>
<span id="cb108-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb108-2" aria-hidden="true" tabindex="-1"></a>height_rep_1 <span class="ot">=</span> Intercept <span class="sc">+</span> error</span>
<span id="cb108-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this fake data is missing within listener variation</span></span>
<span id="cb108-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb108-4" aria-hidden="true" tabindex="-1"></a>height_rep_2 <span class="ot">=</span> Intercept <span class="sc">+</span>  L_[L]</span></code></pre></div>
<p>In figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-6">4.6</a> we compare these ‘incomplete’ data sets to the full simulated data. The top row contains only error (<span class="math inline">\(\sigma\)</span>). As a result, height judgments vary around the intercept, but there is no listener to listener variation. This is what that data would look like if there is no variation in means across listeners, as is assumed by the ‘unilevel’ (complete pooling) model in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-2">4.2</a>. However, notice that each little box is not centered at zero. Although we have not added any variation in listener means, a small amount of this appears to be present in our data anyways. This is because although the error distribution has a mean of zero, each of our listener boxes contains only a small sample of errors. This tiny sample of errors is <em>extremely</em> unlikely to add up to exactly zero. Whatever the errors <em>do</em> add up to, this value will contribute some unknown amount to each listener’s sample mean estimate. This makes estimation of the <em>real</em> listener effects impossible in practice.</p>
<div class="figure"><span style="display:block;" id="fig:F4-6"></span>
<img src="_main_files/figure-html/F4-6-1.jpeg" alt="(top) Simulated data containing within-listener variation but no between-listener variation. (middle) Simulated data containing between-listener variation but no within-listener variation. (bottom) Simulated data containing both within and between-listener variation in apparent height." width="4800" />
<p class="caption">
Figure 4.6: (top) Simulated data containing within-listener variation but no between-listener variation. (middle) Simulated data containing between-listener variation but no within-listener variation. (bottom) Simulated data containing both within and between-listener variation in apparent height.
</p>
</div>
<p>In the middle plot, the figure shows only between-listener variation (<span class="math inline">\(\sigma_{L}\)</span>) but no within-listener variation (i.e., no <span class="math inline">\(\sigma\)</span>). Now listeners vary from the intercept, and between each other, but they do not vary within themselves. We can see the effect of this, the boxes have no ‘width’, they are lines. That is because in this situation listeners would <em>always</em> respond at their mean, showing no internal variation in their responses. The final plot is the combination of the variation in the top two plots and shows the final simulated data: The sum of the intercept, the within-listener variation, and the between-listener variation.</p>
<p>As seen in the top row of figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-6">4.6</a>, the model without listener variation is unlikely to generate the substantially-different listener boxplots we see in our data through noise alone. However, they do show a tiny bit of variation in the listener means due to error alone (as noted above). So, random error can give the impression of listener variation even when none exists. We can investigate how likely our error is to generate listener means as diverse as those we have observed, <em>by accident</em>. To do this, we run one more simulation, identical in all respects except for two things: 1) We set the between-listener variance to zero, and 2) we set the noise variance to 7.8 (as in our complete pooling model). Below we generate 10,000 simulated data sets and record the standard deviation of the listener means for each one. These values will be stored in a vector called <code>sigma_L_rep</code> since we are simulating values of <span class="math inline">\(\sigma_L\)</span> for our complete pooling model.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb109-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co"># do 10,000 replications</span></span>
<span id="cb109-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-4" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb109-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co"># hold the replicated values of sigma_L</span></span>
<span id="cb109-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-6" aria-hidden="true" tabindex="-1"></a>sigma_L_rep <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,reps)</span>
<span id="cb109-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps){</span>
<span id="cb109-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-8" aria-hidden="true" tabindex="-1"></a>  Intercept <span class="ot">=</span> <span class="fl">173.8</span> <span class="co"># set the intercept</span></span>
<span id="cb109-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-9" aria-hidden="true" tabindex="-1"></a>  L_L <span class="ot">=</span> <span class="fu">rnorm</span> (<span class="dv">15</span>, <span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># zero between-listener variance</span></span>
<span id="cb109-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-10" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">=</span> <span class="fu">rep</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">each =</span> <span class="dv">45</span>) <span class="co"># 45 responses from each of 15 listeners</span></span>
<span id="cb109-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-11" aria-hidden="true" tabindex="-1"></a>  epsilon <span class="ot">=</span> <span class="fu">rnorm</span> (<span class="dv">45</span> <span class="sc">*</span> <span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">7.78</span>) <span class="co"># generate random noise</span></span>
<span id="cb109-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-12" aria-hidden="true" tabindex="-1"></a>  height_rep <span class="ot">=</span> Intercept <span class="sc">+</span> L_L[L] <span class="sc">+</span> epsilon <span class="co"># add up to components</span></span>
<span id="cb109-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-13" aria-hidden="true" tabindex="-1"></a>  L_rep_means <span class="ot">=</span> <span class="fu">tapply</span>(height_rep, L, mean) <span class="co"># get replicated listener means</span></span>
<span id="cb109-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-14" aria-hidden="true" tabindex="-1"></a>  sigma_L_rep[i] <span class="ot">=</span> <span class="fu">sd</span> (L_rep_means) <span class="co"># find sigma of listener effects</span></span>
<span id="cb109-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb109-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Below, we see that even in 10,000 simulations we do not see a standard deviation greater than 2.1, and that 75% are smaller than 1.3.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(sigma_L_rep)</span>
<span id="cb110-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     0%    25%    50%    75%   100% </span></span>
<span id="cb110-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.4429 0.9862 1.1337 1.2810 2.0813</span></span></code></pre></div>
<p>The standard deviation of the listener means in our data was 3.6 and our model estimate of <span class="math inline">\(\sigma_L\)</span> was 3.8. This reinforces the idea that between-listener variation (<span class="math inline">\(\sigma_L\)</span>) is a ‘real’ aspect of our data, that is <em>extremely</em> unlikely to arise by incidentally due to random variation, and that our models will benefit from taking it into account.</p>
</div>
<div id="c4-second-random-effect" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Adding a second random effect<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-second-random-effect" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our model is looking better, but is still not ‘right’. This is because in addition to repeatedly sampling from only 15 listeners, our model also features repeated sampling from only 45 different speakers. In figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-7">4.7</a> we see that we can recreate figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-1">4.1</a>, this time illustrating systematic variation between speakers in addition to between listeners. So, we are interested in the average apparent height of adult males overall but have only sampled 45 of them, and we need to build this information into our model.</p>
<div class="figure"><span style="display:block;" id="fig:F4-7"></span>
<img src="_main_files/figure-html/F4-7-1.jpeg" alt="(left) Distribution of all apparent height judgments for adult male speakers. (middle) Distribution of height judgments for adult male speakers, individually for each listener. (right) Distribution of height judgments for adult male speakers, individually for each speaker." width="4800" />
<p class="caption">
Figure 4.7: (left) Distribution of all apparent height judgments for adult male speakers. (middle) Distribution of height judgments for adult male speakers, individually for each listener. (right) Distribution of height judgments for adult male speakers, individually for each speaker.
</p>
</div>
<p>In order to investigate this, our model will now include the following additional variable from our <code>exp_data</code> data frame:</p>
<ul>
<li><code>S</code>: An integer from 1-139 indicating which <em>speaker</em> produced the trial stimulus.</li>
</ul>
<div id="c4-updating-model" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Updating the model description<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-updating-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to model the effects of the different speakers in our data, our formula must be updated to include our <code>S</code> (speaker) predictor in parentheses, like this:</p>
<p><code>height ~ 1 + ( 1 | L) + ( 1 | S)</code></p>
<p>The new term in parentheses indicates a second predictor whose levels we want to estimate using adaptive pooling. Again, we include only a one on the left hand side of the pipe indicating that we are only estimating speaker-specific intercepts. So, this formula says ‘predict height using only an overall intercept, but also estimate a different intercept for each level of listener and speaker’. The regression model corresponding to the formula above now looks like this:</p>
<p><span class="math display" id="eq:4-12">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{N}(\mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{Intercept} + L_{[\mathsf{L}_{[i]}]} + S_{[\mathsf{S}_{[i]}]} \\ \\
\mathrm{Priors:} \\
L_{[\bullet]} \sim \mathrm{N}(0,\sigma_L) \\
S_{[\bullet]} \sim \mathrm{N}(0,\sigma_S) \\
\\
\mathrm{Intercept} \sim \mathrm{N}(176,15) \\
\sigma \sim \mathrm{N}(0,15) \\
\sigma_L \sim \mathrm{N}(0,15) \\
\sigma_S \sim \mathrm{N}(0,15)
\end{split}
\tag{4.13}
\end{equation}
\]</span></p>
<p>Just as with the listener coefficients (<span class="math inline">\(L\)</span>), the speaker coefficients (<span class="math inline">\(S\)</span>) represent deviations in values from the intercept and so the speaker average is set to zero. In plain English, the model description above says:</p>
<blockquote>
<p>We expect height judgments to be normally distributed around the expected value for any given trial, <span class="math inline">\(\mu_{[i]}\)</span>, with some unknown standard deviation <span class="math inline">\(\sigma\)</span>. The expected value for a trial is equal to the sum of a fixed overall average (Intercept), some value associated with the individual listener (<span class="math inline">\(L_{[\mathsf{L}_{[i]}]}\)</span>) who judged the trial, and some value associated with the individual speaker (<span class="math inline">\(S_{[\mathsf{S}_{[i]}]}\)</span>) who produced the trial. The listener and speaker coefficients (<span class="math inline">\(L\)</span> and <span class="math inline">\(S\)</span>) were both modeled as coming from normal distributions whose standard deviations, <span class="math inline">\(\sigma_L\)</span> and <span class="math inline">\(\sigma_S\)</span>, were estimated from the data. Prior distributions for <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\sigma_L\)</span>, <span class="math inline">\(\sigma_S\)</span>, and the intercept were all specified a priori.</p>
</blockquote>
<p>The model we fit last chapter only included variation due to error. The first model we fit in this chapter divided variation into random between-listener variation and random within-listener error. Now, our model breaks up the total variance in our data into three components: Between-listener variation, between-speaker variation, and random error, as seen below.</p>
<p><span class="math display" id="eq:4-13">\[
\begin{equation}
\sigma^2_{total} = \sigma^2_{L} + \sigma^2_{S} + \sigma^2
\tag{4.14}
\end{equation}
\]</span></p>
<p>If the error was the within-listener variation before, what does it represent now? Our error is now the difference between the value we expect, given the speaker <em>and</em> listener, and the value we observe. So, it is the variation <em>adjusting for</em> the speaker and listener. In other words, if you know who the speaker is and who the listener is, and you adjust for this, how much random variability do you still have left over in your model? The answer is <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="fitting-and-interpreting-the-model" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> Fitting and interpreting the model<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fitting-and-interpreting-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below, we fit the new model using exactly the same code as for <code>model_multilevel</code>, save for the modification to the model formula. We don’t need to specify a hyperprior for <span class="math inline">\(\sigma_S\)</span> because this falls under the <code>sd</code> category (see section <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-fitting-1">4.5.3</a>). As long as we can use the same hyperprior for each factor-specific standard deviation, i.e. <span class="math inline">\(\sigma_{F}\)</span> for factor <span class="math inline">\(F\)</span>, we don’t need to specify a prior for each parameter. We think a prior expectation of 15 cm is reasonable for the speaker standard deviation given that the standard deviation of adult male heights in the US is around 7.5 cm.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb111-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb111-2" aria-hidden="true" tabindex="-1"></a>model_multilevel_L_S <span class="ot">=</span>  brms<span class="sc">::</span><span class="fu">brm</span> (</span>
<span id="cb111-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), <span class="at">data =</span> men, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb111-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>,</span>
<span id="cb111-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(176, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb111-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb111-6" aria-hidden="true" tabindex="-1"></a>            brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb111-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb111-7" aria-hidden="true" tabindex="-1"></a>            brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb112-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb112-2" aria-hidden="true" tabindex="-1"></a>model_multilevel_L_S <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;4_model_multilevel_L_S.RDS&#39;</span>)</span></code></pre></div>
<p>After fitting the model we inspect the output, some of which we include below:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb113-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">short_summary</span> (model_multilevel_L_S)</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ~S (Number of levels: 45)</span></span>
<span id="cb114-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb114-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)     2.83      0.42      2.1     3.72</span></span></code></pre></div>
<p>The model print statement should look familiar except it contains one new chunk representing information about the speaker predictor in our model (shown above). This chunk reminds us that our <code>S</code> predictor had 45 levels, and provides us information about the estimate of the <span class="math inline">\(\sigma_S\)</span> parameter (<code>sd(Intercept)</code>), which is 2.83 according to our model.</p>
</div>
</div>
<div id="c4-investigating-shrinkage" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Investigating ‘shrinkage’<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-investigating-shrinkage" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve mentioned that multilevel models can result in <em>shrinkage</em>, that is, estimates that are smaller in magnitude (i.e. closer to the mean) than their no pooling counterparts. In the code below we extract the posterior mean estimates of our listener and speaker random effects (i.e., <span class="math inline">\(L\)</span> and <span class="math inline">\(S\)</span>). These estimates have been ‘shrunken’ by combining their likelihoods with the prior. We also calculate the no pooling estimates for the listener and speaker averages, and center these so that they will resemble their corresponding effects.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these are the Bayesian &#39;shrinkage&#39; estimates of</span></span>
<span id="cb115-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the listener effects</span></span>
<span id="cb115-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-3" aria-hidden="true" tabindex="-1"></a>L_shrunk <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">ranef</span>(model_multilevel_L_S)<span class="sc">$</span>L[,<span class="dv">1</span>,<span class="st">&#39;Intercept&#39;</span>]</span>
<span id="cb115-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and the speaker effects</span></span>
<span id="cb115-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-5" aria-hidden="true" tabindex="-1"></a>S_shrunk <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">ranef</span>(model_multilevel_L_S)<span class="sc">$</span>S[,<span class="dv">1</span>,<span class="st">&#39;Intercept&#39;</span>]</span>
<span id="cb115-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># these are the no pooling estimates</span></span>
<span id="cb115-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-8" aria-hidden="true" tabindex="-1"></a>L_nopooling <span class="ot">=</span> <span class="fu">tapply</span> (men<span class="sc">$</span>height, men<span class="sc">$</span>L, mean)</span>
<span id="cb115-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-9" aria-hidden="true" tabindex="-1"></a>S_nopooling <span class="ot">=</span> <span class="fu">tapply</span> (men<span class="sc">$</span>height, men<span class="sc">$</span>S, mean)</span>
<span id="cb115-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co"># and now they are centered</span></span>
<span id="cb115-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-11" aria-hidden="true" tabindex="-1"></a>L_nopooling <span class="ot">=</span> L_nopooling <span class="sc">-</span> <span class="fu">mean</span> (L_nopooling)</span>
<span id="cb115-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb115-12" aria-hidden="true" tabindex="-1"></a>S_nopooling <span class="ot">=</span> S_nopooling <span class="sc">-</span> <span class="fu">mean</span> (S_nopooling)</span></code></pre></div>
<p>Figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-8">4.8</a> shows the result of shrinkage for the listener and speaker effects: Individual effects are ‘pulled’ towards the overall mean at zero. We can see that in all cases, the effects estimated with adaptive pooling lie closer to the mean than those estimated with no pooling. This is particularly evident for the speaker effects, and in particular those of speaker 87, highlighted in that figure.</p>
<div class="figure"><span style="display:block;" id="fig:F4-8"></span>
<img src="_main_files/figure-html/F4-8-1.jpeg" alt="(top row) A comparison of the shrunken (i.e. adaptive pooling) and no pooling estimates of the listener and speaker effects. Curves indicate the density of the prior distribution of each set of effects. Arrows link shrunken and no pooling effects for each listener/speaker. (bottom row) An illustration of how the effect for speaker 87, highlighted in the top row, gets shrunken towards the prior through adaptive pooling." width="4800" />
<p class="caption">
Figure 4.8: (top row) A comparison of the shrunken (i.e. adaptive pooling) and no pooling estimates of the listener and speaker effects. Curves indicate the density of the prior distribution of each set of effects. Arrows link shrunken and no pooling effects for each listener/speaker. (bottom row) An illustration of how the effect for speaker 87, highlighted in the top row, gets shrunken towards the prior through adaptive pooling.
</p>
</div>
<p>In the bottom row of figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-8">4.8</a>, we focus on the process by which the effect for speaker 87 gets shrunken from a no pooling value of -11.6 to a shrunken (adaptive pooling) value of -8.6. This example is simply meant to illustrate how this happens at a conceptual level, the actual calculations and processes involved are more complicated than this. Figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-8">4.8</a> is very similar to <a href="fitting-bayesian-regression-models-with-brms.html#fig:F3-1">3.1</a>, which presented the blending of priors and likelihoods to find the posterior. The shrinkage of random effects arises from the same behavior: We combine the likelihood of a parameter in isolation with prior information about other parameters like it to arrive at a posterior estimate that blends the two.</p>
<p>Our ‘no pooling’ estimate is an estimate based solely on the individual likelihood of the parameter. The likelihood function we present in the figure is the likelihood of the speaker effect for speaker 87 given their judged height on 15 observations. To calculate this, we assume that <span class="math inline">\(\sigma=6.47\)</span> as in our last model, and use centered height judgements. The prior density we present in the figure is based on our model parameters, it has a mean of 0 and a standard deviation of 2.83. To find the posterior distribution presented in the bottom row of figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-8">4.8</a>, we multiplied the curves representing the likelihood and the prior for each point along the x axis. So, even in this simple demonstration we can see how effect estimates get pulled, or shrunken, away from their no pooling values by their priors.</p>
<p>In figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-9">4.9</a> we plot the no pooling estimates (x axis) against the difference between the no pooling and shrunken estimates (y axis). The difference between the no pooling and shrunken estimate is basically the magnitude of the horizontal arrow shown in the bottom row of figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-8">4.8</a>, for each pair of shrunken and no pooling parameters. It is the amount of tilt in the arrows in the top row of the same figure; in the absence of shrinkage they would all be vertical. We can see that the amount of shrinkage, the difference between the no pooling and shrunken estimates, varies as a function of the magnitude of the estimate. More deviant estimates are shrunken more, and less deviant estimates are shrunken less.</p>
<div class="figure"><span style="display:block;" id="fig:F4-9"></span>
<img src="_main_files/figure-html/F4-9-1.jpeg" alt="The x axis represents the no pooling estimate for listener (L) and speaker (S) effects. The y axis represents the difference between the shrunken and no pooling estimates of each parameter, i.e. the amount of shrinkage. Positive values indicate that the shrunken estimate was greater than the no pooling one, and vice versa. Shrunken values were more positive for negative values and more negative for positive values." width="4800" />
<p class="caption">
Figure 4.9: The x axis represents the no pooling estimate for listener (L) and speaker (S) effects. The y axis represents the difference between the shrunken and no pooling estimates of each parameter, i.e. the amount of shrinkage. Positive values indicate that the shrunken estimate was greater than the no pooling one, and vice versa. Shrunken values were more positive for negative values and more negative for positive values.
</p>
</div>
<p>You may have noted that the listener effects exhibit less shrinkage than the speaker effects. There are two reasons for this. First, we have 45 observations for each listener but only 15 for each speaker. As a result, the likelihood functions for our listener effects will be narrower than those of our speaker effects. This makes the likelihoods for our listener parameters more resistant to the effects of the prior, and therefore more resistant to shrinkage (see sections <a href="fitting-bayesian-regression-models-with-brms.html#c3-posterior">3.3.2</a> and <a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods-2">2.7.3</a> for more information). Second, a large proportion of the speaker effects are close to zero, with only a relatively small number exhibiting large deviations from this. In contrast, the listener effects are less concentrated near the average. As a result of this <span class="math inline">\(\sigma_L &gt; \sigma_S\)</span>, which causes speaker effects to be shrunken more than listener effects, in general.</p>
</div>
<div id="c4-answering-question" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Answering our research questions<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-answering-question" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s return to the research questions we posed in section <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-data-and-qs-1">4.5.1</a>:</p>
<p>(Q1) How tall does the average adult male sound?</p>
<p>(Q2) Can we set limits on credible average apparent heights based on the data we collected?</p>
<p>We can consider the answers provided to this question by the complete pooling model we fit at the end of last chapter:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">short_summary</span> (model_priors)</span>
<span id="cb116-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula:  height ~ 1</span></span>
<span id="cb116-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects:</span></span>
<span id="cb116-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb116-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept    173.8      0.31    173.2    174.4</span></span>
<span id="cb116-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb116-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters:</span></span>
<span id="cb116-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb116-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma     7.77      0.21     7.37     8.19</span></span></code></pre></div>
<p>And compare this to the final model we considered above, which contained information about repeated measurements across speakers and listeners:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">short_summary</span> (model_multilevel_L_S)</span>
<span id="cb117-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula:  height ~ 1 + (1 | L) + (1 | S)</span></span>
<span id="cb117-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb117-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Group-Level Effects:</span></span>
<span id="cb117-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ~L (Number of levels: 15)</span></span>
<span id="cb117-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb117-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)     3.81      0.86     2.51     5.87</span></span>
<span id="cb117-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb117-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="do">## ~S (Number of levels: 45)</span></span>
<span id="cb117-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb117-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)     2.83      0.42      2.1     3.72</span></span>
<span id="cb117-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb117-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects:</span></span>
<span id="cb117-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb117-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept    173.8      1.12    171.6    176.1</span></span>
<span id="cb117-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb117-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters:</span></span>
<span id="cb117-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="do">##       Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb117-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma     6.47      0.19     6.11     6.85</span></span></code></pre></div>
<p>Our complete pooling model from the previous chapter, <code>model_priors</code>, and our adaptive pooling model from this chapter, <code>model_multilevel_L_S</code>, agree on the average apparent height as reflected by their respective intercept terms. However, they disagree on a credible interval for the parameter, with the complete pooling model having a 95% credible interval that is nearly four times narrower (1.2 cm vs 4.4 cm). This is because the complete pooling model did not specify information about repeated measures, which caused our model to think that it had more independent observations than it did. This led the initial model to return an overly-precise estimate.</p>
<p>Another difference is that the final model has a smaller <code>sigma</code> parameter (7.8 vs 6.5), which indicates that the data-level error is smaller in the final model than in the initial model. Keep in mind that ‘error’ is just what your model can’t explain at the data level. Our final model explains more (at the listener and speaker levels) and so there is less error (at the data level). The reduced error is a direct consequence of the fact that the final model splits variation in the data into several components (i.e., <span class="math inline">\(\sigma^2_{total}=\sigma^2_{L}+\sigma^2_{S}+\sigma^2\)</span>). Since <span class="math inline">\(\sigma_{total}\)</span> is a fixed value (given the data), obviously, the larger your between-speaker and between-listener variation is, the smaller your random error (<span class="math inline">\(\sigma\)</span>) <em>must</em> be.</p>
<p>Usually, parameters should be reported with <em>at least</em> the mean/median and standard deviations of the posterior distribution, in addition to some useful credible interval (i.e., 50%, 95%) around that parameter. Based on the result of our final model, a thorough answer to our research questions might go something like:</p>
<blockquote>
<p>“Based on our model the average apparent height of adult males is likely to be 173.8 cm (s.d. = 1.1, 95% CI = [171.6, 176.1]). The estimated magnitude of the random error was 6.5 cm (s.d. = 0.2, 95% CI = [6.1, 6.9]). Systematic between-listener variation averages about 3.8 cm (s.d. = 0.9, 95% CI = [2.5, 5.8]), while systematic between-speaker variation averages about 2.8 cm (s.d. = 0.4, 95% CI = [2.1, 3.8]).</p>
</blockquote>
</div>
<div id="c4-frequentist" class="section level2 hasAnchor" number="4.11">
<h2><span class="header-section-number">4.11</span> ‘Traditionalists’ corner<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-frequentist" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In traditionalists corner, we’re going to compare the output of <code>brms</code> to some more ‘traditional’ approaches. We’re not going to talk about the traditional models in any detail, the focus of this section is simply to highlight the similarities between different approaches, and to point out where to find equivalent information in the different models. If you are already familiar with these approaches, these sections may be helpful. If not, some of the information provided here may not make much sense, although it may still be helpful. If you want to know more about the statistical methods being discussed here, please see the preface for a list of suggested background reading in statistics.</p>
<div id="c4-vs-lmer" class="section level3 hasAnchor" number="4.11.1">
<h3><span class="header-section-number">4.11.1</span> Bayesian multilevel models vs. lmer<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-vs-lmer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we compare the output of <code>brms</code> to the output of the <code>lmer</code> (“linear mixed-effects regression”) function, a very popular function for fitting multilevel models in the <code>lme4</code> R package. We’re not going to talk about <code>lmer</code> in very much detail. The focus of this section is simply to highlight the similarities between different approaches, and to point out where to find equivalent information in both kinds of models. Below we use <code>lmer</code> to fit a model that is analogous to our <code>model_multilevel_L_S</code> model. The <code>lmer</code> function uses adaptive pooling to estimate its ‘random effects’ and no pooling to estimate its ‘fixed effects’. Notice that the formulas are identical in both cases, except we do not specify priors for this model.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb118-1" aria-hidden="true" tabindex="-1"></a>lmer_model <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span> (height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), <span class="at">data =</span> men)</span></code></pre></div>
<p>We can consider the short print statement for our Bayesian model, which we have annotated with numbers indicating where certain information can be found.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">short_summary</span>(model_multilevel_L_S)</span>
<span id="cb119-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) Formula:  height ~ 1 + (1 | L) + (1 | S)</span></span>
<span id="cb119-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb119-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="do">## (2) Group-Level Effects:</span></span>
<span id="cb119-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     ~L (Number of levels: 15)</span></span>
<span id="cb119-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb119-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="do">## (3) sd(Intercept)     3.81      0.86     2.51     5.87</span></span>
<span id="cb119-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb119-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     ~S (Number of levels: 45)</span></span>
<span id="cb119-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb119-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (4) sd(Intercept)     2.83      0.42      2.1     3.72</span></span>
<span id="cb119-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb119-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="do">##     Population-Level Effects:</span></span>
<span id="cb119-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb119-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="do">## (5) Intercept    173.8      1.12    171.6   176.05</span></span>
<span id="cb119-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb119-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-18" aria-hidden="true" tabindex="-1"></a><span class="do">##     Family Specific Parameters:</span></span>
<span id="cb119-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb119-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="do">## (6) sigma     6.47      0.19     6.11     6.85</span></span></code></pre></div>
<p>And compare this to the print statement of our <code>lmer</code> model, annotated with the same numbers highlighting equivalent information. We see that our models provide very similar information, although it is organized (and named) in somewhat different ways. We also see that the two approaches provide us with very similar parameter estimates for our models.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (lmer_model)</span>
<span id="cb120-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="do">##     Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb120-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (1) Formula: height ~ 1 + (1 | L) + (1 | S)</span></span>
<span id="cb120-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="do">##        Data: men</span></span>
<span id="cb120-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb120-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     REML criterion at convergence: 4527.4</span></span>
<span id="cb120-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb120-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     Scaled residuals: </span></span>
<span id="cb120-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="do">##         Min      1Q  Median      3Q     Max </span></span>
<span id="cb120-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     -4.6205 -0.4868  0.0722  0.5700  2.7179 </span></span>
<span id="cb120-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb120-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (2) Random effects:</span></span>
<span id="cb120-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="do">##      Groups   Name        Variance Std.Dev.</span></span>
<span id="cb120-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="do">## (3)  S        (Intercept)  7.593   2.756   </span></span>
<span id="cb120-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="do">## (4)  L        (Intercept) 11.990   3.463   </span></span>
<span id="cb120-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="do">## (6)  Residual             41.630   6.452   </span></span>
<span id="cb120-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="do">##     Number of obs: 675, groups:  S, 45; L, 15</span></span>
<span id="cb120-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb120-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="do">##     Fixed effects:</span></span>
<span id="cb120-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-21" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Estimate Std. Error t value</span></span>
<span id="cb120-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="do">## (5) (Intercept)  173.788      1.015   171.3</span></span></code></pre></div>
<p>We can get the random effects out of our <code>brm</code> model and compare them to the random effects we get from <code>lmer</code>. As seen below, the random effects estimates we get from <code>brm</code> also include credible intervals. As a result, we have some idea regarding the uncertainty in these estimates.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-1" aria-hidden="true" tabindex="-1"></a>brms_ranefs <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">ranef</span> (model_multilevel_L_S)<span class="sc">$</span>L[,,<span class="st">&quot;Intercept&quot;</span>]</span>
<span id="cb121-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (brms_ranefs)</span>
<span id="cb121-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Estimate Est.Error   Q2.5    Q97.5</span></span>
<span id="cb121-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  -3.6312     1.346 -6.366 -1.07315</span></span>
<span id="cb121-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  -2.6594     1.371 -5.350  0.01293</span></span>
<span id="cb121-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3   1.5297     1.368 -1.158  4.23982</span></span>
<span id="cb121-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  -0.7165     1.358 -3.380  1.95702</span></span>
<span id="cb121-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5  -3.8413     1.361 -6.472 -1.18510</span></span>
<span id="cb121-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6   3.8990     1.353  1.266  6.58467</span></span></code></pre></div>
<p>In contrast, <code>lmer</code> gives you what are called <strong>point estimates</strong>. These are single estimates of parameter values with no intervals indicating uncertainty. Because of this, it is difficult to compare estimates for different speakers/participants in the data.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-1" aria-hidden="true" tabindex="-1"></a>lmer_ranefs <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">ranef</span> (lmer_model)[[<span class="st">&quot;L&quot;</span>]]</span>
<span id="cb122-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (lmer_ranefs)</span>
<span id="cb122-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   (Intercept)</span></span>
<span id="cb122-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     -3.6134</span></span>
<span id="cb122-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     -2.6726</span></span>
<span id="cb122-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3      1.5298</span></span>
<span id="cb122-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     -0.7024</span></span>
<span id="cb122-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     -3.8238</span></span>
<span id="cb122-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6      3.8796</span></span></code></pre></div>
<p>Importantly, the values we get from both approaches are nearly identical, as seen in figure <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fig:F4-10">4.10</a>.</p>
<div class="figure"><span style="display:block;" id="fig:F4-10"></span>
<img src="_main_files/figure-html/F4-10-1.jpeg" alt="(left) In green, the random speaker intercept estimates provided by brm. The red arrows indicate the estimates of the same provided by lmer. ." width="4800" />
<p class="caption">
Figure 4.10: (left) In green, the random speaker intercept estimates provided by brm. The red arrows indicate the estimates of the same provided by lmer. .
</p>
</div>
<p>The <em>largest</em> difference between the two sets of coefficients is 0.05 cm for the listener effects and 0.06 cm for the speaker effects, with the average absolute difference for both being around 0.03 cm. So, as a practical matter analyzing this data using a Bayesian multilevel model provides some advantages (e.g. intervals around random effects), while still providing effectively the same ‘answers’ as a ‘traditional’ approach to the data.</p>
</div>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="4.12">
<h2><span class="header-section-number">4.12</span> Exercises<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The analyses in the main body of the text all involve only the unmodified ‘actual’ resonance level (in <code>exp_data</code>). Responses for the stimuli with the simulate ‘big’ resonance are reserved for exercises throughout. You can get the ‘big’ resonance in the <code>exp_ex</code> data frame, or all data in the <code>exp_data_all</code> data frame.</p>
<p>Fit and interpret one or more of the suggested models:</p>
<ol style="list-style-type: decimal">
<li><p>Easy: Analyze the (pre-fit) model that’s exactly like <code>model_multilevel_L_S</code>, except using the data in <code>exp_ex</code> (<code>bmmb::get_model("model_multilevel_L_S_ex.RDS")</code>).</p></li>
<li><p>Medium: Fit a model just like <code>model_multilevel_L_S</code>, but for the data from some other group, for either the original or big resonance levels.</p></li>
<li><p>Hard: Fit two models like <code>model_multilevel_L_S</code> for two groups, or for one group across resonance levels, and compare results across models.</p></li>
</ol>
<p>In any case, describe the model, present and explain the results, and include some figures.</p>
</div>
<div id="references-2" class="section level2 hasAnchor" number="4.13">
<h2><span class="header-section-number">4.13</span> References<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#references-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bates D, Mächler M, Bolker B, Walker S (2015). “Fitting Linear Mixed-Effects Models Using lme4.” Journal of Statistical Software, 67(1), 1–48. <a href="doi:10.18637/jss.v067.i01" class="uri">doi:10.18637/jss.v067.i01</a>.</p>
<p>Gelman, A., &amp; Hill, J. (2006). Data analysis using regression and multilevel/hierarchical models. Cambridge university press.</p>
<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., &amp; Rubin, D. B. (2013). Bayesian Data Analysis.</p>
</div>
<div id="plot-code-3" class="section level2 hasAnchor" number="4.14">
<h2><span class="header-section-number">4.14</span> Plot Code<a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#plot-code-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-2"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-3"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.1</span></span>
<span id="cb123-4"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-5"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (bmmb)</span>
<span id="cb123-7"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span> (exp_data)</span>
<span id="cb123-8"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-8" aria-hidden="true" tabindex="-1"></a>men <span class="ot">=</span> exp_data[exp_data<span class="sc">$</span>C_v<span class="sc">==</span><span class="st">&#39;m&#39;</span>,]</span>
<span id="cb123-9"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-10"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of height judgments</span></span>
<span id="cb123-11"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-11" aria-hidden="true" tabindex="-1"></a>mens_height <span class="ot">=</span> men<span class="sc">$</span>height</span>
<span id="cb123-12"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="co">#par (mar = c(.1,.1,.5,.1), mfrow = c(1,1), oma = c(4.2,.20,0,.2))</span></span>
<span id="cb123-14"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co">#layout (m=matrix(c(1,2,3,4),2,2), heights = c(.25,.75))</span></span>
<span id="cb123-15"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-16"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,.<span class="dv">5</span>,.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb123-17"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-18"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="co">#plot (0,type=&#39;n&#39;,xlab=&#39;&#39;,ylab=&#39;&#39;,xaxt=&#39;n&#39;,yaxt=&#39;n&#39;,bty=&#39;n&#39;)</span></span>
<span id="cb123-19"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-20"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (men<span class="sc">$</span>height,<span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">195</span>), </span>
<span id="cb123-21"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">2</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">horizontal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb123-22"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">2</span>,<span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">text=</span><span class="st">&quot;Apparent height (cm)&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">line=</span><span class="fl">2.9</span>,<span class="at">adj=</span>.<span class="dv">55</span>)</span>
<span id="cb123-23"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-24"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-25"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-25" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot (tapply(men$height,men$L,mean), xlab = &quot;&quot;,xaxt=&#39;n&#39;,</span></span>
<span id="cb123-26"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-26" aria-hidden="true" tabindex="-1"></a><span class="co">#         col = cols, ylim = c(140,195), width = 2,cex.axis=1.3, </span></span>
<span id="cb123-27"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-27" aria-hidden="true" tabindex="-1"></a><span class="co">#         horizontal = TRUE)</span></span>
<span id="cb123-28"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-28" aria-hidden="true" tabindex="-1"></a><span class="co">#abline (h=)</span></span>
<span id="cb123-29"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-29" aria-hidden="true" tabindex="-1"></a><span class="co">#text (1,190,expression(sigma[&quot;[within]&quot;]), cex=2)</span></span>
<span id="cb123-30"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-31"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-31" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xaxt=</span><span class="st">&#39;s&#39;</span>,</span>
<span id="cb123-32"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> cols[<span class="sc">-</span><span class="dv">1</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">195</span>), <span class="at">cex.lab=</span><span class="fl">1.1</span>,<span class="at">cex.axis=</span><span class="fl">1.1</span>,</span>
<span id="cb123-33"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-34"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb123-35"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fu">mean</span>(mens_height), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb123-36"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-36" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">col =</span> cols[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>)],<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-37"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-38"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-38" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">1</span>,<span class="at">outer=</span><span class="cn">TRUE</span>, <span class="st">&quot;Apparent height (cm)&quot;</span>,<span class="at">line=</span><span class="sc">-</span><span class="fl">0.9</span>)</span>
<span id="cb123-39"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-40"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-40" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-41"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-41" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.2</span></span>
<span id="cb123-42"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-42" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-43"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-44"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-44" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;../wrong_plots/Figure 4.2.jpg&quot;</span>)</span>
<span id="cb123-45"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-46"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-46" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-47"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-47" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.3</span></span>
<span id="cb123-48"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-48" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-49"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-50"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-50" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb123-51"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-51" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Listener&quot;</span>,</span>
<span id="cb123-52"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">&quot;Apparent height (cm)&quot;</span>,</span>
<span id="cb123-53"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>bmmb<span class="sc">::</span>cols, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">150</span>,<span class="dv">195</span>), <span class="at">outline=</span><span class="cn">FALSE</span>) </span>
<span id="cb123-54"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-54" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fu">mean</span>(men<span class="sc">$</span>height), <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb123-55"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-55" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">outline=</span><span class="cn">FALSE</span>) </span>
<span id="cb123-56"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-57"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-57" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-58"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-58" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.4</span></span>
<span id="cb123-59"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-59" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-60"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-61"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-61" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb123-62"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-63"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-63" aria-hidden="true" tabindex="-1"></a>height_centered <span class="ot">=</span> (men<span class="sc">$</span>height<span class="sc">-</span><span class="fu">mean</span>(men<span class="sc">$</span>height))</span>
<span id="cb123-64"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-64" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height_centered <span class="sc">~</span> L, <span class="at">data=</span>men, <span class="at">col =</span> <span class="dv">0</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">23</span>,<span class="dv">21</span>), <span class="at">xlab=</span><span class="st">&quot;Listener&quot;</span>,</span>
<span id="cb123-65"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-65" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">&quot;Centered apparent height (cm)&quot;</span>, <span class="at">outline =</span> <span class="cn">FALSE</span>)</span>
<span id="cb123-66"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-66" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb123-67"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-67" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">brmplot</span>(listener_intercepts, <span class="at">col =</span> bmmb<span class="sc">::</span>cols, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">20</span>), </span>
<span id="cb123-68"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">outline =</span> <span class="cn">FALSE</span>)</span>
<span id="cb123-69"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-70"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-70" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-71"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-71" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.5</span></span>
<span id="cb123-72"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-72" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-73"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-74"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-74" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">3.5</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb123-75"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-76"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-76" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height_rep <span class="sc">~</span> L, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">200</span>), <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb123-77"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-77" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>bmmb<span class="sc">::</span>cols)</span>
<span id="cb123-78"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-78" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fl">173.8</span>, <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb123-79"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-79" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">200</span>), <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb123-80"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-80" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>bmmb<span class="sc">::</span>cols,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb123-81"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-81" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fl">173.8</span>, <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb123-82"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-82" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">text =</span> <span class="st">&quot;Apparent height (cm)&quot;</span>, <span class="at">side=</span><span class="dv">2</span>, <span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb123-83"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-84"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-84" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-85"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-85" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.6</span></span>
<span id="cb123-86"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-86" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-87"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-88"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-88" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(.<span class="dv">1</span>,<span class="dv">3</span>,.<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb123-89"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-89" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height_rep_1 <span class="sc">~</span> L, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">198</span>),<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,</span>
<span id="cb123-90"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-90" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>bmmb<span class="sc">::</span>cols,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-91"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-91" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">1</span>, <span class="dv">145</span>, <span class="at">label =</span> <span class="st">&quot;Intercept + error&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb123-92"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-92" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h=</span><span class="fl">174.8</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb123-93"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-93" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span> (<span class="at">side=</span><span class="dv">2</span>,<span class="at">at=</span><span class="fu">seq</span>(<span class="dv">150</span>,<span class="dv">190</span>,<span class="dv">10</span>))</span>
<span id="cb123-94"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-95"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-95" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height_rep_2 <span class="sc">~</span> L, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">198</span>),<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,</span>
<span id="cb123-96"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>bmmb<span class="sc">::</span>cols,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-97"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-97" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h=</span><span class="fl">174.8</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb123-98"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-98" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">1</span>, <span class="dv">145</span>, <span class="at">label =</span> <span class="st">&quot;Intercept + L&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb123-99"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-99" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span> (<span class="at">side=</span><span class="dv">2</span>,<span class="at">at=</span><span class="fu">seq</span>(<span class="dv">150</span>,<span class="dv">190</span>,<span class="dv">10</span>))</span>
<span id="cb123-100"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-101"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-101" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height_rep <span class="sc">~</span> L, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">198</span>),<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,</span>
<span id="cb123-102"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-102" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span>bmmb<span class="sc">::</span>cols,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-103"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-103" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h=</span><span class="fl">174.8</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb123-104"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-104" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">1</span>, <span class="dv">145</span>, <span class="at">label =</span> <span class="st">&quot;Intercept + L + error&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb123-105"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-106"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-106" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">2</span>,<span class="at">text=</span><span class="st">&quot;Apparent height (cm)&quot;</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line=</span><span class="dv">0</span>)</span>
<span id="cb123-107"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-107" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span> (<span class="at">side=</span><span class="dv">2</span>,<span class="at">at=</span><span class="fu">seq</span>(<span class="dv">150</span>,<span class="dv">190</span>,<span class="dv">10</span>))</span>
<span id="cb123-108"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-109"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-110"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-110" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-111"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-111" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.7</span></span>
<span id="cb123-112"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-112" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-113"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-114"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-114" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (bmmb)</span>
<span id="cb123-115"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-115" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span> (exp_data)</span>
<span id="cb123-116"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-116" aria-hidden="true" tabindex="-1"></a>men <span class="ot">=</span> exp_data[exp_data<span class="sc">$</span>C_v<span class="sc">==</span><span class="st">&#39;m&#39;</span>,]</span>
<span id="cb123-117"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-118"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-118" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of height judgments</span></span>
<span id="cb123-119"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-119" aria-hidden="true" tabindex="-1"></a>mens_height <span class="ot">=</span> men<span class="sc">$</span>height</span>
<span id="cb123-120"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-121"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-121" aria-hidden="true" tabindex="-1"></a><span class="co">#par (mar = c(.1,.1,.5,.1), mfrow = c(1,1), oma = c(4.2,.20,0,.2))</span></span>
<span id="cb123-122"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-122" aria-hidden="true" tabindex="-1"></a><span class="co">#layout (m=matrix(c(1,2,3,4),2,2), heights = c(.25,.75))</span></span>
<span id="cb123-123"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-124"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-124" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>,.<span class="dv">5</span>,.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb123-125"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-126"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-126" aria-hidden="true" tabindex="-1"></a><span class="co">#plot (0,type=&#39;n&#39;,xlab=&#39;&#39;,ylab=&#39;&#39;,xaxt=&#39;n&#39;,yaxt=&#39;n&#39;,bty=&#39;n&#39;)</span></span>
<span id="cb123-127"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-128"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-128" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (men<span class="sc">$</span>height,<span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">195</span>), </span>
<span id="cb123-129"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-129" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">2</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">horizontal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb123-130"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-130" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">2</span>,<span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">text=</span><span class="st">&quot;Apparent height (cm)&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">line=</span><span class="fl">2.9</span>,<span class="at">adj=</span>.<span class="dv">55</span>)</span>
<span id="cb123-131"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-132"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-133"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-133" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot (tapply(men$height,men$L,mean), xlab = &quot;&quot;,xaxt=&#39;n&#39;,</span></span>
<span id="cb123-134"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-134" aria-hidden="true" tabindex="-1"></a><span class="co">#         col = cols, ylim = c(140,195), width = 2,cex.axis=1.3, </span></span>
<span id="cb123-135"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-135" aria-hidden="true" tabindex="-1"></a><span class="co">#         horizontal = TRUE)</span></span>
<span id="cb123-136"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-136" aria-hidden="true" tabindex="-1"></a><span class="co">#abline (h=)</span></span>
<span id="cb123-137"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-137" aria-hidden="true" tabindex="-1"></a><span class="co">#text (1,190,expression(sigma[&quot;[within]&quot;]), cex=2)</span></span>
<span id="cb123-138"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-139"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-139" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xaxt=</span><span class="st">&#39;s&#39;</span>,</span>
<span id="cb123-140"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-140" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> cols[<span class="sc">-</span><span class="dv">1</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">195</span>), <span class="at">cex.lab=</span><span class="fl">1.1</span>,<span class="at">cex.axis=</span><span class="fl">1.1</span>,</span>
<span id="cb123-141"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-141" aria-hidden="true" tabindex="-1"></a>         <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-142"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-142" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb123-143"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-143" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fu">mean</span>(mens_height), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb123-144"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-144" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> L, <span class="at">data =</span> men, <span class="at">col =</span> cols[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>)],<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-145"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-146"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-147"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-147" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> S, <span class="at">data =</span> men, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xaxt=</span><span class="st">&#39;s&#39;</span>,</span>
<span id="cb123-148"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-148" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> cols[<span class="sc">-</span><span class="dv">1</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">140</span>,<span class="dv">195</span>), <span class="at">cex.lab=</span><span class="fl">1.1</span>,<span class="at">cex.axis=</span><span class="fl">1.1</span>,</span>
<span id="cb123-149"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-149" aria-hidden="true" tabindex="-1"></a>         <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-150"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-150" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb123-151"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-151" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fu">mean</span>(mens_height), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb123-152"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-152" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span> (height <span class="sc">~</span> S, <span class="at">data =</span> men, <span class="at">col =</span> cols[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>)],<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb123-153"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-154"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-154" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">1</span>,<span class="at">outer=</span><span class="cn">TRUE</span>, <span class="st">&quot;Apparent height (cm)&quot;</span>,<span class="at">line=</span><span class="sc">-</span><span class="fl">1.3</span>)</span>
<span id="cb123-155"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-156"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-156" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-157"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-157" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.8</span></span>
<span id="cb123-158"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-158" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-159"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-160"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-160" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,.<span class="dv">51</span>,.<span class="dv">5</span>,.<span class="dv">51</span>))</span>
<span id="cb123-161"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-162"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-162" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span> (<span class="at">mat =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb123-163"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-164"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-164" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (L_nopooling,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">15</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.3</span>), <span class="at">cex=</span><span class="fl">1.5</span>,<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">rev</span>(bmmb<span class="sc">::</span>cols), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">13</span>), </span>
<span id="cb123-165"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>,<span class="at">xlab =</span> <span class="st">&#39;Listener Effects&#39;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb123-166"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-166" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (L_shrunk,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">cex=</span><span class="fl">1.5</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="fu">rev</span>(bmmb<span class="sc">::</span>cols),<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb123-167"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-167" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span> (L_nopooling,<span class="fl">0.1</span>,L_shrunk,<span class="fl">0.9</span>, <span class="at">length=</span><span class="fl">0.1</span>)</span>
<span id="cb123-168"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-168" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&#39;grey&#39;</span>)</span>
<span id="cb123-169"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-169" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">12</span>,<span class="dv">12</span>,<span class="fl">0.01</span>)</span>
<span id="cb123-170"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-170" aria-hidden="true" tabindex="-1"></a>den <span class="ot">=</span> <span class="fu">dnorm</span> (x, <span class="dv">0</span>, <span class="fl">3.79</span>)</span>
<span id="cb123-171"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-171" aria-hidden="true" tabindex="-1"></a>den <span class="ot">=</span> den <span class="sc">/</span> <span class="fu">max</span> (den)</span>
<span id="cb123-172"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-172" aria-hidden="true" tabindex="-1"></a>den2 <span class="ot">=</span> <span class="fu">dnorm</span> (x, <span class="dv">0</span>, <span class="fu">sd</span>(S_nopooling))</span>
<span id="cb123-173"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-173" aria-hidden="true" tabindex="-1"></a>den2 <span class="ot">=</span> den2 <span class="sc">/</span> <span class="fu">max</span> (den2)</span>
<span id="cb123-174"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-174" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(sigma[<span class="st">&quot;L&quot;</span>],<span class="st">&quot; = 3.79&quot;</span>)), <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-175"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-175" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;P(L)&quot;</span>)), <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-176"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-176" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span> (x, (den<span class="sc">*</span><span class="dv">2</span>)<span class="sc">+</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb123-177"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-177" aria-hidden="true" tabindex="-1"></a><span class="co">#lines (x, (den2*2)+2, lwd = 2, col = 4,lty=3)</span></span>
<span id="cb123-178"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-179"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-179" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="sc">-</span><span class="fl">13.5</span>,<span class="dv">0</span>,<span class="st">&quot;No pooling&quot;</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb123-180"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-180" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="sc">-</span><span class="fl">13.5</span>,<span class="dv">1</span>,<span class="st">&quot;Shrunken&quot;</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb123-181"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-182"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-182" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">5</span>,<span class="dv">4</span>,<span class="st">&quot;Listener Effects&quot;</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb123-183"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-184"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-185"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-185" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (S_nopooling,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">45</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">4.3</span>), <span class="at">cex=</span><span class="fl">1.5</span>,<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">rev</span>(bmmb<span class="sc">::</span>cols), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">13</span>), </span>
<span id="cb123-186"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-186" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,<span class="at">xlab =</span> <span class="st">&#39;Speaker Effects&#39;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb123-187"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-187" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (S_shrunk,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">45</span>), <span class="at">cex=</span><span class="fl">1.5</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="fu">rev</span>(bmmb<span class="sc">::</span>cols),<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb123-188"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-188" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span> (S_nopooling,<span class="fl">0.1</span>,S_shrunk,<span class="fl">0.9</span>, <span class="at">length=</span><span class="fl">0.1</span>)</span>
<span id="cb123-189"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-189" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&#39;grey&#39;</span>)</span>
<span id="cb123-190"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-190" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">12</span>,<span class="dv">12</span>,<span class="fl">0.01</span>)</span>
<span id="cb123-191"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-191" aria-hidden="true" tabindex="-1"></a>den <span class="ot">=</span> <span class="fu">dnorm</span> (x, <span class="dv">0</span>, <span class="fl">2.84</span>)</span>
<span id="cb123-192"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-192" aria-hidden="true" tabindex="-1"></a>den <span class="ot">=</span> den <span class="sc">/</span> <span class="fu">max</span> (den)</span>
<span id="cb123-193"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-193" aria-hidden="true" tabindex="-1"></a>den2 <span class="ot">=</span> <span class="fu">dnorm</span> (x, <span class="dv">0</span>, <span class="fu">sd</span>(L_nopooling))</span>
<span id="cb123-194"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-194" aria-hidden="true" tabindex="-1"></a>den2 <span class="ot">=</span> den2 <span class="sc">/</span> <span class="fu">max</span> (den2)</span>
<span id="cb123-195"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-195" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(sigma[<span class="st">&quot;S&quot;</span>],<span class="st">&quot; = 2.84&quot;</span>)), <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-196"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-196" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;P(S)&quot;</span>)), <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-197"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-198"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-198" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span> (x, (den<span class="sc">*</span><span class="dv">2</span>)<span class="sc">+</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb123-199"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-199" aria-hidden="true" tabindex="-1"></a><span class="co">#lines (x, (den2*2)+2, lwd = 2, col = 4,lty=3)</span></span>
<span id="cb123-200"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-201"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-201" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">5</span>,<span class="dv">4</span>,<span class="st">&quot;Speaker Effects&quot;</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb123-202"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-203"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-204"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-204" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="sc">-</span><span class="dv">12</span>, <span class="fl">0.5</span>, <span class="st">&quot;S=87&quot;</span>)</span>
<span id="cb123-205"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-205" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (S_nopooling[<span class="dv">41</span>],<span class="fl">0.05</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="at">cex=</span><span class="fl">2.5</span>,<span class="at">pch=</span><span class="dv">1</span>,</span>
<span id="cb123-206"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-206" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">5</span>], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">17</span>,<span class="dv">9</span>), <span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb123-207"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-207" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&#39;Speaker Effects&#39;</span>,<span class="at">lwd=</span><span class="dv">3</span>, <span class="at">yaxs =</span> <span class="st">&#39;i&#39;</span>)</span>
<span id="cb123-208"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-208" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (S_shrunk[<span class="dv">41</span>],<span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">2.5</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">5</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb123-209"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-209" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span> (S_nopooling[<span class="dv">41</span>],<span class="fl">0.05</span>,S_shrunk[<span class="dv">41</span>]<span class="sc">-</span>.<span class="dv">5</span>,<span class="fl">0.05</span>, <span class="at">length=</span><span class="fl">0.1</span>)</span>
<span id="cb123-210"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-210" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="fl">0.01</span>)</span>
<span id="cb123-211"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-211" aria-hidden="true" tabindex="-1"></a>den <span class="ot">=</span> <span class="fu">dnorm</span> (x, <span class="dv">0</span>, <span class="fl">2.84</span>)</span>
<span id="cb123-212"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-212" aria-hidden="true" tabindex="-1"></a>den <span class="ot">=</span> den <span class="sc">/</span> <span class="fu">max</span> (den)</span>
<span id="cb123-213"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-214"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-214" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> exp_data<span class="sc">$</span>height[exp_data<span class="sc">$</span>S<span class="sc">==</span><span class="dv">87</span>] <span class="sc">-</span> <span class="fl">173.8</span></span>
<span id="cb123-215"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-215" aria-hidden="true" tabindex="-1"></a>den2 <span class="ot">=</span> <span class="fu">dnorm</span> (x, <span class="fu">mean</span> (tmp), <span class="fl">6.47</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">14</span>))</span>
<span id="cb123-216"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-216" aria-hidden="true" tabindex="-1"></a>den2 <span class="ot">=</span> den2 <span class="sc">/</span> <span class="fu">max</span> (den2)</span>
<span id="cb123-217"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-218"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-218" aria-hidden="true" tabindex="-1"></a>den3 <span class="ot">=</span> den2 <span class="sc">*</span> den</span>
<span id="cb123-219"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-219" aria-hidden="true" tabindex="-1"></a>den3 <span class="ot">=</span> den3 <span class="sc">/</span> <span class="fu">max</span> (den3)</span>
<span id="cb123-220"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-221"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-221" aria-hidden="true" tabindex="-1"></a>den4 <span class="ot">=</span> <span class="fu">dnorm</span> (x, <span class="sc">-</span><span class="fl">8.560</span> ,  <span class="fl">1.648</span>)</span>
<span id="cb123-222"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-222" aria-hidden="true" tabindex="-1"></a>den4 <span class="ot">=</span> den4 <span class="sc">/</span> <span class="fu">max</span> (den4)</span>
<span id="cb123-223"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-224"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-225"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-225" aria-hidden="true" tabindex="-1"></a>use2 <span class="ot">=</span> (x <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">17</span>) <span class="sc">&amp;</span> (x <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">5</span>)</span>
<span id="cb123-226"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-226" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span> (x[use2], (den2)[use2], <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> bmmb<span class="sc">::</span>cols[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb123-227"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-227" aria-hidden="true" tabindex="-1"></a><span class="co">#lines (x[use2], (den4)[use2], lwd = 3, col = bmmb::cols[6], lty = 2)</span></span>
<span id="cb123-228"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-229"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-229" aria-hidden="true" tabindex="-1"></a>use3 <span class="ot">=</span> (x <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">13</span>) <span class="sc">&amp;</span> (x <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb123-230"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-230" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span> (x[use3], (den3[use3]), <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> bmmb<span class="sc">::</span>cols[<span class="dv">5</span>])</span>
<span id="cb123-231"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-231" aria-hidden="true" tabindex="-1"></a>use <span class="ot">=</span> (x <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">10</span>) <span class="sc">&amp;</span> (x <span class="sc">&lt;</span> <span class="dv">10</span>)</span>
<span id="cb123-232"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-232" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span> (x[use], (den[use]), <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb123-233"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-234"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-234" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (S_nopooling[<span class="dv">41</span>],<span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">2.5</span>,<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">5</span>])</span>
<span id="cb123-235"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-235" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (S_shrunk[<span class="dv">41</span>],<span class="fl">0.05</span>, <span class="at">cex=</span><span class="fl">2.5</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">5</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb123-236"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-237"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-237" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (S_nopooling[<span class="dv">41</span>],<span class="fl">1.25</span>,<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;P(y|&quot;</span>,S[<span class="st">&quot;[87]&quot;</span>],<span class="st">&quot;)&quot;</span>)), <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-238"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-238" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (S_shrunk[<span class="dv">41</span>],<span class="fl">1.25</span>,<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;P(&quot;</span>,S[<span class="st">&quot;[87]&quot;</span>],<span class="st">&quot;|y)&quot;</span>)), <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-239"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-239" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">0</span>,<span class="fl">1.25</span>,<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;P(&quot;</span>,S,<span class="st">&quot;)&quot;</span>)), <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-240"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-241"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-241" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (S_nopooling[<span class="dv">41</span>],.<span class="dv">5</span>,<span class="at">label =</span> <span class="st">&quot;Likelihood&quot;</span>, <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-242"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-242" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (S_shrunk[<span class="dv">41</span>],.<span class="dv">5</span>,<span class="at">label =</span> <span class="st">&quot;Posterior&quot;</span>, <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-243"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-243" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="dv">0</span>,.<span class="dv">5</span>,<span class="at">label =</span> <span class="st">&quot;Prior&quot;</span>, <span class="at">cex =</span> <span class="fl">1.25</span>)</span>
<span id="cb123-244"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-245"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-246"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-246" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb123-247"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-248"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-249"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-249" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-250"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-250" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.9</span></span>
<span id="cb123-251"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-251" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-252"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-253"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-253" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(.<span class="dv">25</span>,<span class="dv">4</span>,.<span class="dv">25</span>,<span class="dv">1</span>), <span class="at">oma=</span><span class="fu">c</span>(<span class="dv">4</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>))</span>
<span id="cb123-254"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-254" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-255"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-255" aria-hidden="true" tabindex="-1"></a><span class="co"># plot (L_nopooling, L_shrunk, xlim = c(-10,10), ylim = c(-10,10),</span></span>
<span id="cb123-256"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-256" aria-hidden="true" tabindex="-1"></a><span class="co">#       pch=4, lwd=3, col=bmmb::cols,cex=2.25,xaxt=&quot;n&quot;,xlab=&quot;&quot;)</span></span>
<span id="cb123-257"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-257" aria-hidden="true" tabindex="-1"></a><span class="co"># grid()</span></span>
<span id="cb123-258"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-258" aria-hidden="true" tabindex="-1"></a><span class="co"># abline (0,1,col=2,lwd=2)</span></span>
<span id="cb123-259"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-259" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(h=0,v=0,lty=3,lwd=2)</span></span>
<span id="cb123-260"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-260" aria-hidden="true" tabindex="-1"></a><span class="co"># points (L_nopooling, L_shrunk, pch=4,lwd=3, col=bmmb::cols,cex=2.25)</span></span>
<span id="cb123-261"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-261" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb123-262"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-262" aria-hidden="true" tabindex="-1"></a><span class="co"># plot (S_nopooling, S_shrunk, xlim = c(-12,12), ylim = c(-12,12),</span></span>
<span id="cb123-263"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-263" aria-hidden="true" tabindex="-1"></a><span class="co">#       pch=4, col=4,cex=2.25,xaxt=&quot;n&quot;,xlab=&quot;&quot;)</span></span>
<span id="cb123-264"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-264" aria-hidden="true" tabindex="-1"></a><span class="co"># grid()</span></span>
<span id="cb123-265"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-265" aria-hidden="true" tabindex="-1"></a><span class="co"># abline (0,1,col=2, lwd=2)</span></span>
<span id="cb123-266"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-266" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(h=0,v=0,lty=3,lwd=2)</span></span>
<span id="cb123-267"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-267" aria-hidden="true" tabindex="-1"></a><span class="co"># points (S_nopooling, S_shrunk, pch=4,lwd=3, col=bmmb::cols,cex=2.25)</span></span>
<span id="cb123-268"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-269"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-269" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (L_nopooling, L_shrunk<span class="sc">-</span>L_nopooling, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),</span>
<span id="cb123-270"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-270" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">rev</span>(bmmb<span class="sc">::</span>cols),<span class="at">cex=</span><span class="fl">2.25</span>,<span class="at">cex.lab=</span><span class="fl">0.9</span>,<span class="at">cex.axis =</span> <span class="fl">0.9</span>)</span>
<span id="cb123-271"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-271" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb123-272"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-272" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb123-273"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-273" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (L_nopooling, L_shrunk<span class="sc">-</span>L_nopooling, <span class="at">pch=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>bmmb<span class="sc">::</span>cols,<span class="at">cex=</span><span class="fl">2.25</span>)</span>
<span id="cb123-274"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-275"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-275" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side =</span> <span class="dv">1</span>, <span class="at">text =</span> <span class="st">&quot;L_nopooling&quot;</span>, <span class="at">line=</span><span class="fl">2.5</span>,<span class="at">cex=</span><span class="fl">0.9</span>)</span>
<span id="cb123-276"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-277"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-277" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (S_nopooling, S_shrunk<span class="sc">-</span>S_nopooling, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12</span>,<span class="dv">12</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),</span>
<span id="cb123-278"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-278" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch=</span><span class="dv">3</span>, <span class="at">col=</span><span class="dv">4</span>,<span class="at">cex=</span><span class="fl">2.25</span>,<span class="at">cex.lab=</span><span class="fl">0.9</span>,<span class="at">cex.axis =</span> <span class="fl">0.9</span>)</span>
<span id="cb123-279"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-279" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb123-280"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-280" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb123-281"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-281" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (S_nopooling, S_shrunk<span class="sc">-</span>S_nopooling, <span class="at">pch=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">rev</span>(bmmb<span class="sc">::</span>cols),<span class="at">cex=</span><span class="fl">2.25</span>)</span>
<span id="cb123-282"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-283"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-283" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side =</span> <span class="dv">1</span>, <span class="at">text =</span> <span class="st">&quot;S_nopooling&quot;</span>, <span class="at">line=</span><span class="fl">2.5</span>,<span class="at">cex=</span><span class="fl">0.9</span>)</span>
<span id="cb123-284"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-285"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-285" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-286"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-286" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 4.10</span></span>
<span id="cb123-287"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-287" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb123-288"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-289"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-289" aria-hidden="true" tabindex="-1"></a>brms_ranefs_S <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">ranef</span> (model_multilevel_L_S)<span class="sc">$</span>S[,,<span class="st">&quot;Intercept&quot;</span>]</span>
<span id="cb123-290"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-290" aria-hidden="true" tabindex="-1"></a>lmer_ranefs_S <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">ranef</span> (lmer_model)[[<span class="st">&quot;S&quot;</span>]]</span>
<span id="cb123-291"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-292"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-293"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-293" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="fl">4.5</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb123-294"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-295"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-295" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (brms_ranefs, <span class="at">xlab=</span><span class="st">&quot;Listener&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Listener Effect (cm)&quot;</span>, <span class="at">col=</span>deepgreen, <span class="at">line =</span> <span class="cn">FALSE</span>)</span>
<span id="cb123-296"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-296" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb123-297"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-298"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-298" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (lmer_ranefs[,<span class="dv">1</span>],<span class="at">pch=</span><span class="dv">4</span>,<span class="at">cex=</span><span class="fl">1.5</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>coral, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb123-299"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-299" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb123-300"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-301"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-301" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (brms_ranefs_S, <span class="at">xlab=</span><span class="st">&quot;Speaker&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Speaker Effect (cm)&quot;</span>, <span class="at">col=</span>deepgreen, <span class="at">line =</span> <span class="cn">FALSE</span>)</span>
<span id="cb123-302"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-302" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb123-303"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-304"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-304" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span> (lmer_ranefs_S[,<span class="dv">1</span>],<span class="at">pch=</span><span class="dv">4</span>,<span class="at">cex=</span><span class="fl">1.5</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>coral, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb123-305"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-305" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb123-306"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-307"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-307" aria-hidden="true" tabindex="-1"></a><span class="co">#plot (brms_ranefs[,1], lmer_ranefs[,1], lwd=2, cex=1.5, col=deeppurple,</span></span>
<span id="cb123-308"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-308" aria-hidden="true" tabindex="-1"></a><span class="co">#      xlab = &#39;brms Random Effects (cm)&#39;, ylab = &#39;lmer Random Effects (cm)&#39;, pch=16)</span></span>
<span id="cb123-309"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-309" aria-hidden="true" tabindex="-1"></a><span class="co">#abline (0,1,col=2)</span></span>
<span id="cb123-310"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#cb123-310" aria-hidden="true" tabindex="-1"></a><span class="co">#abline (h = 0, v = 0, lty=3)</span></span></code></pre></div>

<div style="page-break-after: always;"></div>
</div>
</div>
<!-- Default Statcounter code for statsbook
https://santiagobarreda.github.io/stats-class/ -->
<script type="text/javascript">
var sc_project=12454226; 
var sc_invisible=1; 
var sc_security="a1959418"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/12454226/0/a1959418/1/"
alt="Web Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->
            </section>

          </div>
        </div>
      </div>
<a href="fitting-bayesian-regression-models-with-brms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparing-two-groups-of-observations-factors-and-contrasts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
