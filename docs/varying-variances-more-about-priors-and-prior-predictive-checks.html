<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Varying variances, more about priors, and prior predictive checks | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R</title>
  <meta name="description" content="Bayesian Models for Repeated Measures" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Varying variances, more about priors, and prior predictive checks | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Bayesian Models for Repeated Measures" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Varying variances, more about priors, and prior predictive checks | Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R" />
  
  <meta name="twitter:description" content="Bayesian Models for Repeated Measures" />
  

<meta name="author" content="Santiago Bareda and Noah Silbert" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="comparing-many-groups-interactions-and-posterior-predictive-checks.html"/>
<link rel="next" href="quantitative-predictors-and-their-interactions-with-factors.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Repeated Measures data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bayesian-multilevel-models-and-repeated-measures-data"><i class="fa fa-check"></i>Bayesian Multilevel models and repeated measures data</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#whats-missing-from-this-book"><i class="fa fa-check"></i>What’s missing from this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistics-as-procedural-knowledge"><i class="fa fa-check"></i>Statistics as Procedural knowledge</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#practice-vs-brain-power"><i class="fa fa-check"></i>Practice vs brain power</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supplemental-resources"><i class="fa fa-check"></i>Supplemental Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#our-target-audience"><i class="fa fa-check"></i>Our target audience</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-self-starter"><i class="fa fa-check"></i>The self-starter</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-convert"><i class="fa fa-check"></i>The convert</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-instructor"><i class="fa fa-check"></i>The instructor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-need-installed-to-use-this-book"><i class="fa fa-check"></i>What you need installed to use this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-go-bayesian"><i class="fa fa-check"></i>Why go Bayesian?</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-brms"><i class="fa fa-check"></i>Why brms?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#it-takes-a-village-of-books"><i class="fa fa-check"></i>It takes a village (of books)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html"><i class="fa fa-check"></i><b>1</b> Introduction: Experiments and Variables</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#chapter-pre-cap"><i class="fa fa-check"></i><b>1.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-and-effects"><i class="fa fa-check"></i><b>1.2</b> Experiments and effects</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-and-inference"><i class="fa fa-check"></i><b>1.2.1</b> Experiments and inference</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp"><i class="fa fa-check"></i><b>1.3</b> Our experiment</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-intro"><i class="fa fa-check"></i><b>1.3.1</b> Our experiment: Introduction</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-methods"><i class="fa fa-check"></i><b>1.3.2</b> Our experimental methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-research-questions"><i class="fa fa-check"></i><b>1.3.3</b> Our research questions</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-exp-data"><i class="fa fa-check"></i><b>1.3.4</b> Our experimental data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-variables"><i class="fa fa-check"></i><b>1.4</b> Variables</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-pops-and-samps"><i class="fa fa-check"></i><b>1.4.1</b> Populations and samples</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-dep-and-indep"><i class="fa fa-check"></i><b>1.4.2</b> Dependent and Independent Variables</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-categorical"><i class="fa fa-check"></i><b>1.4.3</b> Categorical variables and ‘factors’</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-quantitative"><i class="fa fa-check"></i><b>1.4.4</b> Quantitative variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-logical"><i class="fa fa-check"></i><b>1.4.5</b> Logical variables</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting"><i class="fa fa-check"></i><b>1.5</b> Inspecting our data</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-categorical"><i class="fa fa-check"></i><b>1.5.1</b> Inspecting categorical variables</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-quantitative"><i class="fa fa-check"></i><b>1.5.2</b> Inspecting quantitative variables</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#c1-inspecting-together"><i class="fa fa-check"></i><b>1.5.3</b> Exploring continuous and categorical variables together</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#references"><i class="fa fa-check"></i><b>1.7</b> References</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-experiments-and-variables.html"><a href="introduction-experiments-and-variables.html#plot-code"><i class="fa fa-check"></i><b>1.8</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html"><i class="fa fa-check"></i><b>2</b> Probabilities, likelihood, and inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#chapter-pre-cap-1"><i class="fa fa-check"></i><b>2.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="2.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-data"><i class="fa fa-check"></i><b>2.2</b> Data and research questions</a></li>
<li class="chapter" data-level="2.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-empirical-prob"><i class="fa fa-check"></i><b>2.3</b> Empirical Probabilities</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-conditional"><i class="fa fa-check"></i><b>2.3.1</b> Conditional and marginal probabilities</a></li>
<li class="chapter" data-level="2.3.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-joint"><i class="fa fa-check"></i><b>2.3.2</b> Joint probabilities</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-theoretical"><i class="fa fa-check"></i><b>2.4</b> Probability distributions</a></li>
<li class="chapter" data-level="2.5" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-normal"><i class="fa fa-check"></i><b>2.5</b> The normal distribution</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-sample-mean"><i class="fa fa-check"></i><b>2.5.1</b> The sample mean</a></li>
<li class="chapter" data-level="2.5.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-sample-variance"><i class="fa fa-check"></i><b>2.5.2</b> The sample variance (or standard deviation)</a></li>
<li class="chapter" data-level="2.5.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-normal-density"><i class="fa fa-check"></i><b>2.5.3</b> The normal density</a></li>
<li class="chapter" data-level="2.5.4" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-standard-normal"><i class="fa fa-check"></i><b>2.5.4</b> The standard normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-models-and-inference"><i class="fa fa-check"></i><b>2.6</b> Models and inference</a></li>
<li class="chapter" data-level="2.7" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-likelihoods"><i class="fa fa-check"></i><b>2.7</b> Probabilities of events and likelihoods of parameters</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods"><i class="fa fa-check"></i><b>2.7.1</b> Characteristics of likelihoods</a></li>
<li class="chapter" data-level="2.7.2" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-logarithms"><i class="fa fa-check"></i><b>2.7.2</b> A brief aside on logarithms</a></li>
<li class="chapter" data-level="2.7.3" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-chars-of-likelihoods-2"><i class="fa fa-check"></i><b>2.7.3</b> Characteristics of likelihoods, continued</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#c2-inference-and-likelihood"><i class="fa fa-check"></i><b>2.8</b> Answering our research questions</a></li>
<li class="chapter" data-level="2.9" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#exercises-1"><i class="fa fa-check"></i><b>2.9</b> Exercises</a></li>
<li class="chapter" data-level="2.10" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#references-1"><i class="fa fa-check"></i><b>2.10</b> References</a></li>
<li class="chapter" data-level="2.11" data-path="probabilities-likelihood-and-inference.html"><a href="probabilities-likelihood-and-inference.html#plot-code-1"><i class="fa fa-check"></i><b>2.11</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html"><i class="fa fa-check"></i><b>3</b> Fitting Bayesian regression models with <em>brms</em></a>
<ul>
<li class="chapter" data-level="3.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#chapter-pre-cap-2"><i class="fa fa-check"></i><b>3.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="3.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-what-is-reg"><i class="fa fa-check"></i><b>3.2</b> What are regression models?</a></li>
<li class="chapter" data-level="3.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-whats-bayes"><i class="fa fa-check"></i><b>3.3</b> What’s ‘Bayesian’ about these models?</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-priors"><i class="fa fa-check"></i><b>3.3.1</b> Prior probabilities</a></li>
<li class="chapter" data-level="3.3.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-posterior"><i class="fa fa-check"></i><b>3.3.2</b> Posterior distributions</a></li>
<li class="chapter" data-level="3.3.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-characteristics-posteriors"><i class="fa fa-check"></i><b>3.3.3</b> Posterior distributions and shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-sampling"><i class="fa fa-check"></i><b>3.4</b> Sampling from the posterior using <em>Stan</em> and <em>brms</em></a></li>
<li class="chapter" data-level="3.5" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-estimating"><i class="fa fa-check"></i><b>3.5</b> Estimating a single mean with the <code>brms</code> package</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-data-qs-1"><i class="fa fa-check"></i><b>3.5.1</b> Data and Research Questions</a></li>
<li class="chapter" data-level="3.5.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-description-1"><i class="fa fa-check"></i><b>3.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="3.5.3" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-errors-and-residuals"><i class="fa fa-check"></i><b>3.5.3</b> Errors and residuals</a></li>
<li class="chapter" data-level="3.5.4" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-model-formula"><i class="fa fa-check"></i><b>3.5.4</b> The model formula</a></li>
<li class="chapter" data-level="3.5.5" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-calling-brm"><i class="fa fa-check"></i><b>3.5.5</b> Fitting the model: Calling the <em>brm</em> function</a></li>
<li class="chapter" data-level="3.5.6" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-interpreting-print"><i class="fa fa-check"></i><b>3.5.6</b> Interpreting the model: The print statement</a></li>
<li class="chapter" data-level="3.5.7" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-seeing-samples"><i class="fa fa-check"></i><b>3.5.7</b> Seeing the samples</a></li>
<li class="chapter" data-level="3.5.8" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-getting-residuals"><i class="fa fa-check"></i><b>3.5.8</b> Getting the residuals</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-checking-convergence"><i class="fa fa-check"></i><b>3.6</b> Checking model convergence</a></li>
<li class="chapter" data-level="3.7" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-specifying-priors"><i class="fa fa-check"></i><b>3.7</b> Specifying prior probabilities</a></li>
<li class="chapter" data-level="3.8" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-log-posterior"><i class="fa fa-check"></i><b>3.8</b> The log prior and log posterior densities</a></li>
<li class="chapter" data-level="3.9" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-answering-qs"><i class="fa fa-check"></i><b>3.9</b> Answering our research questions</a></li>
<li class="chapter" data-level="3.10" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-frequentist"><i class="fa fa-check"></i><b>3.10</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-vs-ttest"><i class="fa fa-check"></i><b>3.10.1</b> One-sample t-test vs. intercept-only Bayesian models</a></li>
<li class="chapter" data-level="3.10.2" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#c3-vs-ols"><i class="fa fa-check"></i><b>3.10.2</b> Intercept-only ordinary-least-squares regression vs. intercept-only Bayesian models</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#exercises-2"><i class="fa fa-check"></i><b>3.11</b> Exercises</a></li>
<li class="chapter" data-level="3.12" data-path="fitting-bayesian-regression-models-with-brms.html"><a href="fitting-bayesian-regression-models-with-brms.html#plot-code-2"><i class="fa fa-check"></i><b>3.12</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><i class="fa fa-check"></i><b>4</b> Inspecting a ‘single group’ of observations using a Bayesian multilevel model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#chapter-pre-cap-3"><i class="fa fa-check"></i><b>4.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="4.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-multilevel"><i class="fa fa-check"></i><b>4.2</b> Repeated measures data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-levels"><i class="fa fa-check"></i><b>4.2.1</b> Multilevel models and ‘levels’ of variation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-many-levels"><i class="fa fa-check"></i><b>4.3</b> Representing predictors with many levels</a></li>
<li class="chapter" data-level="4.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-strategies"><i class="fa fa-check"></i><b>4.4</b> Strategies for estimating factors with many levels</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-complete-pooling"><i class="fa fa-check"></i><b>4.4.1</b> Complete pooling</a></li>
<li class="chapter" data-level="4.4.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-no-pooling"><i class="fa fa-check"></i><b>4.4.2</b> No pooling</a></li>
<li class="chapter" data-level="4.4.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-partial-pooling"><i class="fa fa-check"></i><b>4.4.3</b> (Adaptive) Partial pooling</a></li>
<li class="chapter" data-level="4.4.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#hyperpriors"><i class="fa fa-check"></i><b>4.4.4</b> Hyperpriors</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-estimating1"><i class="fa fa-check"></i><b>4.5</b> Estimating a multilevel model with <code>brms</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-data-and-qs-1"><i class="fa fa-check"></i><b>4.5.1</b> Data and Research questions</a></li>
<li class="chapter" data-level="4.5.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#description-of-the-model"><i class="fa fa-check"></i><b>4.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="4.5.3" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-fitting-1"><i class="fa fa-check"></i><b>4.5.3</b> Fitting the model</a></li>
<li class="chapter" data-level="4.5.4" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#interpreting-the-model"><i class="fa fa-check"></i><b>4.5.4</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-random-effects"><i class="fa fa-check"></i><b>4.6</b> ‘Random’ Effects</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-inspecting-random-effects"><i class="fa fa-check"></i><b>4.6.1</b> Inspecting the random effects</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-simulating"><i class="fa fa-check"></i><b>4.7</b> Simulating data using our model parameters</a></li>
<li class="chapter" data-level="4.8" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-second-random-effect"><i class="fa fa-check"></i><b>4.8</b> Adding a second random effect</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-updating-model"><i class="fa fa-check"></i><b>4.8.1</b> Updating the model description</a></li>
<li class="chapter" data-level="4.8.2" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#fitting-and-interpreting-the-model"><i class="fa fa-check"></i><b>4.8.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-investigating-shrinkage"><i class="fa fa-check"></i><b>4.9</b> Investigating ‘shrinkage’</a></li>
<li class="chapter" data-level="4.10" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-answering-question"><i class="fa fa-check"></i><b>4.10</b> Answering our research questions</a></li>
<li class="chapter" data-level="4.11" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-frequentist"><i class="fa fa-check"></i><b>4.11</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-vs-lmer"><i class="fa fa-check"></i><b>4.11.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#exercises-3"><i class="fa fa-check"></i><b>4.12</b> Exercises</a></li>
<li class="chapter" data-level="4.13" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#references-2"><i class="fa fa-check"></i><b>4.13</b> References</a></li>
<li class="chapter" data-level="4.14" data-path="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html"><a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#plot-code-3"><i class="fa fa-check"></i><b>4.14</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html"><i class="fa fa-check"></i><b>5</b> Comparing two groups of observations: Factors and contrasts</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#chapter-pre-cap-4"><i class="fa fa-check"></i><b>5.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#comparing-two-groups"><i class="fa fa-check"></i><b>5.2</b> Comparing two groups</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#distribution-of-repeated-measures-across-factor-levels"><i class="fa fa-check"></i><b>5.3</b> Distribution of repeated measures across factor levels</a></li>
<li class="chapter" data-level="5.4" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-data-and-qs"><i class="fa fa-check"></i><b>5.4</b> Data and research questions</a></li>
<li class="chapter" data-level="5.5" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-two-means"><i class="fa fa-check"></i><b>5.5</b> Estimating the difference between two means with ‘brms’</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-the-model"><i class="fa fa-check"></i><b>5.5.1</b> Fitting the model</a></li>
<li class="chapter" data-level="5.5.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#interpreting-the-model-1"><i class="fa fa-check"></i><b>5.5.2</b> Interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-contrasts"><i class="fa fa-check"></i><b>5.6</b> Contrasts</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-treatment-coding"><i class="fa fa-check"></i><b>5.6.1</b> Treatment coding</a></li>
<li class="chapter" data-level="5.6.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-sum-coding"><i class="fa fa-check"></i><b>5.6.2</b> Sum coding</a></li>
<li class="chapter" data-level="5.6.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-comparison-sum-treatment"><i class="fa fa-check"></i><b>5.6.3</b> Comparison of sum and treatment coding</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-refittin-sum"><i class="fa fa-check"></i><b>5.7</b> Sum coding and the decomposition of variation</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-description-1"><i class="fa fa-check"></i><b>5.7.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.7.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-the-model-1"><i class="fa fa-check"></i><b>5.7.2</b> Fitting the model</a></li>
<li class="chapter" data-level="5.7.3" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#comparison-of-sum-and-treatment-coding"><i class="fa fa-check"></i><b>5.7.3</b> Comparison of sum and treatment coding</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-working-with-posteriors"><i class="fa fa-check"></i><b>5.8</b> Inspecting and manipulating the posterior samples</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-using-hypothesis"><i class="fa fa-check"></i><b>5.8.1</b> Using the <em>hypothesis</em> function</a></li>
<li class="chapter" data-level="5.8.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-manipulating-random-effects"><i class="fa fa-check"></i><b>5.8.2</b> Working with the random effects</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-robustness"><i class="fa fa-check"></i><b>5.9</b> Making our models more robust: The (non-standardized) t distribution</a></li>
<li class="chapter" data-level="5.10" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#re-fitting-with-t-distributed-errors."><i class="fa fa-check"></i><b>5.10</b> Re-fitting with t-distributed errors</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#description-of-the-model-1"><i class="fa fa-check"></i><b>5.10.1</b> Description of the model</a></li>
<li class="chapter" data-level="5.10.2" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#fitting-and-interpreting-the-model-1"><i class="fa fa-check"></i><b>5.10.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-simulating"><i class="fa fa-check"></i><b>5.11</b> Simulating the two-group model</a></li>
<li class="chapter" data-level="5.12" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-answering-qs"><i class="fa fa-check"></i><b>5.12</b> Answering our research questions</a></li>
<li class="chapter" data-level="5.13" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-frequentist"><i class="fa fa-check"></i><b>5.13</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#bayesian-multilevel-models-vs.-lmer"><i class="fa fa-check"></i><b>5.13.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#exercises-4"><i class="fa fa-check"></i><b>5.14</b> Exercises</a></li>
<li class="chapter" data-level="5.15" data-path="comparing-two-groups-of-observations-factors-and-contrasts.html"><a href="comparing-two-groups-of-observations-factors-and-contrasts.html#plot-code-4"><i class="fa fa-check"></i><b>5.15</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html"><i class="fa fa-check"></i><b>6</b> Variation in parameters (‘random effects’) and model comparison</a>
<ul>
<li class="chapter" data-level="6.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#chapter-pre-cap-5"><i class="fa fa-check"></i><b>6.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="6.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-data-and-qs"><i class="fa fa-check"></i><b>6.2</b> Data and research questions</a></li>
<li class="chapter" data-level="6.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-variation-sources"><i class="fa fa-check"></i><b>6.3</b> Variation in parameters across sources of data</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#description-of-our-model"><i class="fa fa-check"></i><b>6.3.1</b> Description of our model</a></li>
<li class="chapter" data-level="6.3.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-correlations"><i class="fa fa-check"></i><b>6.3.2</b> Correlations between random parameters</a></li>
<li class="chapter" data-level="6.3.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-random-and-mvn"><i class="fa fa-check"></i><b>6.3.3</b> Random effects and the multivariate normal distribution</a></li>
<li class="chapter" data-level="6.3.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-mvn-priors"><i class="fa fa-check"></i><b>6.3.4</b> Specifying priors for a multivariate normal distribution</a></li>
<li class="chapter" data-level="6.3.5" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#updating-our-model-description"><i class="fa fa-check"></i><b>6.3.5</b> Updating our model description</a></li>
<li class="chapter" data-level="6.3.6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-fitting"><i class="fa fa-check"></i><b>6.3.6</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-model-comparison"><i class="fa fa-check"></i><b>6.4</b> Model Comparison</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-in-and-out-prediction"><i class="fa fa-check"></i><b>6.4.1</b> In-sample and out-of-sample prediction</a></li>
<li class="chapter" data-level="6.4.2" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-out-sample-adjust"><i class="fa fa-check"></i><b>6.4.2</b> Out-of-sample prediction: Adjusting predictive accuracy</a></li>
<li class="chapter" data-level="6.4.3" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-out-sample-crossval"><i class="fa fa-check"></i><b>6.4.3</b> Out-of-sample prediction: Cross validation</a></li>
<li class="chapter" data-level="6.4.4" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#selecting-a-model"><i class="fa fa-check"></i><b>6.4.4</b> Selecting a model</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-answering"><i class="fa fa-check"></i><b>6.5</b> Answering our research questions</a></li>
<li class="chapter" data-level="6.6" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-frequentist"><i class="fa fa-check"></i><b>6.6</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-vs-lmer"><i class="fa fa-check"></i><b>6.6.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#exercises-5"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
<li class="chapter" data-level="6.8" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#references-3"><i class="fa fa-check"></i><b>6.8</b> References</a></li>
<li class="chapter" data-level="6.9" data-path="variation-in-parameters-random-effects-and-model-comparison.html"><a href="variation-in-parameters-random-effects-and-model-comparison.html#plot-code-5"><i class="fa fa-check"></i><b>6.9</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><i class="fa fa-check"></i><b>7</b> Comparing many groups, interactions, and posterior predictive checks</a>
<ul>
<li class="chapter" data-level="7.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#chapter-pre-cap-6"><i class="fa fa-check"></i><b>7.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="7.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#comparing-four-or-any-number-of-groups"><i class="fa fa-check"></i><b>7.2</b> Comparing four (or any number of) groups</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions"><i class="fa fa-check"></i><b>7.2.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.2.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-description-1"><i class="fa fa-check"></i><b>7.2.2</b> Description of our model</a></li>
<li class="chapter" data-level="7.2.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-2"><i class="fa fa-check"></i><b>7.2.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#investigating-multiple-factors-simultaneously"><i class="fa fa-check"></i><b>7.3</b> Investigating multiple factors simultaneously</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions-1"><i class="fa fa-check"></i><b>7.3.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.3.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#description-of-the-model-2"><i class="fa fa-check"></i><b>7.3.2</b> Description of the model</a></li>
<li class="chapter" data-level="7.3.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-3"><i class="fa fa-check"></i><b>7.3.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-posterior-prediction"><i class="fa fa-check"></i><b>7.4</b> Posterior prediction: Using our models to predict new data</a></li>
<li class="chapter" data-level="7.5" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-interactions-and-plots"><i class="fa fa-check"></i><b>7.5</b> Interactions and interaction plots</a></li>
<li class="chapter" data-level="7.6" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#investigating-interactions-with-a-model"><i class="fa fa-check"></i><b>7.6</b> Investigating interactions with a model</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#data-and-research-questions-2"><i class="fa fa-check"></i><b>7.6.1</b> Data and research questions</a></li>
<li class="chapter" data-level="7.6.2" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#model-formulas"><i class="fa fa-check"></i><b>7.6.2</b> Model formulas</a></li>
<li class="chapter" data-level="7.6.3" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#description-of-our-model-1"><i class="fa fa-check"></i><b>7.6.3</b> Description of our model</a></li>
<li class="chapter" data-level="7.6.4" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#fitting-and-interpreting-the-model-4"><i class="fa fa-check"></i><b>7.6.4</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="7.6.5" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-calc-means"><i class="fa fa-check"></i><b>7.6.5</b> Caulculating group means in the presence of interactions</a></li>
<li class="chapter" data-level="7.6.6" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#calculating-simple-effects-in-the-presence-of-interactions"><i class="fa fa-check"></i><b>7.6.6</b> Calculating simple effects in the presence of interactions</a></li>
<li class="chapter" data-level="7.6.7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#assessing-model-fit-bayesian-r2"><i class="fa fa-check"></i><b>7.6.7</b> Assessing model fit: Bayesian <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-answering"><i class="fa fa-check"></i><b>7.7</b> Answering our research questions</a></li>
<li class="chapter" data-level="7.8" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#factors-with-more-than-two-levels"><i class="fa fa-check"></i><b>7.8</b> Factors with more than two levels</a></li>
<li class="chapter" data-level="7.9" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-frequentist"><i class="fa fa-check"></i><b>7.9</b> ‘Traditionalists’ corner</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#bayesian-multilevel-models-vs.-lmer-1"><i class="fa fa-check"></i><b>7.9.1</b> Bayesian multilevel models vs. lmer</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#exercises-6"><i class="fa fa-check"></i><b>7.10</b> Exercises</a></li>
<li class="chapter" data-level="7.11" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#references-4"><i class="fa fa-check"></i><b>7.11</b> References</a></li>
<li class="chapter" data-level="7.12" data-path="comparing-many-groups-interactions-and-posterior-predictive-checks.html"><a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#plot-code-6"><i class="fa fa-check"></i><b>7.12</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html"><i class="fa fa-check"></i><b>8</b> Varying variances, more about priors, and prior predictive checks</a>
<ul>
<li class="chapter" data-level="8.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#chapter-pre-cap-7"><i class="fa fa-check"></i><b>8.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="8.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#data-and-research-questions-3"><i class="fa fa-check"></i><b>8.2</b> Data and Research questions</a></li>
<li class="chapter" data-level="8.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#more-about-priors"><i class="fa fa-check"></i><b>8.3</b> More about priors</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-prior-prediction"><i class="fa fa-check"></i><b>8.3.1</b> Prior predictive checks</a></li>
<li class="chapter" data-level="8.3.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#more-specific-priors"><i class="fa fa-check"></i><b>8.3.2</b> More specific priors</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#heteroskedasticity-and-distributional-or-mixture-models"><i class="fa fa-check"></i><b>8.4</b> Heteroskedasticity and distributional (or mixture) models</a></li>
<li class="chapter" data-level="8.5" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#a-simple-model-error-varies-according-to-a-single-fixed-effect"><i class="fa fa-check"></i><b>8.5</b> A ‘simple’ model: Error varies according to a single fixed effect</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#description-of-our-model-2"><i class="fa fa-check"></i><b>8.5.1</b> Description of our model</a></li>
<li class="chapter" data-level="8.5.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#prior-predictive-checks"><i class="fa fa-check"></i><b>8.5.2</b> Prior predictive checks</a></li>
<li class="chapter" data-level="8.5.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fitting-and-interpreting-the-model-5"><i class="fa fa-check"></i><b>8.5.3</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#a-complex-model-error-varies-according-to-fixed-and-random-effects"><i class="fa fa-check"></i><b>8.6</b> A ‘complex’ model: Error varies according to fixed and random effects</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-description-2"><i class="fa fa-check"></i><b>8.6.1</b> Description of our model</a></li>
<li class="chapter" data-level="8.6.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fitting-and-interpreting-the-model-6"><i class="fa fa-check"></i><b>8.6.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#answering-our-research-questions"><i class="fa fa-check"></i><b>8.7</b> Answering our research questions</a></li>
<li class="chapter" data-level="8.8" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-identifiability"><i class="fa fa-check"></i><b>8.8</b> Building identifiable and supportable models</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#collinearity"><i class="fa fa-check"></i><b>8.8.1</b> Collinearity</a></li>
<li class="chapter" data-level="8.8.2" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#predictable-values-of-categorical-predictors"><i class="fa fa-check"></i><b>8.8.2</b> Predictable values of categorical predictors</a></li>
<li class="chapter" data-level="8.8.3" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#saturated-and-nearly-saturated-models"><i class="fa fa-check"></i><b>8.8.3</b> Saturated, and ‘nearly-saturated’, models</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#exercises-7"><i class="fa fa-check"></i><b>8.9</b> Exercises</a></li>
<li class="chapter" data-level="8.10" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#references-5"><i class="fa fa-check"></i><b>8.10</b> References</a></li>
<li class="chapter" data-level="8.11" data-path="varying-variances-more-about-priors-and-prior-predictive-checks.html"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#plot-code-7"><i class="fa fa-check"></i><b>8.11</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html"><i class="fa fa-check"></i><b>9</b> Quantitative predictors and their interactions with factors</a>
<ul>
<li class="chapter" data-level="9.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#chapter-pre-cap-8"><i class="fa fa-check"></i><b>9.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="9.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#data-and-research-questions-4"><i class="fa fa-check"></i><b>9.2</b> Data and research questions</a></li>
<li class="chapter" data-level="9.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#modeling-variation-along-lines"><i class="fa fa-check"></i><b>9.3</b> Modeling variation along lines</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-3"><i class="fa fa-check"></i><b>9.3.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.3.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-centering"><i class="fa fa-check"></i><b>9.3.2</b> Centering quantitative predictors</a></li>
<li class="chapter" data-level="9.3.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-an-interpreting-the-model"><i class="fa fa-check"></i><b>9.3.3</b> Fitting an interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-group-dependent-intercepts-but-shared-slopes"><i class="fa fa-check"></i><b>9.4</b> Models with group-dependent intercepts, but shared slopes</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-4"><i class="fa fa-check"></i><b>9.4.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.4.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-and-interpreting-the-model-7"><i class="fa fa-check"></i><b>9.4.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.4.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#interpreting-group-effects-in-the-presence-of-shared-non-zero-slopes"><i class="fa fa-check"></i><b>9.4.3</b> Interpreting group effects in the presence of shared (non-zero) slopes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-group-dependent-slopes-and-intercepts"><i class="fa fa-check"></i><b>9.5</b> Models with group-dependent slopes and intercepts</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-5"><i class="fa fa-check"></i><b>9.5.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.5.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-fitting-3"><i class="fa fa-check"></i><b>9.5.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.5.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#interpreting-group-effects-in-the-presence-of-varying-slopes"><i class="fa fa-check"></i><b>9.5.3</b> Interpreting group effects in the presence of varying slopes</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#answering-our-research-questions-interim-discussion"><i class="fa fa-check"></i><b>9.6</b> Answering our research questions: Interim discussion</a></li>
<li class="chapter" data-level="9.7" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#data-and-research-questions-updated"><i class="fa fa-check"></i><b>9.7</b> Data and research questions: Updated</a></li>
<li class="chapter" data-level="9.8" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-intercepts-and-slopes-for-each-level-of-a-grouping-factor-i.e.-random-slopes"><i class="fa fa-check"></i><b>9.8</b> Models with intercepts and slopes for each level of a grouping factor (i.e. ‘random slopes’)</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-6"><i class="fa fa-check"></i><b>9.8.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.8.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#fitting-and-interpreting-the-model-8"><i class="fa fa-check"></i><b>9.8.2</b> Fitting and interpreting the model</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#models-with-multiple-predictors-for-each-level-of-a-grouping-factor"><i class="fa fa-check"></i><b>9.9</b> Models with multiple predictors for each level of a grouping factor</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#description-of-the-model-7"><i class="fa fa-check"></i><b>9.9.1</b> Description of the model</a></li>
<li class="chapter" data-level="9.9.2" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#c9-fitting-5"><i class="fa fa-check"></i><b>9.9.2</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="9.9.3" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#model-selection"><i class="fa fa-check"></i><b>9.9.3</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#answering-our-research-questions-updated"><i class="fa fa-check"></i><b>9.10</b> Answering our research questions: Updated</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#a-word-on-causality"><i class="fa fa-check"></i><b>9.10.1</b> A word on causality</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#exercises-8"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
<li class="chapter" data-level="9.12" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#references-6"><i class="fa fa-check"></i><b>9.12</b> References</a></li>
<li class="chapter" data-level="9.13" data-path="quantitative-predictors-and-their-interactions-with-factors.html"><a href="quantitative-predictors-and-their-interactions-with-factors.html#plot-code-8"><i class="fa fa-check"></i><b>9.13</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html"><i class="fa fa-check"></i><b>10</b> Logistic regression and signal detection theory models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#chapter-pre-cap-9"><i class="fa fa-check"></i><b>10.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="10.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-dichotomous"><i class="fa fa-check"></i><b>10.2</b> Dichotomous variables and data</a></li>
<li class="chapter" data-level="10.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#generalizing-our-linear-models"><i class="fa fa-check"></i><b>10.3</b> Generalizing our linear models</a></li>
<li class="chapter" data-level="10.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logistic-regression"><i class="fa fa-check"></i><b>10.4</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logits"><i class="fa fa-check"></i><b>10.4.1</b> Logits</a></li>
<li class="chapter" data-level="10.4.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-inverse-logit"><i class="fa fa-check"></i><b>10.4.2</b> The inverse logit link function</a></li>
<li class="chapter" data-level="10.4.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#building-intuitions-about-logits-and-the-inverse-logit-function"><i class="fa fa-check"></i><b>10.4.3</b> Building intuitions about logits and the inverse logit function</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#logistic-regression-with-one-quantitative-predictor"><i class="fa fa-check"></i><b>10.5</b> Logistic regression with one quantitative predictor</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#data-and-research-questions-5"><i class="fa fa-check"></i><b>10.5.1</b> Data and research questions</a></li>
<li class="chapter" data-level="10.5.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#description-of-the-model-8"><i class="fa fa-check"></i><b>10.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="10.5.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-fitting-0"><i class="fa fa-check"></i><b>10.5.3</b> Fitting the model</a></li>
<li class="chapter" data-level="10.5.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-fitting-1"><i class="fa fa-check"></i><b>10.5.4</b> Interpreting the model</a></li>
<li class="chapter" data-level="10.5.5" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#c10-classification"><i class="fa fa-check"></i><b>10.5.5</b> Using logistic models to understand classification</a></li>
<li class="chapter" data-level="10.5.6" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#answering-our-research-question"><i class="fa fa-check"></i><b>10.5.6</b> Answering our research question</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#measuring-sensitivity-and-bias"><i class="fa fa-check"></i><b>10.6</b> Measuring sensitivity and bias</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#data-and-research-questions-6"><i class="fa fa-check"></i><b>10.6.1</b> Data and research questions</a></li>
<li class="chapter" data-level="10.6.2" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#description-of-the-model-9"><i class="fa fa-check"></i><b>10.6.2</b> Description of the model</a></li>
<li class="chapter" data-level="10.6.3" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#fitting-and-interpreting-the-model-9"><i class="fa fa-check"></i><b>10.6.3</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="10.6.4" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#answering-our-research-questions-1"><i class="fa fa-check"></i><b>10.6.4</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#exercises-9"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
<li class="chapter" data-level="10.8" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#references-7"><i class="fa fa-check"></i><b>10.8</b> References</a></li>
<li class="chapter" data-level="10.9" data-path="logistic-regression-and-signal-detection-theory-models.html"><a href="logistic-regression-and-signal-detection-theory-models.html#plot-code-9"><i class="fa fa-check"></i><b>10.9</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><i class="fa fa-check"></i><b>11</b> Multiple quantitative predictors, dealing with large models, and Bayesian ANOVA</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#chapter-pre-cap-10"><i class="fa fa-check"></i><b>11.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="11.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#models-with-multiple-quantitative-predictors"><i class="fa fa-check"></i><b>11.2</b> Models with multiple quantitative predictors</a></li>
<li class="chapter" data-level="11.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#interactions-between-quantitative-predictors"><i class="fa fa-check"></i><b>11.3</b> Interactions between quantitative predictors</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#centering-quantitative-predictors-when-including-interactions"><i class="fa fa-check"></i><b>11.3.1</b> Centering quantitative predictors when including interactions</a></li>
<li class="chapter" data-level="11.3.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#data-and-research-questions-7"><i class="fa fa-check"></i><b>11.3.2</b> Data and research questions</a></li>
<li class="chapter" data-level="11.3.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c11-description-1"><i class="fa fa-check"></i><b>11.3.3</b> Description of the model</a></li>
<li class="chapter" data-level="11.3.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-the-model-2"><i class="fa fa-check"></i><b>11.3.4</b> Fitting the model</a></li>
<li class="chapter" data-level="11.3.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#advantages-of-bayesian-multilevel-models-for-large-models"><i class="fa fa-check"></i><b>11.3.5</b> Advantages of Bayesian multilevel models for large models</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c11-BANOVA"><i class="fa fa-check"></i><b>11.4</b> Bayesian Analysis of Variance</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#getting-the-standard-deviations-from-our-models-manually"><i class="fa fa-check"></i><b>11.4.1</b> Getting the standard deviations from our models ‘manually’</a></li>
<li class="chapter" data-level="11.4.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#using-the-banova-function"><i class="fa fa-check"></i><b>11.4.2</b> Using the <code>banova</code> function</a></li>
<li class="chapter" data-level="11.4.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-and-comparing-the-reduced-model"><i class="fa fa-check"></i><b>11.4.3</b> Fitting and comparing the reduced model</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#a-logistic-regression-model-with-multiple-quantitative-predictors"><i class="fa fa-check"></i><b>11.5</b> A logistic regression model with multiple quantitative predictors</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#data-and-research-questions-8"><i class="fa fa-check"></i><b>11.5.1</b> Data and research questions</a></li>
<li class="chapter" data-level="11.5.2" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#description-of-the-model-10"><i class="fa fa-check"></i><b>11.5.2</b> Description of the model</a></li>
<li class="chapter" data-level="11.5.3" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#fitting-and-the-model-and-applying-a-bayesian-anova"><i class="fa fa-check"></i><b>11.5.3</b> Fitting and the model and applying a Bayesian ANOVA</a></li>
<li class="chapter" data-level="11.5.4" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#c12-2d-categorization"><i class="fa fa-check"></i><b>11.5.4</b> Categorization in two dimensions</a></li>
<li class="chapter" data-level="11.5.5" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#model-selection-and-misspecification"><i class="fa fa-check"></i><b>11.5.5</b> Model selection and misspecification</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#exercises-10"><i class="fa fa-check"></i><b>11.6</b> Exercises</a></li>
<li class="chapter" data-level="11.7" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#references-8"><i class="fa fa-check"></i><b>11.7</b> References</a></li>
<li class="chapter" data-level="11.8" data-path="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html"><a href="multiple-quantitative-predictors-dealing-with-large-models-and-bayesian-anova.html#plot-code-10"><i class="fa fa-check"></i><b>11.8</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html"><i class="fa fa-check"></i><b>12</b> Multinomial and Ordinal regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#chapter-pre-cap-11"><i class="fa fa-check"></i><b>12.1</b> Chapter pre-cap</a></li>
<li class="chapter" data-level="12.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>12.2</b> Multinomial logistic regression</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#multinomial-logits-and-the-softmax-function"><i class="fa fa-check"></i><b>12.2.1</b> Multinomial logits and the softmax function</a></li>
<li class="chapter" data-level="12.2.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#comparison-to-logistic-regression"><i class="fa fa-check"></i><b>12.2.2</b> Comparison to logistic regression</a></li>
<li class="chapter" data-level="12.2.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#data-and-research-questions-9"><i class="fa fa-check"></i><b>12.2.3</b> Data and research questions</a></li>
<li class="chapter" data-level="12.2.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#description-of-our-model-3"><i class="fa fa-check"></i><b>12.2.4</b> Description of our model</a></li>
<li class="chapter" data-level="12.2.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#fitting-the-model-3"><i class="fa fa-check"></i><b>12.2.5</b> Fitting the model</a></li>
<li class="chapter" data-level="12.2.6" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#interpreting-the-model-2"><i class="fa fa-check"></i><b>12.2.6</b> Interpreting the model</a></li>
<li class="chapter" data-level="12.2.7" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#c12-multinomial-territorial-maps"><i class="fa fa-check"></i><b>12.2.7</b> Multinomial models and territorial maps</a></li>
<li class="chapter" data-level="12.2.8" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#refitting-the-model-without-speaker-random-effects"><i class="fa fa-check"></i><b>12.2.8</b> Refitting the model without speaker random effects</a></li>
<li class="chapter" data-level="12.2.9" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#answering-our-research-questions-2"><i class="fa fa-check"></i><b>12.2.9</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#ordinal-logistic-regression"><i class="fa fa-check"></i><b>12.3</b> Ordinal (logistic) regression</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#c12-cumulative-density"><i class="fa fa-check"></i><b>12.3.1</b> Cumulative distribution functions</a></li>
<li class="chapter" data-level="12.3.2" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#data-and-research-questions-10"><i class="fa fa-check"></i><b>12.3.2</b> Data and research questions</a></li>
<li class="chapter" data-level="12.3.3" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#description-of-the-model-11"><i class="fa fa-check"></i><b>12.3.3</b> Description of the model</a></li>
<li class="chapter" data-level="12.3.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#fitting-and-interpreting-the-model-10"><i class="fa fa-check"></i><b>12.3.4</b> Fitting and interpreting the model</a></li>
<li class="chapter" data-level="12.3.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#listener-specific-discrimination-terms"><i class="fa fa-check"></i><b>12.3.5</b> Listener-specific discrimination terms</a></li>
<li class="chapter" data-level="12.3.6" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#answering-our-research-questions-3"><i class="fa fa-check"></i><b>12.3.6</b> Answering our research questions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#exercises-11"><i class="fa fa-check"></i><b>12.4</b> Exercises</a></li>
<li class="chapter" data-level="12.5" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#references-9"><i class="fa fa-check"></i><b>12.5</b> References</a></li>
<li class="chapter" data-level="12.6" data-path="multinomial-and-ordinal-regression.html"><a href="multinomial-and-ordinal-regression.html#plot-code-11"><i class="fa fa-check"></i><b>12.6</b> Plot Code</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><i class="fa fa-check"></i><b>13</b> Writing up experiments: An investigation of the perception of apparent speaker characteristics from speech acoustics</a>
<ul>
<li class="chapter" data-level="13.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#introduction"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#fundamental-frequency-and-voice-pitch"><i class="fa fa-check"></i><b>13.1.1</b> Fundamental frequency and voice pitch</a></li>
<li class="chapter" data-level="13.1.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#variation-in-fundamental-frequency-between-speakers"><i class="fa fa-check"></i><b>13.1.2</b> Variation in fundamental frequency between speakers</a></li>
<li class="chapter" data-level="13.1.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#voice-resonance-and-vocal-tract-length"><i class="fa fa-check"></i><b>13.1.3</b> Voice resonance and vocal-tract length</a></li>
<li class="chapter" data-level="13.1.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-estimating-vtl"><i class="fa fa-check"></i><b>13.1.4</b> Estimating vocal-tracts length from speech</a></li>
<li class="chapter" data-level="13.1.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#variation-in-vocal-tract-length-between-speakers"><i class="fa fa-check"></i><b>13.1.5</b> Variation in vocal-tract length between speakers</a></li>
<li class="chapter" data-level="13.1.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-perception-of-chars"><i class="fa fa-check"></i><b>13.1.6</b> Perception of age, gender and size</a></li>
<li class="chapter" data-level="13.1.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#category-dependent-behavior"><i class="fa fa-check"></i><b>13.1.7</b> Category-dependent behavior</a></li>
<li class="chapter" data-level="13.1.8" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#the-current-experiment"><i class="fa fa-check"></i><b>13.1.8</b> The current experiment</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#methods"><i class="fa fa-check"></i><b>13.2</b> Methods</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#participants"><i class="fa fa-check"></i><b>13.2.1</b> Participants</a></li>
<li class="chapter" data-level="13.2.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#c13-stimuli"><i class="fa fa-check"></i><b>13.2.2</b> Stimuli</a></li>
<li class="chapter" data-level="13.2.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#procedure"><i class="fa fa-check"></i><b>13.2.3</b> Procedure</a></li>
<li class="chapter" data-level="13.2.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#data-screening"><i class="fa fa-check"></i><b>13.2.4</b> Data screening</a></li>
<li class="chapter" data-level="13.2.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#loading-the-data-and-packages"><i class="fa fa-check"></i><b>13.2.5</b> Loading the data and packages</a></li>
<li class="chapter" data-level="13.2.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#statistical-analysis-apparent-height"><i class="fa fa-check"></i><b>13.2.6</b> Statistical Analysis: Apparent height</a></li>
<li class="chapter" data-level="13.2.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#statistical-analysis-apparent-gender"><i class="fa fa-check"></i><b>13.2.7</b> Statistical Analysis: Apparent gender</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#results-apparent-height-judgments"><i class="fa fa-check"></i><b>13.3</b> Results: Apparent height judgments</a></li>
<li class="chapter" data-level="13.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#discussion-apparent-height"><i class="fa fa-check"></i><b>13.4</b> Discussion: Apparent height</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#age-dependent-use-of-vtl-cues-on-apparent-height"><i class="fa fa-check"></i><b>13.4.1</b> Age-dependent use of VTL cues on apparent height</a></li>
<li class="chapter" data-level="13.4.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#the-effect-for-apparent-gender-on-apparent-height"><i class="fa fa-check"></i><b>13.4.2</b> The effect for apparent gender on apparent height</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#conclusion-apparent-height-judgments"><i class="fa fa-check"></i><b>13.5</b> Conclusion: Apparent height judgments</a></li>
<li class="chapter" data-level="13.6" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#results-apparent-gender-judgments"><i class="fa fa-check"></i><b>13.6</b> Results: Apparent gender judgments</a></li>
<li class="chapter" data-level="13.7" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#discussion-apparent-gender-judgments"><i class="fa fa-check"></i><b>13.7</b> Discussion: Apparent gender judgments</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#effect-of-apparent-age-on-the-perception-of-femaleness"><i class="fa fa-check"></i><b>13.7.1</b> Effect of apparent age on the perception of femaleness</a></li>
<li class="chapter" data-level="13.7.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#between-listener-variation-in-gender-perception"><i class="fa fa-check"></i><b>13.7.2</b> Between-listener variation in gender perception</a></li>
<li class="chapter" data-level="13.7.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#beyond-gross-acoustic-cues-in-gender-perception"><i class="fa fa-check"></i><b>13.7.3</b> Beyond gross acoustic cues in gender perception</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#conclusion-apparent-gender"><i class="fa fa-check"></i><b>13.8</b> Conclusion: Apparent gender</a></li>
<li class="chapter" data-level="13.9" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#next-steps"><i class="fa fa-check"></i><b>13.9</b> Next steps</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#research-design-variable-selection-etc."><i class="fa fa-check"></i><b>13.9.1</b> Research design, variable selection, etc.</a></li>
<li class="chapter" data-level="13.9.2" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#non-linear-models"><i class="fa fa-check"></i><b>13.9.2</b> Non-linear models</a></li>
<li class="chapter" data-level="13.9.3" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#other-data-distributions"><i class="fa fa-check"></i><b>13.9.3</b> Other data distributions</a></li>
<li class="chapter" data-level="13.9.4" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#multivariate-analyses"><i class="fa fa-check"></i><b>13.9.4</b> Multivariate analyses</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#references-10"><i class="fa fa-check"></i><b>13.10</b> References</a></li>
<li class="chapter" data-level="13.11" data-path="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html"><a href="writing-up-experiments-an-investigation-of-the-perception-of-apparent-speaker-characteristics-from-speech-acoustics.html#plot-code-12"><i class="fa fa-check"></i><b>13.11</b> Plot Code</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/santiagobarreda/bmmrmd" target="blank">Book GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian multilevel models for repeated-measures data: A conceptual and practical introduction in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="varying-variances-more-about-priors-and-prior-predictive-checks" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Varying variances, more about priors, and prior predictive checks<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#varying-variances-more-about-priors-and-prior-predictive-checks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>So far our models have been a bit ‘old-fashioned’ in one important way: They have featured a single error term (<span class="math inline">\(\sigma\)</span>) for all of our observations. This means that <span class="math inline">\(\sigma\)</span> is the same for all speakers, listeners, and conditions in our experiment. However, we might imagine a situation where one listener’s responses (and residuals) are more widely distributed than another, resulting in a situation where, for example, <span class="math inline">\(\sigma_{[\mathsf{L}_{[i]}=1]} \neq \sigma_{[\mathsf{L}_{[j]}=2]}\)</span> for observations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> contributed by listeners one and two. In such a situation, we may not want to use a single value of <span class="math inline">\(\sigma\)</span> for all listeners and may instead prefer to use a different value for each listener, e.g. <span class="math inline">\(\sigma_{[i]}\)</span> for listener <span class="math inline">\(i\)</span>. In this chapter we’re going to discuss models that allow for more variation in their <span class="math inline">\(\sigma\)</span> parameters. In addition, we’re going to go into more detail about setting priors for our models, and the use of prior predictive checks.</p>
<div id="chapter-pre-cap-7" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Chapter pre-cap<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#chapter-pre-cap-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter we introduce prior predictive checks, and talk about the importance of these for model building. Then, examples of the results of different prior settings for models are provided. After that we discuss how to specify more specific prior probabilities for individual model parameters. We then introduce heteroscedastic models, that is, models with error terms that vary from observation to observation. First, we present a ‘simple’ model that includes only variation in the error term across two conditions. Following that, we present a ‘complex’ model that features listener-dependent error terms fit using shrinkage, in addition to the equivalent of listener ‘random effects’ for the error term. Finally, we discuss building identifiable models, and models supported by the available data, and describe the problems of collinearity, linear dependance, and saturated models.</p>
</div>
<div id="data-and-research-questions-3" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Data and Research questions<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#data-and-research-questions-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below we load the data for our experiment investigating apparent speaker height, in addition to the <code>brms</code> and <code>bmmb</code> packages.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (brms)</span>
<span id="cb279-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (bmmb)</span>
<span id="cb279-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span> (exp_data)</span>
<span id="cb279-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb279-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&#39;contr.sum&#39;</span>,<span class="st">&#39;contr.sum&#39;</span>))</span></code></pre></div>
<p>The models we will consider below use the following variables from our data frame:</p>
<ul>
<li><code>L</code>: A number from 1-15 indicating which <em>listener</em> responded to the trial.</li>
<li><code>height</code>: A number representing the <em>height</em> (in centimeters) reported for the speaker on each trial.</li>
<li><code>S</code>: A number from 1-139 indicating which <em>speaker</em> produced the trial stimulus.</li>
<li><code>G</code>: The <em>apparent gender</em> of the speaker indicated by the listener, <code>f</code> (female) or <code>m</code> (male).</li>
<li><code>A</code>: The <em>apparent age</em> of the speaker indicated by the listener, <code>a</code> (adult) or <code>c</code> (child).</li>
</ul>
<p>We’re going to use models whose structure is similar to the final model we fit in chapter 7 (<code>model_interaction</code>). However, in this chapter we’re going to focus on questions related to variation in our standard deviation parameters. We would like to know three things:</p>
<p>(Q1) Does our error standard deviation vary as a function of apparent speaker age?</p>
<p>(Q2) Does our error standard deviation vary as a function of listener?</p>
</div>
<div id="more-about-priors" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> More about priors<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#more-about-priors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To this point our focus has been on understanding the components that make up our models, and how these are represented using our model parameters. Now that we’ve covered most of the essentials of using categorical predictors, we can focus a bit more on the prior distributions of the parameters in our models. The reason we’ve been able to get away with not talking about priors very much is that we have substantial <strong>domain knowledge</strong> regarding the distribution of human height as a function of age and gender. In addition, our models thus far have been fairly simple, making the consideration of prior distributions relatively straightforward.</p>
<p>For example, we will lay out some expected coefficient values based on the assumption that apparent height basically corresponds to veridical height, on average. Based on the information in <code>height_data</code>, we know that 11 year-old boys and girls are about 150 cm tall, and women and men are 163 and 176 cm tall respectively, on average. This means that there is a difference of 19.5 cm ((13+26)/2) on average between adults and children between 11 and 12 years of age. A difference of 19.5 cm between age groups suggests about a 10 cm distance (half the group difference) between each age group and the overall intercept. In other words, if apparent height is similar to veridical height, we expect an apparent age (<span class="math inline">\(A\)</span>) predictor of about 10 cm in magnitude given sum coding. In contrast, we have an expected height difference of 0 cm across genders for children, and 12 cm across genders for adults. This is an average difference of 6 cm between males and females across both ages. As a result, we expect an effect of about 3 cm for gender averaged across ages. Based on this, our prior standard deviation of 12 cm for our <code>b</code> (fixed-effects) parameters seems very reasonable, although perhaps a bit large for some effects.</p>
<p>Are they <em>too</em> large? An effect of 12 cm is reasonable for something related to human height. If we were astronomers, our priors might be on the order of 12 light-years rather than cm, where a light year is equal to <span class="math inline">\(9.461 \cdot 10^{17}\)</span> cm. If we were studying variation in the size of E. coli bacteria, our priors might be on the order of 0.2 micrometers, or about <span class="math inline">\(2 \cdot 10^{-5}\)</span> cm. When viewed from this perspective, worrying about a prior of 12 cm vs. 6 cm is less important than providing your model with information about the general magnitude of variation it can expect in your data and in parameter estimates. Furthermore, in many situations involving repeated measures data, you will have so many observations that slight differences in the settings of the prior will not have any noticeable effect on the posterior distributions of the model parameters (see figure <a href="fitting-bayesian-regression-models-with-brms.html#fig:F3-1">3.1</a>). This fact makes arguments regarding which prior is ‘better’ in many situations more <em>philosophical</em> than <em>practical</em>. That being said, it is still useful and important to provide priors that conform to plausible ranges of expected parameter values.</p>
<p>As we noted above, this is generally straightforward for our experiment involving the perception of apparent height. However, imagine a situation where there was less certainty about reasonable values for our priors. This can happen for many reasons. For example, imagine you carry out a lexical decision task where participants listen to a combination of ‘real’ (e.g., ‘map’) and ‘fake’ words (e.g., ‘marp’) and have to decide if the word they heard is ‘real’ or not. You divide your real words into 5 groups based on a numerical measure of their frequency (how often they tend to appear in speech). To complicate matters further, you see that your reaction times are heavily skewed and so decide to model the logarithm of the reaction times. What should your priors be for your frequency groups? The prior distribution of a parameter represents the expected distribution of your parameters <em>a priori</em>. So what do we think are reasonable group differences in this situation? Even in this relatively simple case, setting prior distributions using only your intuitions would require understanding plausible variation in the <em>logarithm</em> of reaction times across word groups. This may not be realistic in this situation nor in many others.</p>
<div id="c8-prior-prediction" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Prior predictive checks<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-prior-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>prior predictive check</strong> can help understand the consequences of the prior distributions of our parameters, especially in situations where they are otherwise difficult to understand. The prior predictive check consists of generating fake data (i.e., <span class="math inline">\(\tilde{y}\)</span>) based on linear predictors (i.e. <span class="math inline">\(\mu\)</span>) simulated by sampling <em>only</em> from the prior. Conceptually, this is very similar to a posterior predictive check (discussed in section <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-posterior-prediction">7.4</a>), save for the fact that prior predictive checks are not influenced by the model likelihood (or the data). To carry out a prior predictive check using <code>brms</code> you fit your model in the same way you normally would, except for setting <code>sample_prior="only"</code>. When you do this, your model knows to generate parameter estimates and expected values (e.g., <span class="math inline">\(\mu\)</span>) based only on the prior distributions of the model parameters.</p>
<p>Below we fit <code>model_interaction</code> from chapter 7 again, except this time we sample only from the prior. Imagine that we did not have much knowledge about speaker heights other than that humans tend to be between 1 and 2 meters tall. Based on this we decided to be cautious and use relatively <em>uninformative</em> priors and set all prior standard deviations to 1000 cm (10 meters).</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb280-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,156, 1000)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb280-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-3" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 1000)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb280-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-4" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 1000)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb280-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-5" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (1000)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>), </span>
<span id="cb280-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-6" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 1000)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb280-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-8" aria-hidden="true" tabindex="-1"></a>prior_uninformative <span class="ot">=</span>  </span>
<span id="cb280-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-9" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G <span class="sc">+</span> (A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), </span>
<span id="cb280-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample_prior=</span><span class="st">&quot;only&quot;</span>, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb280-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb280-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">thin =</span> <span class="dv">4</span>, <span class="at">prior =</span> priors)</span></code></pre></div>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb281-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb281-2" aria-hidden="true" tabindex="-1"></a>prior_uninformative <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;8_prior_uninformative.RDS&#39;</span>)</span></code></pre></div>
<p>We can use the <code>predict</code> function to get the prior predictions made by our model.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb282-1" aria-hidden="true" tabindex="-1"></a>pp_uninformative <span class="ot">=</span> <span class="fu">predict</span> (prior_uninformative, <span class="at">summary =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>When we get ‘unsummarized’ predictions we get a prediction for each set of sampled parameters in our model. These predictions vary across samples by row and across data points by column. So, to get predictions for a single posterior sample we need to observe a single row of this matrix. This could be done using a histogram, as below:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span> (pp_uninformative[<span class="dv">1</span>,])</span></code></pre></div>
<p>However, the <code>bmmb</code> package has a simple function called <code>p_check</code> that can be used to consider the density of multiple samples at once. By default this compares 10 random predictions, however the number of predictions can be changed, and the user may also specify specific samples to consider.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb284-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">p_check</span> (pp_uninformative)</span></code></pre></div>
<p>In the left plot of figure <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fig:F8-1">8.1</a> we see the result of using <code>p_check</code> in ten random samples from our ‘uninformative’ prior prediction. As can be seen, our ‘cautious’ approach results in a range of simulated heights that make no sense even given our relatively limited prior knowledge, in this case that most humans are between 100 and 200 cm tall. In fact, our simulated data contains not only large negative values, which make no sense in the context of height, but also substantial values above 5000 cm, which is about the size of a 10-story office building.</p>
<div class="figure"><span style="display:block;" id="fig:F8-1"></span>
<img src="_main_files/figure-html/F8-1-1.jpeg" alt="Densities of 10 prior predictions of apparent height for the uninformative, mildly informative, and conservative priors." width="4800" />
<p class="caption">
Figure 8.1: Densities of 10 prior predictions of apparent height for the uninformative, mildly informative, and conservative priors.
</p>
</div>
<p>It is difficult to <em>prove</em> that such a wide prior is ‘bad’, and in fact some authors have recommended the use of very uninformative priors (Krushcke 2014). However, it’s difficult to deny that a prior that results in prior predictions that are more in line with our domain knowledge is generally better for at least two reasons. First, more informative priors can help the model converge on credible parameter values, especially for complicated models with many parameters. Second, more informative priors can help improve out-of-sample prediction by providing actual information about plausible parameter values for our model. Basically, no fancy statistical model is going to convince anyone that 50 meters tall is a plausible apparent height for human speakers because human speakers are simply not nearly that tall. As a result, a model that acts as if 50 meters is a plausible apparent height for human speakers is likely to offer worse out-of-sample prediction than a model that correctly assigns little to no prior belief to this range of apparent heights. For a more in-depth discussion on the role and function of prior probabilities in multilevel Bayesian models see Gelman et al. (2017).</p>
<p>Below we again sample from the prior using the setting we’ve been using so far, and that we used in the previous chapter.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb285-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,156, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb285-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-3" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb285-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-4" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb285-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-5" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>), </span>
<span id="cb285-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-6" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb285-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-8" aria-hidden="true" tabindex="-1"></a>prior_mildly_informative <span class="ot">=</span>  </span>
<span id="cb285-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-9" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G <span class="sc">+</span> (A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), </span>
<span id="cb285-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample_prior=</span><span class="st">&quot;only&quot;</span>, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb285-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb285-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">thin =</span> <span class="dv">4</span>, <span class="at">prior =</span> priors)</span></code></pre></div>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb286-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb286-2" aria-hidden="true" tabindex="-1"></a>prior_mildly_informative <span class="ot">=</span> </span>
<span id="cb286-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb286-3" aria-hidden="true" tabindex="-1"></a>  bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;8_prior_mildly_informative.RDS&#39;</span>)</span></code></pre></div>
<p>We can use the <code>p_check</code> function again to make plots of our prior predictions, as shown in middle plot of figure <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fig:F8-1">8.1</a>. As we can see, the priors we’ve been using allow for some implausibly large or small apparent height judgments. However, they are constraining the bulk of these to values between 100-200 cm, which is our approximate target. In our opinion, these priors are ‘good enough’. However, we may be unhappy that even some implausible values are being generated and want to test out even tighter priors. Below, we sample from priors that are half as wide as those of our mildly informative model above.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb287-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,156, 6)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb287-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-3" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 6)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb287-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-4" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 6)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb287-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-5" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (2)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>), </span>
<span id="cb287-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-6" aria-hidden="true" tabindex="-1"></a>           brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 6)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb287-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-8" aria-hidden="true" tabindex="-1"></a>prior_conservative <span class="ot">=</span>  </span>
<span id="cb287-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-9" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G <span class="sc">+</span> (A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), </span>
<span id="cb287-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample_prior=</span><span class="st">&quot;only&quot;</span>, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">1</span>, <span class="at">cores =</span> <span class="dv">1</span>, </span>
<span id="cb287-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb287-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">prior =</span> priors)</span></code></pre></div>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb288-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb288-2" aria-hidden="true" tabindex="-1"></a>prior_conservative <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;8_prior_conservative.RDS&#39;</span>)</span></code></pre></div>
<p>The prior predictions made by this model are presented in the right plot of figure <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fig:F8-1">8.1</a>. This time, we see that our prior predictions are even more tightly clustered within our desired range. For the sake of comparison, we fit the three models specified above by erasing <code>sample_prior="only"</code> from the respective function calls. We’ve named these models <code>model_uninformative</code>, <code>model_mildly_informative</code>, and <code>model_conservative</code> respectively. Below we load the models:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb289-1" aria-hidden="true" tabindex="-1"></a>model_uninformative <span class="ot">=</span> </span>
<span id="cb289-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb289-2" aria-hidden="true" tabindex="-1"></a>  bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&quot;8_model_uninformative.RDS&quot;</span>)</span>
<span id="cb289-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb289-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb289-4" aria-hidden="true" tabindex="-1"></a>model_mildly_informative <span class="ot">=</span> </span>
<span id="cb289-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb289-5" aria-hidden="true" tabindex="-1"></a>  bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&quot;8_model_mildly_informative.RDS&quot;</span>)</span>
<span id="cb289-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb289-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb289-7" aria-hidden="true" tabindex="-1"></a>model_conservative <span class="ot">=</span> </span>
<span id="cb289-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb289-8" aria-hidden="true" tabindex="-1"></a>  bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&quot;8_model_conservative.RDS&quot;</span>)</span></code></pre></div>
<p>We use <code>brmplot</code> to compare the fixed effects estimates for the three models. As can be seen, there is little to no difference in parameter estimates or the credible intervals around them as a function of our prior probabilities. For example, although it may seem that there is a reduction in the <code>A1</code> effect based on the prior, the posterior means of these effects differ by less than 0.2 cm across the three models. This is in part due to the large amount of data we have, and to the fact that our model is fairly simple relative to the information contained in our data.</p>
<div class="figure"><span style="display:block;" id="fig:F8-2"></span>
<img src="_main_files/figure-html/F8-2-1.jpeg" alt="Comparison of fixed effects estimates and 95% credible intervals for the uninformative (UI), mildly informative (MI), and conservative (C) models." width="4800" />
<p class="caption">
Figure 8.2: Comparison of fixed effects estimates and 95% credible intervals for the uninformative (UI), mildly informative (MI), and conservative (C) models.
</p>
</div>
</div>
<div id="more-specific-priors" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> More specific priors<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#more-specific-priors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The final model above was named <code>conservative</code> because its priors may have been <em>too</em> small. As noted above we actually expect an effect for age of about 10 cm based on variation in veridical height between children and adults, and about 3 cm for the gender effect. When we set our priors using the <code>class</code> parameter in the <code>prior</code> function, we can reduce the time our models take to fit, but we lose the ability to fine-tune priors for specific parameters. For example, we might want a model with a prior with a standard deviation of 10 cm for the age effect, and a prior standard deviation of 3 cm for the gender effect. We can use the <code>prior_summary</code> function in <code>brms</code> to see what priors we can set for our model. The output of this function is formatted in the same way as that of the <code>get_priors</code> function, discussed in sections <a href="fitting-bayesian-regression-models-with-brms.html#c3-specifying-priors">3.7</a> and <a href="inspecting-a-single-group-of-observations-using-a-bayesian-multilevel-model.html#c4-fitting-1">4.5.3</a>. Actually, we’re going to use a clone of <code>get_prior</code> in the <code>bmmb</code> package just because the one in <code>brms</code> doesn’t like it when you omit columns from the output when printing.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we omit empty columns to let the output fit on the page </span></span>
<span id="cb290-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-2" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">prior_summary</span>(model_mildly_informative)[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>)]</span>
<span id="cb290-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="do">##                  prior     class      coef group  source</span></span>
<span id="cb290-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)         b                    user</span></span>
<span id="cb290-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)         b        A1       default</span></span>
<span id="cb290-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)         b     A1:G1       default</span></span>
<span id="cb290-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)         b        G1       default</span></span>
<span id="cb290-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   student_t(3,156, 12) Intercept                    user</span></span>
<span id="cb290-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  lkj_corr_cholesky (2)         L                    user</span></span>
<span id="cb290-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  lkj_corr_cholesky (2)         L               L default</span></span>
<span id="cb290-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)        sd                    user</span></span>
<span id="cb290-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-12" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)        sd               L default</span></span>
<span id="cb290-13"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-13" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)        sd        A1     L default</span></span>
<span id="cb290-14"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-14" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)        sd     A1:G1     L default</span></span>
<span id="cb290-15"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)        sd        G1     L default</span></span>
<span id="cb290-16"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-16" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)        sd Intercept     L default</span></span>
<span id="cb290-17"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-17" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)        sd               S default</span></span>
<span id="cb290-18"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-18" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)        sd Intercept     S default</span></span>
<span id="cb290-19"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb290-19" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 12)     sigma                    user</span></span></code></pre></div>
<p>By the way, you can get the same information from your models by running the command <code>model_mildly_informative$prior</code>. We can copy the values of the <code>class</code>, <code>coeff</code>, and <code>group</code> columns in the output above to set more specific prior probabilities for the different parameters in our model. Below, We set some arbitrarily selected priors just to show an example of how these can be set for more specific groups of parameters.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we omit the &#39;brms::&#39; part so that the lines below will fit on the page</span></span>
<span id="cb291-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> </span>
<span id="cb291-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,156, 6)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb291-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 6)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb291-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 10)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>, <span class="at">coef =</span> <span class="st">&quot;A1&quot;</span>),</span>
<span id="cb291-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 3)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>, <span class="at">coef =</span> <span class="st">&quot;G1&quot;</span>),</span>
<span id="cb291-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 10)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb291-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>, <span class="at">coef =</span> <span class="st">&quot;A1&quot;</span>, <span class="at">group=</span><span class="st">&quot;L&quot;</span>),</span>
<span id="cb291-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>, <span class="at">coef =</span> <span class="st">&quot;G1&quot;</span>, <span class="at">group=</span><span class="st">&quot;L&quot;</span>),</span>
<span id="cb291-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (2)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>), </span>
<span id="cb291-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3,0, 6)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb291-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-13"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-13" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&#39;contr.sum&#39;</span>,<span class="st">&#39;contr.sum&#39;</span>))</span>
<span id="cb291-14"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-14" aria-hidden="true" tabindex="-1"></a>prior_informative <span class="ot">=</span>  </span>
<span id="cb291-15"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-15" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G <span class="sc">+</span> (A <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S), </span>
<span id="cb291-16"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">1</span>, <span class="at">cores =</span> <span class="dv">1</span>, </span>
<span id="cb291-17"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb291-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">prior =</span> priors)</span></code></pre></div>
<p>If we inspect the priors for this model and compare this to the previous one, we can see that now there is between-parameter variation in our priors.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">prior_summary</span>(prior_informative)[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>)]</span>
<span id="cb292-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                  prior     class      coef group  source</span></span>
<span id="cb292-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3,0, 6)         b                    user</span></span>
<span id="cb292-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 10)         b        A1          user</span></span>
<span id="cb292-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 10)         b     A1:G1       default</span></span>
<span id="cb292-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3,0, 3)         b        G1          user</span></span>
<span id="cb292-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    student_t(3,156, 6) Intercept                    user</span></span>
<span id="cb292-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  lkj_corr_cholesky (2)         L                    user</span></span>
<span id="cb292-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  lkj_corr_cholesky (2)         L               L default</span></span>
<span id="cb292-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 10)        sd                    user</span></span>
<span id="cb292-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     student_t(3,0, 10)        sd               L default</span></span>
<span id="cb292-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-12" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3,0, 5)        sd        A1     L    user</span></span>
<span id="cb292-13"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-13" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3,0, 5)        sd     A1:G1     L default</span></span>
<span id="cb292-14"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-14" aria-hidden="true" tabindex="-1"></a><span class="do">##    student_t(3,0, 1.5)        sd        G1     L    user</span></span>
<span id="cb292-15"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-15" aria-hidden="true" tabindex="-1"></a><span class="do">##    student_t(3,0, 1.5)        sd Intercept     L default</span></span>
<span id="cb292-16"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-16" aria-hidden="true" tabindex="-1"></a><span class="do">##    student_t(3,0, 1.5)        sd               S default</span></span>
<span id="cb292-17"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-17" aria-hidden="true" tabindex="-1"></a><span class="do">##    student_t(3,0, 1.5)        sd Intercept     S default</span></span>
<span id="cb292-18"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb292-18" aria-hidden="true" tabindex="-1"></a><span class="do">##      student_t(3,0, 6)     sigma                    user</span></span></code></pre></div>
</div>
</div>
<div id="heteroskedasticity-and-distributional-or-mixture-models" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Heteroskedasticity and distributional (or mixture) models<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#heteroskedasticity-and-distributional-or-mixture-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Most ‘typical’ regression models assume that the error variance is the same for all observations, all conditions, all listeners, etc. The property of having a homogeneous variance is called <strong>homoscedasticity</strong>, and models that make this assumption are <strong>homoscedastic</strong>. Historically, the homogeneity of error variance has been assumed in models because it makes them simpler to work with and understand, and not because it is ‘true’ for all (or any) data. With Bayesian models it is straightforward to relax and test this assumption, and to build models that exhibit <strong>heteroscedasticity</strong>, differences in the error variance across different subsets of data. These sorts of models are sometimes called <strong>mixture models</strong> because they can be thought of as a mixture of different distributions or <strong>distributional models</strong> because they allow us to model variation in all of the parameters of the data distribution (e.g. <span class="math inline">\(\sigma\)</span> in addition to <span class="math inline">\(\mu\)</span>).</p>
<p>Consider the residuals for the random effects model we fit in chapter 7, which we can get from the model using the <code>residuals</code> function:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># download model</span></span>
<span id="cb293-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb293-2" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;7_model_interaction.RDS&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get residuals</span></span>
<span id="cb294-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb294-2" aria-hidden="true" tabindex="-1"></a>residuals_interaction <span class="ot">=</span> <span class="fu">residuals</span> (model_interaction)</span></code></pre></div>
<p>If we inspect the residuals we see that the distribution of these is not exactly equal for all listeners, and also appears to vary based on apparent speaker age. For example, the interquartile range for listener 9 is nearly as wide as the entire distribution of residuals for listener 12. In this section we will fit models with age and listener-specific error variances (<span class="math inline">\(\sigma\)</span>). By allowing the random error to vary as a function of listener and apparent age, our model may be able to provide more-reliable information regarding our data, in addition to letting us ask questions like “is listener 12’s error variance actually smaller than listener 9’s, or does it just seem that way?” in a more formal manner.</p>
<div class="figure"><span style="display:block;" id="fig:F8-3"></span>
<img src="_main_files/figure-html/F8-3-1.jpeg" alt="(top left) Distribution of residuals for each listener. (top right) Distribution of residuals for apparent adults (a) and apparent children (c). (bottom) Distribution of residuals for each listener, divided according to apparent children and apparent adults. Each color represents a different listener and the left box in each pair represents apparent adults." width="4800" />
<p class="caption">
Figure 8.3: (top left) Distribution of residuals for each listener. (top right) Distribution of residuals for apparent adults (a) and apparent children (c). (bottom) Distribution of residuals for each listener, divided according to apparent children and apparent adults. Each color represents a different listener and the left box in each pair represents apparent adults.
</p>
</div>
<p>To this point our models have all looked something like <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#eq:8-1">(8.1)</a>, with the generic predictors <span class="math inline">\(x_p\)</span>. In these models <span class="math inline">\(\mu\)</span> got a subscript because it varied from trial to trial and was being predicted, but <span class="math inline">\(\sigma\)</span> has never received a subscript because it hasn’t varied in our models.</p>
<p><span class="math display" id="eq:8-1">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{N}(\mu_{[i]},\sigma) \\
\mu_{[i]} = \mathrm{x}_1 + \mathrm{x}_2+ \dots + \mathrm{x}_p \\
\end{split}
\tag{8.1}
\end{equation}
\]</span></p>
<p>Instead, we can fit models that help us understand systematic variation in both the mean <em>and</em> the <span class="math inline">\(\sigma\)</span> parameters in our data. We can imagine this by adding a subscript to <span class="math inline">\(\sigma\)</span> and predicting its value from trial to trial using variables, as seen in <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#eq:8-2">(8.2)</a>. We’ve given these predictor variables little <span class="math inline">\(\sigma\)</span> subscripts just to distinguish them conceptually from those predicting <span class="math inline">\(\mu\)</span>, but they could be the same variables used to understand <span class="math inline">\(\mu\)</span> or a different set.</p>
<p><span class="math display" id="eq:8-2">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{N}(\mu_{[i]},\sigma_{[i]}) \\
\mu_{[i]} = \mathrm{x}_1 + \mathrm{x}_2+ \dots + \mathrm{x}_p \\
\sigma_{[i]} = \mathrm{x}_{\sigma1} + \mathrm{x}_{\sigma2} + \dots + \mathrm{x}_{\sigma p} \\ \\
\end{split}
\tag{8.2}
\end{equation}
\]</span></p>
</div>
<div id="a-simple-model-error-varies-according-to-a-single-fixed-effect" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> A ‘simple’ model: Error varies according to a single fixed effect<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#a-simple-model-error-varies-according-to-a-single-fixed-effect" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll begin with a ‘simple’ heteroscedastic model that allows for variation in <span class="math inline">\(\sigma\)</span> based on apparent age. After this, we’ll fit a model that includes listener-dependent variation in <span class="math inline">\(\sigma\)</span> as well.</p>
<div id="description-of-our-model-2" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Description of our model<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#description-of-our-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>brms</code> package makes it easy to fit heteroscedastic models by letting you write formulas for the error just as you do for the mean. For example, the model formula for the last model we fit in chapter 7 (<code>model_interaction</code>) was:</p>
<p><code>height ~ A + G + A:G + (A + G + A:G|L) + (1|S)</code></p>
<p>This told <code>brms</code> “model apparent height as a function of an intercept, an effect for apparent age, an effect for apparent gender, the interaction of the two, listener-specific adjustments to all predictors, and speaker-specific intercepts”. Implicitly, we know that all of this models variation in the <span class="math inline">\(\mu\)</span> parameter of a normal distribution with a fixed <span class="math inline">\(\sigma\)</span>. We want our model to consider the possibility that the value of <span class="math inline">\(\sigma\)</span> may vary based on whether the speaker is judged to be an adult or a child. We can do this by including a separate formula for our error (called <code>sigma</code> by <code>brms</code>) using the following formula:</p>
<p><code>sigma ~ A</code></p>
<p>This formula tells <code>brms</code> “model the standard deviation of the error as varying around an overall intercept and deviations of this based on <code>A</code>, a predictor indicating apparent age”. We can ‘stick’ our two model formulas together using the <code>bf</code> (<code>brmsformula</code>) function as shown below:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb295-1" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">bf</span>(height <span class="sc">~</span> A <span class="sc">+</span> (A<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S),</span>
<span id="cb295-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb295-2" aria-hidden="true" tabindex="-1"></a>                         sigma <span class="sc">~</span> A)</span></code></pre></div>
<p>The problem with modeling the standard deviation parameter directly is that negative values are impossible, so that standard deviations are bounded by zero. To deal with this, <code>brms</code> models <code>log(sigma)</code>, the logarithm of the error standard deviation, rather than <code>sigma</code> directly. Logarithms help model standard deviations because they map all numbers from 0 to 1 to values between negative infinity and 0. This allows one to model very small values of <span class="math inline">\(\sigma\)</span> while at the same time never worrying about estimating a negative standard deviation (for more on logarithms see section <a href="probabilities-likelihood-and-inference.html#c2-logarithms">2.7.2</a>).</p>
<p>Since we’re modeling log-transformed sigmas, we now specify the priors for sigma in logarithmic values. Previously, our prior for sigma was a t-distribution with a standard deviation of 12. This meant that the majority of the mass of the distribution was going to be between 0 and 24 cm (two standard deviations from the mean). Now, we set the distribution to 1.5, meaning that we expect most predictors related to <span class="math inline">\(\sigma\)</span> to be between <span class="math inline">\(\exp(-3)=0.05\)</span> and <span class="math inline">\(\exp(3)=20.1\)</span>. The full model specification is provided below (omitting the ‘construction’ of the <span class="math inline">\(\mathrm{\Sigma}\)</span> term):</p>
<p><span class="math display" id="eq:8-3">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{t}(\nu, \mu_{[i]},\sigma_{[i]}) \\
\mu_{[i]} = \mathrm{Intercept} + A + G + A \colon G + \\ L_{[\mathsf{L}_{[i]}]} + A \colon L_{[\mathsf{L}_{[i]}]} + G \colon L_{[\mathsf{L}_{[i]}]} + A \colon G \colon L_{[\mathsf{L}_{[i]}]} + S_{[\mathsf{S}_{[i]}]} \\
\\
\log (\sigma_{[i]}) = \mathrm{Intercept_{\sigma}} + A_{\sigma} \\ \\
\mathrm{Priors:} \\
S_{[\bullet]} \sim \mathrm{t}(3,0,\sigma_S) \\
\begin{bmatrix} L_{[\bullet]} \\ A \colon L_{[\bullet]} \\ G \colon L_{[\bullet]} \\ A \colon G \colon L_{[\bullet]} \end{bmatrix} \sim \mathrm{MVNormal} \left( \begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \\ \end{bmatrix}, \mathrm{\Sigma} \right) \\ \\
\mathrm{Intercept} \sim \mathrm{t}(3,156,12) \\
A, G, A \colon G \sim \mathrm{t}(3,0,12) \\
\sigma_L, \sigma_{A \colon L}, \sigma_{G \colon L}, \sigma_{A \colon G \colon L}, \sigma_S \sim \mathrm{t}(3,0,12) \\
\nu \sim \mathrm{gamma}(2, 0.1) \\
R \sim \mathrm{LKJCorr} (2) \\
\mathrm{Intercept_{\sigma}} \sim \mathrm{N}(0,1.5) \\
A_\sigma \sim \mathrm{N}(0,1.5) \\
\end{split}
\tag{8.3}
\end{equation}
\]</span></p>
<p>A plain English description of this model is:</p>
<blockquote>
<p>We are modeling apparent height as coming from a t distribution with unknown nu (<span class="math inline">\(\nu\)</span>), mean (<span class="math inline">\(\mu\)</span>), and scale (<span class="math inline">\(\sigma\)</span>) parameters. The expected value for any given trial (<span class="math inline">\(\mu\)</span>) is modeled as the sum of an intercept, an effect for apparent speaker age (<span class="math inline">\(A\)</span>), gender (<span class="math inline">\(G\)</span>), and their interaction (<span class="math inline">\(A \colon G\)</span>), a listener effect (<span class="math inline">\(L\)</span>), a listener dependent effect for apparent age (<span class="math inline">\(A \colon L\)</span>), apparent gender (<span class="math inline">\(G \colon L\)</span>), their interaction (<span class="math inline">\(A \colon G \colon L\)</span>), and a speaker effect (<span class="math inline">\(S\)</span>). The expected value of the logarithm of the error standard deviation (<span class="math inline">\(\sigma\)</span>) is modeled as the sum of an intercept (<span class="math inline">\(Intercept_{\sigma}\)</span>) and an effect for apparent age (<span class="math inline">\(A_\sigma\)</span>) that are specific to the error. The speaker effects were drawn from a univariate normal distribution with a standard deviation (<span class="math inline">\(\sigma_S\)</span>) estimated from the data. The four listener effects were drawn from a multivariate normal distribution with individual standard deviations (<span class="math inline">\(\sigma_L,\sigma_{A \colon L},\sigma_{G \colon L},\sigma_{A \colon G \colon L}\)</span>) and a correlation matrix (<span class="math inline">\(R\)</span>) that was estimated from the data. The remainder of the ‘fixed’ effects and correlations were given prior distributions appropriate for their expected range of values, including the terms related to the error (<span class="math inline">\(Intercept_{\sigma}\)</span>, and <span class="math inline">\(A_\sigma\)</span>).</p>
</blockquote>
<p>This model is quite large, but it only contains four new (or modified) lines compared to the model presented in <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#eq:7-8">(7.8)</a>. These lines are presented in <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#eq:8-4">(8.4)</a>, and effectively represent a simple two-group model for our <span class="math inline">\(\sigma\)</span> parameter, that has been added to our model predicting <span class="math inline">\(\mu\)</span>. Our model now uses a trial-specific error term for trial <span class="math inline">\(i\)</span> (<span class="math inline">\(\sigma_{[i]}\)</span>), whereas it previously always used a constant standard deviation. Further, we are now modeling this trial-specific <span class="math inline">\(\sigma\)</span> parameter using an intercept specific to our sigma term (<span class="math inline">\(\mathrm{Intercept_{\sigma}}\)</span>), and a deviation from this base on apparent age (<span class="math inline">\(A_{\sigma}\)</span>).</p>
<p><span class="math display" id="eq:8-4">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{t}(\nu, \mu_{[i]},\sigma_{[i]}) \\
\sigma_{[i]} = \mathrm{Intercept_{\sigma}} + A_{\sigma} \\ \\
\mathrm{Intercept_{\sigma}} \sim \mathrm{t}(3, 0,1.5) \\
A_\sigma \sim \mathrm{t}(3, 0,1.5) \\
\end{split}
\tag{8.4}
\end{equation}
\]</span></p>
</div>
<div id="prior-predictive-checks" class="section level3 hasAnchor" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> Prior predictive checks<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#prior-predictive-checks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that when we use the <code>set_priors</code> function we can use the <code>class</code> parameter to specify priors for whole classes of parameters at a time. The classes we have discussed so far are:</p>
<ul>
<li><code>Intercept</code>: this is a unique class, only for intercepts.</li>
<li><code>sd</code>: this is for our standard deviation parameters that relate to ‘batches’ of parameters, e.g. <code>sd(Intercept)</code> for <code>L</code> (<span class="math inline">\(\sigma_{L}\)</span>).</li>
<li><code>sigma</code>: the error term.</li>
<li><code>cor</code>: priors for ‘random effect’ correlation terms.</li>
</ul>
<p>For the first time we need to specify priors for terms for <span class="math inline">\(\sigma\)</span> rather than <span class="math inline">\(\mu\)</span>. We can do this by setting <code>dpar="sigma"</code> in the <code>set_prior</code> function. As noted just above, you can see which priors need setting, and which parameters need to be specified for a model, by using the <code>get_prior</code> function and providing your formula, data, and family.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb296-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">get_prior</span> (brms<span class="sc">::</span><span class="fu">bf</span>(height <span class="sc">~</span> A<span class="sc">*</span>G <span class="sc">+</span> (A<span class="sc">*</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S),</span>
<span id="cb296-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb296-2" aria-hidden="true" tabindex="-1"></a>                          sigma <span class="sc">~</span> A),</span>
<span id="cb296-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb296-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> exp_data, <span class="at">family=</span><span class="st">&quot;student&quot;</span>)</span></code></pre></div>
<p>If you run the command above you will see output that includes the lines below:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="do">##                      prior     class      coef group resp  dpar</span></span>
<span id="cb297-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                     (flat)         b                      sigma            </span></span>
<span id="cb297-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="do">##                     (flat)         b        A1            sigma            </span></span>
<span id="cb297-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="do">##       student_t(3, 0, 2.5) Intercept                      sigma            </span></span></code></pre></div>
<p>We have two parameters where <code>dpar=sigma</code>: An overall intercept (<code>class = "Intercept", dpar = "sigma"</code>), and an age term for sigma (<code>class = "b",coef="A1",dpar="sigma"</code>). We can set priors for these elements using the lines:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb298-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb298-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb298-2" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>)</span></code></pre></div>
<p>Notice that we set these priors using the classes we have already discussed, <code>Intercept</code> and <code>b</code> respectively. However, now we set <code>dpar</code> (distributional parameter) to <code>sigma</code> to tell <code>brm</code> that these priors are specifically for parameters related to the model error term, and not to variation in predicted values (i.e. <span class="math inline">\(\mu\)</span>). Below we fit the model sampling only from our priors:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb299-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-2" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">bf</span>(height <span class="sc">~</span> A<span class="sc">*</span>G <span class="sc">+</span> (A<span class="sc">*</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S),</span>
<span id="cb299-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-3" aria-hidden="true" tabindex="-1"></a>                         sigma <span class="sc">~</span> A)</span>
<span id="cb299-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-4" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> </span>
<span id="cb299-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 156, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb299-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb299-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb299-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;gamma(2, 0.1)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;nu&quot;</span>),</span>
<span id="cb299-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>),</span>
<span id="cb299-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>),</span>
<span id="cb299-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (2)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>))</span>
<span id="cb299-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-13"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-13" aria-hidden="true" tabindex="-1"></a>prior_A_sigma <span class="ot">=</span> </span>
<span id="cb299-14"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-14" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (model_formula, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb299-15"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>, <span class="at">family=</span><span class="st">&quot;student&quot;</span>,</span>
<span id="cb299-16"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb299-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">prior =</span> priors, <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb300-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb300-2" aria-hidden="true" tabindex="-1"></a>prior_A_sigma <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;8_prior_A_sigma.RDS&#39;</span>)</span></code></pre></div>
<p>We can investigate our prior predictions using the code below. We don’t plot them here, but we think the predictions are reasonable.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_check</span> (prior_A_sigma)</span></code></pre></div>
</div>
<div id="fitting-and-interpreting-the-model-5" class="section level3 hasAnchor" number="8.5.3">
<h3><span class="header-section-number">8.5.3</span> Fitting and interpreting the model<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fitting-and-interpreting-the-model-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the first time below, we specify both the model formula (using the <code>bf</code> function) and the priors (using the <code>set_prior</code> function) outside of the call to <code>brm</code>. We do this to preserve the legibility of the code in general.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb302-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-2" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">bf</span>(height <span class="sc">~</span> A<span class="sc">*</span>G <span class="sc">+</span> (A<span class="sc">*</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S),</span>
<span id="cb302-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-3" aria-hidden="true" tabindex="-1"></a>                         sigma <span class="sc">~</span> A)</span>
<span id="cb302-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-4" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> </span>
<span id="cb302-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 156, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb302-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb302-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb302-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;gamma(2, 0.1)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;nu&quot;</span>),</span>
<span id="cb302-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>),</span>
<span id="cb302-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>),</span>
<span id="cb302-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (2)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>))</span>
<span id="cb302-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-13"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-13" aria-hidden="true" tabindex="-1"></a>model_A_sigma <span class="ot">=</span> </span>
<span id="cb302-14"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-14" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (model_formula, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb302-15"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>, <span class="at">family=</span><span class="st">&quot;student&quot;</span>,</span>
<span id="cb302-16"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb302-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">prior =</span> priors)</span></code></pre></div>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download it from the GitHub page:</span></span>
<span id="cb303-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb303-2" aria-hidden="true" tabindex="-1"></a>model_A_sigma <span class="ot">=</span> bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;8_model_A_sigma.RDS&#39;</span>)</span></code></pre></div>
<p>If we look at the model ‘fixed’ (`population-Level) effects:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span> (model_A_sigma)</span>
<span id="cb304-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Estimate Est.Error    Q2.5    Q97.5</span></span>
<span id="cb304-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb304-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept        158.383   1.10922 156.193 160.6196</span></span>
<span id="cb304-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb304-4" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma_Intercept    1.724   0.03265   1.659   1.7881</span></span>
<span id="cb304-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb304-5" aria-hidden="true" tabindex="-1"></a><span class="do">## A1                11.271   1.19021   8.915  13.6901</span></span>
<span id="cb304-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb304-6" aria-hidden="true" tabindex="-1"></a><span class="do">## G1                -3.067   0.59091  -4.271  -1.9084</span></span>
<span id="cb304-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb304-7" aria-hidden="true" tabindex="-1"></a><span class="do">## A1:G1             -1.528   0.43464  -2.403  -0.6654</span></span>
<span id="cb304-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb304-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma_A1          -0.247   0.02199  -0.290  -0.2036</span></span></code></pre></div>
<p>We see two new lines reflecting our new model parameters, both in the ‘Population-level effects’: <code>sigma_Intercept</code> and <code>sigma_A1</code>. These terms represent the intercept of our <code>sigma</code>, term and the effect for apparent adultness on <code>sigma</code>. These effects can be interpreted in a very similar way as we interpret the corresponding effects for <span class="math inline">\(\mu\)</span>: <code>Intercept</code> and <code>A1</code>. The value of <code>sigma_Intercept</code> represents the grand mean for our <code>sigma</code> term. The value of <code>sigma_A1</code> reflects the difference in <code>sigma</code> between the intercept and the value when speakers were perceived as adults. Since we are using sum coding <code>A2</code>, the effect for apparent children, is not estimated. However, we can recover <code>A2</code> since <code>A1 = -A2</code>. One easy way to do this is using the <code>hypothesis</code> function (or its clone in <code>bmmb</code>) as follows:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-1" aria-hidden="true" tabindex="-1"></a>sigmas <span class="ot">=</span> <span class="fu">short_hypothesis</span>(</span>
<span id="cb305-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-2" aria-hidden="true" tabindex="-1"></a>  model_A_sigma, </span>
<span id="cb305-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;exp(sigma_Intercept) = 0&quot;</span>,                <span class="co"># overall sigma</span></span>
<span id="cb305-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;exp(sigma_Intercept + sigma_A1) = 0&quot;</span>,     <span class="co"># adult sigma</span></span>
<span id="cb305-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;exp(sigma_Intercept - sigma_A1) = 0&quot;</span>))    <span class="co"># child sigma</span></span>
<span id="cb305-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-6" aria-hidden="true" tabindex="-1"></a>sigmas[,<span class="sc">-</span><span class="dv">5</span>]</span>
<span id="cb305-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    Estimate Est.Error  Q2.5 Q97.5</span></span>
<span id="cb305-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="do">## H1    5.609    0.1830 5.253 5.978</span></span>
<span id="cb305-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-9" aria-hidden="true" tabindex="-1"></a><span class="do">## H2    4.382    0.1526 4.085 4.680</span></span>
<span id="cb305-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb305-10" aria-hidden="true" tabindex="-1"></a><span class="do">## H3    7.184    0.3115 6.573 7.793</span></span></code></pre></div>
<p>Since our model estimates <code>log(sigma)</code> and not <code>sigma</code> directly, to get our values of sigma we need to exponentiate our parameter estimates in order to recover our actual model error. We can do this directly in <code>short_hypothesis</code> as seen above. The three estimated error terms are presented in figure <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fig:F8-4">8.4</a>. Clearly, there are substantial differences in the value of <span class="math inline">\(\sigma\)</span> based on the perceived adultness of the speaker: The value of <span class="math inline">\(\sigma\)</span> was 61% greater (7.1/4.4) when listeners identified the speaker as a child.</p>
<div class="figure"><span style="display:block;" id="fig:F8-4"></span>
<img src="_main_files/figure-html/F8-4-1.jpeg" alt="(left) Estimates of overall data-level error ($\sigma$), to estimates of this for apparent adults and for apparent children. (right) Comparison of some fixed-effects parameters shared by our heteroscedastic and homoscedastic models." width="4800" />
<p class="caption">
Figure 8.4: (left) Estimates of overall data-level error (<span class="math inline">\(\sigma\)</span>), to estimates of this for apparent adults and for apparent children. (right) Comparison of some fixed-effects parameters shared by our heteroscedastic and homoscedastic models.
</p>
</div>
<p>We might wonder two things about this new model. First, is there any difference in our fixed-effect parameters? Second, is the additional model complexity justified? We can compare this heteroskedastic model to the equivalent homoskedastic model we fit in chapter 7 (<code>model_interaction</code>, loaded above). We can assess the first question visually using the <code>brmplot</code> function as seen in the right plot of figure <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fig:F8-4">8.4</a>. It doesn’t seem like the change has had much impact on our parameter estimates, or the intervals around them. We can make a more formal comparison using cross validation (discussed in section <a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-out-sample-crossval">6.4.3</a>). We add the <code>loo</code> (leave one out) criterion to each model and make a comparison.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb306-1" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">=</span> <span class="fu">add_criterion</span>(model_interaction,<span class="st">&quot;loo&quot;</span>)</span>
<span id="cb306-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb306-2" aria-hidden="true" tabindex="-1"></a>model_A_sigma <span class="ot">=</span> <span class="fu">add_criterion</span>(model_A_sigma,<span class="st">&quot;loo&quot;</span>)</span>
<span id="cb306-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb306-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb306-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span> (model_interaction, model_A_sigma)</span>
<span id="cb306-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb306-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                   elpd_diff se_diff</span></span>
<span id="cb306-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb306-6" aria-hidden="true" tabindex="-1"></a><span class="do">## model_A_sigma       0.0       0.0  </span></span>
<span id="cb306-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb306-7" aria-hidden="true" tabindex="-1"></a><span class="do">## model_interaction -53.7      12.8</span></span></code></pre></div>
<p>We can see that there is a substantial difference in <span class="math inline">\(\mathrm{elpd}\)</span> between models, and that this difference is just over four times the size of the standard deviation. Based on this, it would seem that using the more complex model is justifiable. We will leave a discussion of whether the difference <em>makes sense</em> or <em>matters</em> for the section on answering our research questions.</p>
</div>
</div>
<div id="a-complex-model-error-varies-according-to-fixed-and-random-effects" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> A ‘complex’ model: Error varies according to fixed and random effects<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#a-complex-model-error-varies-according-to-fixed-and-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous section we fit a relatively ‘simple’ heteroscedastic model. This model allowed for error variances to differ based on the perceived adultness of the speaker, and so was very similar to the models we fit in chapter 5. Here, we’re going to fit a substantially more complex model that predicts variation in <span class="math inline">\(\sigma\)</span> using listener-dependent ‘random effects’ in the same way we would for our prediction of <span class="math inline">\(\mu\)</span>.</p>
<div id="c8-description-2" class="section level3 hasAnchor" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Description of our model<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-description-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our previous model had the following formula for the <code>sigma</code> term:</p>
<p><code>sigma ~ A</code></p>
<p>This told <code>brms</code> “model <code>sigma</code> as a function of an intercept and an effect for apparent age”. We can add to our formula by specifying a ‘random effect’ term for listeners, and a ‘random slope’ for age (i.e. an interaction between apparent age and listener), both estimated using adaptive pooling.</p>
<p><code>sigma ~ A + (A|L)</code></p>
<p>This formula tells <code>brms</code> “model <code>sigma</code> as varying around an overall intercept, an effect for apparent age, listener-specific deviations, and the interaction of apparent age and listener”. Effectively, we have two separate model formulas: One for a model with two categorical predictors and an interaction (like those in chapter 7), and one for a model comparing two groups (like those in chapter 6). We can ‘stick’ our two model formulas together using the <code>bf</code> (or <code>brmsformula</code>) function as shown below:</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb307-1" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">bf</span>(height <span class="sc">~</span> A<span class="sc">*</span>G <span class="sc">+</span> (A<span class="sc">*</span>G<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S),</span>
<span id="cb307-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb307-2" aria-hidden="true" tabindex="-1"></a>                         sigma <span class="sc">~</span> A <span class="sc">+</span> (A<span class="sc">|</span>L))</span></code></pre></div>
<p>If we were to fit the model using the formula above, our model would include independent multivariate normal distributions for the listener effects related to the mean, and those related to the error term. So, we would have a four-dimensional normal distribution relating to the expected mean (<span class="math inline">\(\mu\)</span>), representing the listener intercept, the listener-dependent effects for apparent age and gender, and the listener-dependent interaction between the two. We would then have a separate two-dimensional normal distribution representing the listener-dependent intercepts and effects for apparent age relating to the error term (<span class="math inline">\(\sigma\)</span>). This may be desirable in some situations, however, it may also be useful to estimate all of these listener-dependent coefficients from a single six-dimensional multivariate normal.</p>
<p>Right now, our model formula consists of two separate sub-formulas, each of which contains a term representing listeners (<code>L</code>). If we want our model to know that the <code>L</code> term predicting the mean is related to the <code>L</code> term predicting our error, then we can do this by adding the same label in each corresponding random effects term in parentheses, in between two pipes. Below, we use the label <code>|x|</code> to tell <code>brms</code> to estimate all six listener-dependent parameters jointly. The label can be almost any string, it just needs to be the same thing for every batch of random effects terms that you want to estimate together.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb308-1" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">bf</span>(height <span class="sc">~</span> A<span class="sc">*</span>G <span class="sc">+</span> (A<span class="sc">*</span>G<span class="sc">|</span>x<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S),</span>
<span id="cb308-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb308-2" aria-hidden="true" tabindex="-1"></a>                         sigma <span class="sc">~</span> A <span class="sc">+</span> (A<span class="sc">|</span>x<span class="sc">|</span>L))</span></code></pre></div>
<p>Just keep in mind, you should <em>not</em> use the same label for things you do not want grouped. So, if we wanted to estimate speaker effects for our error and wanted to associate these with the speaker effects for our means, we should use different labels as seen below.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb309-1" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">bf</span>(height <span class="sc">~</span> A<span class="sc">*</span>G <span class="sc">+</span> (A<span class="sc">*</span>G<span class="sc">|</span>x<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>y<span class="sc">|</span>S),</span>
<span id="cb309-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb309-2" aria-hidden="true" tabindex="-1"></a>                         sigma <span class="sc">~</span> A <span class="sc">+</span> (A<span class="sc">|</span>x<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>y<span class="sc">|</span>S))</span></code></pre></div>
<p>We’re not actually going to fit a model like that, as we don’t think we have enough observations per speaker (15) to justify the estimation of speaker-dependent errors given the complexity of our model. However, we wanted to provide an example of how this would be done. The full model specification is provided below:</p>
<p><span class="math display" id="eq:8-5">\[
\begin{equation}
\begin{split}
height_{[i]} \sim \mathrm{N}(\mu_{[i]},\sigma_{[i]}) \\
\mu_{[i]} = \mathrm{Intercept} + A + G + A \colon G + \\ L_{[\mathsf{L}_{[i]}]} + A \colon L_{[\mathsf{L}_{[i]}]} + G \colon L_{[\mathsf{L}_{[i]}]} + A \colon G \colon L_{[\mathsf{L}_{[i]}]} + S_{[\mathsf{S}_{[i]}]} \\ \\
\log (\sigma_{[i]}) = \mathrm{Intercept_{\sigma}} + A_\sigma + A_\sigma \colon L_{\sigma[\mathsf{L}_{[i]}]} + L_{\sigma[\mathsf{L}_{[i]}]} \\ \\
\mathrm{Priors:} \\
\begin{bmatrix} L_{[\bullet]} \\ A \colon L_{[\bullet]} \\ G \colon L_{[\bullet]} \\ A \colon G \colon L_{[\bullet]} \\ L_{\sigma[\bullet]} \\ A_\sigma \colon L_{\sigma[\bullet]} \end{bmatrix}
\sim \mathrm{MVNormal} \left( \begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ \end{bmatrix}, \mathrm{\Sigma} \right) \\
\\
S_{[\bullet]} \sim \mathrm{N}(0,\sigma_S) \\ \\
\mathrm{Intercept} \sim \mathrm{t}(3,156,12) \\
A \sim \mathrm{t}(3,0,12) \\
\sigma, \sigma_L, \sigma_{A \colon L}, \sigma_S \sim \mathrm{t}(3,0,12) \\
\\
\mathrm{Intercept_{\sigma}} \sim \mathrm{N}(0,1.5) \\
\mathrm{A_{\sigma}} \sim \mathrm{N}(0,1.5) \\
\sigma_{L_\sigma}, \sigma_{A_\sigma \colon L_\sigma} \sim \mathrm{N}(0,1.5) \\\\
R \sim \mathrm{LKJCorr} (2) \\
\end{split}
\tag{8.5}
\end{equation}
\]</span></p>
<p>Since our plain English description is nearly identical to the one provided for our previous model, the description below focuses on the components related to our error term <span class="math inline">\(\sigma\)</span>:</p>
<blockquote>
<p>We are modeling apparent height as coming from a t distribution with unknown nu (<span class="math inline">\(\nu\)</span>), mean (<span class="math inline">\(\mu\)</span>), and scale (<span class="math inline">\(\sigma\)</span>) parameters. The expected value of the logarithm of the error standard deviation (<span class="math inline">\(\sigma\)</span>) is modeled as the sum of an intercept (<span class="math inline">\(Intercept_{\sigma}\)</span>), an effect for apparent age (<span class="math inline">\(A_\sigma\)</span>), an effect for listener (<span class="math inline">\(L_\sigma\)</span>), and the interaction between apparent age and listener (<span class="math inline">\(A_\sigma \colon L_\sigma\)</span>). The two listener effects related to the error term were drawn from a multivariate normal distribution with individual standard deviations (<span class="math inline">\(\sigma_{L_\sigma}\)</span>,<span class="math inline">\(\sigma_{A_\sigma \colon L_\sigma}\)</span>) and a correlation matrix (<span class="math inline">\(R\)</span>) that was estimated from the data. The remainder of the ‘fixed’ effects and correlations were given prior distributions appropriate for their expected range of values.</p>
</blockquote>
</div>
<div id="fitting-and-interpreting-the-model-6" class="section level3 hasAnchor" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Fitting and interpreting the model<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fitting-and-interpreting-the-model-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We need to specify a prior distribution for the standard deviation of our listener-dependent <code>sigma</code> parameters, <span class="math inline">\(\sigma_{L_\sigma}\)</span> and <span class="math inline">\(\sigma_{A_\sigma \colon L_\sigma}\)</span>. We can do this by specifying a prior for <code>class = "sd"</code> and <code>dpar = "sigma"</code>. Note that this is very similar to the way we fit priors for the intercept and fixed effects for <code>sigma</code>.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model yourself</span></span>
<span id="cb310-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-2" aria-hidden="true" tabindex="-1"></a>model_formula <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">bf</span>(height <span class="sc">~</span> A<span class="sc">*</span>G <span class="sc">+</span> (A<span class="sc">*</span>G<span class="sc">|</span>x<span class="sc">|</span>L) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>S),</span>
<span id="cb310-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-3" aria-hidden="true" tabindex="-1"></a>                         sigma <span class="sc">~</span> A <span class="sc">+</span> (A<span class="sc">|</span>x<span class="sc">|</span>L))</span>
<span id="cb310-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-4" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">=</span> </span>
<span id="cb310-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 156, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb310-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb310-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 12)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>),</span>
<span id="cb310-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;gamma(2, 0.1)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;nu&quot;</span>),</span>
<span id="cb310-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>),</span>
<span id="cb310-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>),</span>
<span id="cb310-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 1.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>, <span class="at">dpar =</span> <span class="st">&quot;sigma&quot;</span>),</span>
<span id="cb310-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_prior</span>(<span class="st">&quot;lkj_corr_cholesky (2)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;cor&quot;</span>))</span>
<span id="cb310-13"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-14"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-14" aria-hidden="true" tabindex="-1"></a>model_A_L_sigma <span class="ot">=</span> </span>
<span id="cb310-15"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-15" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (model_formula, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb310-16"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>, <span class="at">family=</span><span class="st">&quot;student&quot;</span>,</span>
<span id="cb310-17"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb310-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">prior =</span> priors)</span></code></pre></div>
<p>Below we print an abridged model summary. The only change is that there are a few new lines in the listener <code>Group-Level Effects</code>. First, we see <code>sd(sigma_Intercept)</code> and <code>sd(sigma_A1)</code>, which represent the standard deviations of the listener-specific intercepts and of the age effects (for <code>sigma</code>). Second, we see the correlations between our new random effects (i.e. <code>cor(sigma_Intercept,sigma_A1)</code>).</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">short_summary</span> (model_A_L_sigma)</span>
<span id="cb311-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ...</span></span>
<span id="cb311-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(sigma_Intercept)                0.36      0.08     0.24     0.54</span></span>
<span id="cb311-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(sigma_A1)                       0.17      0.04     0.10     0.27</span></span>
<span id="cb311-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ...</span></span>
<span id="cb311-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(A1,sigma_A1)                  -0.29      0.22    -0.67     0.16</span></span>
<span id="cb311-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-7" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(G1,sigma_A1)                   0.22      0.24    -0.27     0.65</span></span>
<span id="cb311-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-8" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(A1:G1,sigma_A1)                0.12      0.24    -0.35     0.58</span></span>
<span id="cb311-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-9" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(sigma_Intercept,sigma_A1)     -0.44      0.21    -0.79     0.05</span></span>
<span id="cb311-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ...</span></span>
<span id="cb311-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb311-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects:</span></span>
<span id="cb311-13"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-13" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb311-14"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept         158.29      1.10   156.15   160.51</span></span>
<span id="cb311-15"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-15" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma_Intercept     1.74      0.10     1.55     1.93</span></span>
<span id="cb311-16"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-16" aria-hidden="true" tabindex="-1"></a><span class="do">## A1                 11.28      1.18     8.98    13.64</span></span>
<span id="cb311-17"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-17" aria-hidden="true" tabindex="-1"></a><span class="do">## G1                 -2.92      0.57    -4.06    -1.80</span></span>
<span id="cb311-18"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-18" aria-hidden="true" tabindex="-1"></a><span class="do">## A1:G1              -1.63      0.42    -2.47    -0.77</span></span>
<span id="cb311-19"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-19" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma_A1           -0.23      0.05    -0.33    -0.14</span></span>
<span id="cb311-20"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb311-21"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Family Specific Parameters:</span></span>
<span id="cb311-22"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-22" aria-hidden="true" tabindex="-1"></a><span class="do">##    Estimate Est.Error l-95% CI u-95% CI</span></span>
<span id="cb311-23"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb311-23" aria-hidden="true" tabindex="-1"></a><span class="do">## nu     8.07      1.54     5.71    11.72</span></span></code></pre></div>
<p>Our listener-specific adjustments to the sigma intercept were fit with adaptive pooling, i.e. they are ‘random’ effects. As such, we can get these in the same way as other random effects terms (see section <a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-manipulating-random-effects">5.8.2</a>). Below, we use <code>short_hypothesis</code> to get the listener random effects for sigma (<span class="math inline">\(L_{\sigma}\)</span>) by setting <code>scope=ranef</code>. We get the sum of the listener sigma effects and the sigma intercept, <span class="math inline">\(\mathrm{Intercept}_{\sigma} + L_{\sigma[i]}\)</span> for listener <span class="math inline">\(i\)</span>, by setting <code>scope=coef</code>.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># listener random effects for sigma</span></span>
<span id="cb312-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-2" aria-hidden="true" tabindex="-1"></a>log_sigmas_centered <span class="ot">=</span> <span class="fu">short_hypothesis</span>(model_A_L_sigma, <span class="st">&quot;sigma_Intercept=0&quot;</span>, </span>
<span id="cb312-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">scope =</span> <span class="st">&quot;ranef&quot;</span>,<span class="at">group=</span><span class="st">&quot;L&quot;</span>)</span>
<span id="cb312-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the sum of the sigma intercept and the listener sigma random effect</span></span>
<span id="cb312-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-6" aria-hidden="true" tabindex="-1"></a>log_sigmas <span class="ot">=</span> <span class="fu">short_hypothesis</span>(model_A_L_sigma, <span class="st">&quot;sigma_Intercept=0&quot;</span>,</span>
<span id="cb312-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">scope =</span> <span class="st">&quot;coef&quot;</span>,<span class="at">group=</span><span class="st">&quot;L&quot;</span>)</span>
<span id="cb312-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the exponent of the sum of the sigma intercept </span></span>
<span id="cb312-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-10" aria-hidden="true" tabindex="-1"></a><span class="co"># and the listener sigma random effect</span></span>
<span id="cb312-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-11" aria-hidden="true" tabindex="-1"></a>sigmas <span class="ot">=</span> <span class="fu">short_hypothesis</span>(model_A_L_sigma, <span class="st">&quot;exp(sigma_Intercept)=0&quot;</span>,</span>
<span id="cb312-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb312-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">scope =</span> <span class="st">&quot;coef&quot;</span>,<span class="at">group=</span><span class="st">&quot;L&quot;</span>)</span></code></pre></div>
<p>The <code>log_sigmas</code> calculated above represent the logarithm of the listener-specific error parameter. We can get the error terms themselves by exponentiating the parameter within the hypothesis function as shown for the calculation of <code>sigmas</code> above. Figure <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fig:F8-5">8.5</a> compares the listener dependent error effects (<code>log_sigmas_centered</code>) to the listener dependent error terms, in their original scale (<code>sigmas</code>).</p>
<div class="figure"><span style="display:block;" id="fig:F8-5"></span>
<img src="_main_files/figure-html/F8-5-1.jpeg" alt="(left) Values of $L_{\sigma}$, listener-dependent variations from the `sigma` intercept (expressed as a logarithm). (right) Listener-specific sigma parameters. The result of $\exp(\mathrm{Intercept}_{\sigma} + L_{\sigma[i]})$ for listener $i$. We exponentiate the value in the plot so it reflects `sigma` rather than `log(sigma)`." width="4800" />
<p class="caption">
Figure 8.5: (left) Values of <span class="math inline">\(L_{\sigma}\)</span>, listener-dependent variations from the <code>sigma</code> intercept (expressed as a logarithm). (right) Listener-specific sigma parameters. The result of <span class="math inline">\(\exp(\mathrm{Intercept}_{\sigma} + L_{\sigma[i]})\)</span> for listener <span class="math inline">\(i\)</span>. We exponentiate the value in the plot so it reflects <code>sigma</code> rather than <code>log(sigma)</code>.
</p>
</div>
<p>It certainly seems as though there is legitimate between-listener variation in the size of <span class="math inline">\(\sigma\)</span>. We might wonder, is this added complexity a good thing? We can add the <code>loo</code> criterion to our model:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb313-1" aria-hidden="true" tabindex="-1"></a>model_A_L_sigma <span class="ot">=</span> <span class="fu">add_criterion</span>(model_A_L_sigma, <span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<p>And compare this model, the previous ‘simple’ heteroscedastic model (<code>model_A_sigma</code>), and the homoscedastic model we fit in the previous chapter (<code>model_interaction</code>).</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span> (model_interaction, model_A_sigma, model_A_L_sigma)</span>
<span id="cb314-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                   elpd_diff se_diff</span></span>
<span id="cb314-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb314-3" aria-hidden="true" tabindex="-1"></a><span class="do">## model_A_L_sigma      0.0       0.0 </span></span>
<span id="cb314-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="do">## model_A_sigma     -122.1      15.6 </span></span>
<span id="cb314-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="do">## model_interaction -175.8      20.8</span></span></code></pre></div>
<p>This time we find a very large difference in <span class="math inline">\(\mathrm{elpd}\)</span> that is 7.8 times greater than the standard error of the difference. Again, it seems like the more complex model is justified and arguably ‘better’.</p>
</div>
</div>
<div id="answering-our-research-questions" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Answering our research questions<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#answering-our-research-questions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The research questions we posed above were:</p>
<p>(Q1) Does our error standard deviation vary as a function of apparent speaker age?</p>
<p>(Q2) Does our error standard deviation vary as a function of listener?</p>
<p>Based on the information we’ve already provided, we can answer these questions: Yes and yes. Further, we think these results are reasonable based on what we know about the heights of adults and children, and about the average speaker’s knowledge of the heights of adults and children. For example, we think most people have a good handle on how tall adults tend to be. Does the average person know how tall 10-12 year-old children tend to be? We don’t think so. In addition, 10-12 year old children can show substantial variation in height based on differences in growth rates, which might also lead people to provide more variable estimates for the height of children. We think it also ‘makes sense’ that different listeners could be more or less systematic (i.e. predictable) than others, for many reasons.</p>
<p>We’re going to add another, more meta, question: Which model should we report? We can approach this from the perspective that the best model according to <span class="math inline">\(\mathrm{elpd}\)</span> is the ‘real’ model. Based on the comparison of <span class="math inline">\(\mathrm{elpd}\)</span> above, it seems that the last model we fit (<code>model_A_L_sigma</code>) is the ‘best’ model. Does this mean it is the ‘real’ model? And does it mean that this is the one we must report? The short answers to these questions are no and no. The fit between a model and data can’t ‘prove’ that the model represents the ‘real’ relationship underlying the data. The reason for this is that there are potentially a large number of other, slightly different, models that provide just about as good a fit to the data, or perhaps even a better one. This problem is called the <strong>undedetermination</strong> of theory with respect to data, basically that there are often (or always) multiple compatible interpretations of a set of observations, and that our observations alone are not enough to distinguish these.</p>
<p>Specifically with respect to our data, if the best model is the real one, how can we ever know we have the best model? How many did we try before settling on the ‘best’ one? Further, even if we did somehow find the best model for the data we <em>do</em> have, how could we guarantee that it will also be the best model for the data we <em>don’t</em> have? It’s impossible to know if some new data might come along that will not fit your model as well as one of the other models, making the ‘best’ model contingent on the data we have seen so far.</p>
<p>Ok, so we can’t prove that our best model is the real one, fine. But it’s still the best one we have. Do we necessarily need to report the ‘best’ model? This sort of reasoning can lead to serious problems because there is almost always a better model out there, and we often don’t try to find it. For example, many people would never think to fit a heteroscedastic model and so would not even worry about reporting it. Does the existence of a hypothetical better model mean that the model they report is invalid? We don’t think so. If it doesn’t invalidate <em>their</em> simpler model, then why should this be the case for the researcher that <em>did</em> think to try the heteroscedastic model? This would seem to penalize people for bothering to look for such variation in their data, or for knowing how to fit heteroscedastic models.</p>
<p>In general, we can imagine that 10 people might approach any given research question in 10 different ways, a concept sometimes referred to as <strong>researcher degrees of freedom</strong> (Gelman and Loken 2013) since it reflects model variation due to variation in researcher decisions rather than the data. Slight differences in model structure and data processing results in slight differences in model outputs, resulting in a sort of ‘distribution’ for any given result. How can a fixed underlying reality result in a distribution of results? When they are all slightly wrong. Rather than think of our models as representations of <em>reality</em>, we can think of them as mathematical implementations of our research questions. The model we report should include the information and structure that we think are necessary to represent and investigate our research questions. Using a different model can result in different results given the same data, but asking a different question can also lead to different results given the same data. When interpreting a statistical analysis, it is very useful to keep in mind that results are contingent on:</p>
<ol style="list-style-type: decimal">
<li><p>The data you collected. Given other data you may have come to different conclusions.</p></li>
<li><p>The model you chose. Given another model you may have come to different conclusions.</p></li>
</ol>
<p>So which model should we report? One way to think about our models is that they provide different <em>information</em> about our data. If we are primarily interested in the fixed effects then maybe we are not interested in additional information related to the error term. However, if we want to know about differences in error variation then we need one of the more complicated models. It’s also worth considering how the differing model structures might affect the information they share in common. Figure <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fig:F8-6">8.6</a> compares the fixed effects, random effects, and predicted values made by three models: <code>model_interaction</code> from chapter 7, and <code>model_A_sigma</code> and <code>model_A_L_sigma</code> from this chapter.</p>
<div class="figure"><span style="display:block;" id="fig:F8-6"></span>
<img src="_main_files/figure-html/F8-6-1.jpeg" alt="(left) Comparison of fixed effect estimates and 95% credible intervals for three models. We subtracted 159 from the model intercept (Int.) so that it would fit on the same scale as the other parameters. (right) Plots comparing parameter estimates, or predictions, for pairs of the models presented in the left plot. Each row compares a different pair of models and each column presents a different set of parameters." width="4800" />
<p class="caption">
Figure 8.6: (left) Comparison of fixed effect estimates and 95% credible intervals for three models. We subtracted 159 from the model intercept (Int.) so that it would fit on the same scale as the other parameters. (right) Plots comparing parameter estimates, or predictions, for pairs of the models presented in the left plot. Each row compares a different pair of models and each column presents a different set of parameters.
</p>
</div>
<p>These three models have the same structure when it comes to prediction of the expected value of the normal distribution (<span class="math inline">\(\mu\)</span>), however, they differ in terms of the prediction of the error term. The prediction equation for <code>sigma</code> for each model is presented below. We didn’t actually have a prediction equation for <code>sigma</code> in <code>model_interaction</code>, but this is equivalent to using the same <code>sigma</code> for each observation as would be done by the formula. As we can see below, these formulas correspond to ‘intercept only’(chapter 3-4), two-group fixed effects (chapter 5), and two-group random effects (chapter 6) structures for our error term.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb315-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">~</span> <span class="dv">1</span>             <span class="co"># model_interaction</span></span>
<span id="cb315-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb315-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">~</span> A             <span class="co"># model_A_sigma</span></span>
<span id="cb315-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb315-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">~</span> A <span class="sc">+</span> (A<span class="sc">|</span>L)     <span class="co"># model_A_L_sigma</span></span></code></pre></div>
<p>We can see in figure <a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#fig:F8-6">8.6</a> that the differences in the fixed effects are so small as to be largely meaningless. The three models also provide nearly identical listener ‘random effects’ and predicted values. Based on this, if we care primarily about the fixed effects and understanding apparent height judgments, any of the three models will work equally well. Where the models differ is in their estimates of the speaker effects. The inclusion of heteroscedasticity seems to reduce the magnitude of the speaker effects relative to the homoscedastic model (<code>model_interaction</code>). If we were specifically interested in these effects then we would need to take the time to understand the source, and meaning, of these differences. Of course, the experiment we ran was not designed to investigate speaker differences, so it does not make much sense to delve too far into these in our analysis. Our experiment was designed to investigate the perception of apparent height and the role of apparent speaker age and gender in these judgments. From this perspective, it seems that either of the three models is suitable.</p>
</div>
<div id="c8-identifiability" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> Building identifiable and supportable models<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#c8-identifiability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before finishing this chapter we want to talk about an extremely important issue that we have not discussed yet: Whether you <em>can</em>, or <em>should</em>, fit the complex model you are thinking of for your data. To this point, we haven’t discussed this, but as our models get more and more complicated it is something we need to think about. There are generally two constraints on the sorts of models you can fit to your data.</p>
<p>The first of these are issues related to the <strong>identifiability</strong> of different model parameters, that is, the ability of your model to estimate unique and independent values for each of your model parameters. When model parameters are not <strong>identifiable</strong>, that means that these parameters cannot be estimated no matter how much data you have available. We have actually seen several examples of this issue already. When we discussed contrasts (section <a href="comparing-two-groups-of-observations-factors-and-contrasts.html#c5-contrasts">5.6</a>), and when we introduced modeling factors with many levels (section <a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html#c7-description-1">7.2.2</a>), we talked about the fact that you can’t estimate all levels of a factor. The cause of these problems is a lack of <em>identifiability</em> of the parameters.</p>
<p>The second general constraint is related to whether your model is <strong>supported</strong> by your data, meaning you have enough data to realistically estimate all of your model parameters. In many cases involving repeated measures data this will not be an issue as there may be a large number of observations for each group (e.g. subject), and a medium to large number of groups (&gt;30) in the experiment. However, it is still necessary to be aware of the limitations and the problems that (a lack of) support can cause for model fitting.</p>
<p>Because of the incredible array of regression models that can be designed, it’s very difficult to give a ‘high-level’ set of guidelines that will ensure that any particular model will be identifiable and supported by your data. In addition, it’s difficult to really explain model identifiability without talking in detail about matrix algebra (in addition to other mathematical topics). However, we will provide some examples of general cases that we hope are illustrative. You can get the models presented below by running the following line:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb316-1" aria-hidden="true" tabindex="-1"></a>bmmb<span class="sc">::</span><span class="fu">get_model</span> (<span class="st">&#39;8_badmodels.Rda&#39;</span>)</span></code></pre></div>
<div id="collinearity" class="section level3 hasAnchor" number="8.8.1">
<h3><span class="header-section-number">8.8.1</span> Collinearity<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#collinearity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ve referenced the idea of <em>linear dependence</em> before, and we can provide a more formal definition of this now. Each of your predictors is a vector, a sequence of <span class="math inline">\(n\)</span> values that predict your dependent variable for observation <span class="math inline">\(i\)</span>. A set of predictor vectors (<span class="math inline">\(x_1, x_2, \dots, x_p\)</span>) is linearly independent when there is no vector of non-zero real numbers (<span class="math inline">\(a_1, a_2, \dots, a_p\)</span>) that can be multiplied by our vectors such that the sum of the vectors equals zero for all elements of the vector. This is presented below:</p>
<p><span class="math display" id="eq:8-6">\[
\begin{equation}
\begin{split}
0 = x_1 \cdot a_1 + x_2 \cdot a_2 + \dots + x_n \cdot a_n
\end{split}
\tag{8.6}
\end{equation}
\]</span></p>
<p>Basically, if the vectors (<span class="math inline">\(x_1, x_2, \dots, x_p\)</span>) are linearly independent, the values of the <span class="math inline">\(a\)</span> variables above need to all be zero for the equation to be true. Including linearly dependent predictors in our models can cause serious problems. For example, imagine we wanted to predict apparent height based on speaker vocal-tract length (VTL) measured in centimeters (cm) and in meters (m). We only introduce the use of quantitative predictors (such as VTL) in the next chapter, but we can still show how including both of these predictors will cause problems for your model.</p>
<p>We can add a new predictor to our data, speaker VTL specified in meters rather than centimeters.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb317-1" aria-hidden="true" tabindex="-1"></a>exp_data<span class="sc">$</span>vtl_m <span class="ot">=</span> exp_data<span class="sc">$</span>vtl <span class="sc">/</span> <span class="dv">100</span></span></code></pre></div>
<p>Since this new variable equals 100 times our original VTL predictor, its clear that the following operation will result in a string of zeros (or values near zero because of rounding errors).</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb318-1" aria-hidden="true" tabindex="-1"></a>exp_data<span class="sc">$</span>vtl <span class="sc">+</span> exp_data<span class="sc">$</span>vtl_m <span class="sc">*</span> <span class="sc">-</span><span class="dv">100</span></span></code></pre></div>
<p>In other words, <span class="math inline">\(\mathrm{vtl}_{cm} - (-100 \cdot \mathrm{vtl}_{m}) = 0\)</span>, meaning that <span class="math inline">\(\mathrm{vtl}_{cm}\)</span> and <span class="math inline">\(\mathrm{vtl}_{m}\)</span> are <em>linearly dependent</em>. We can fit a model including both of these predictors, as shown below.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb319-1" aria-hidden="true" tabindex="-1"></a>model_bad_1 <span class="ot">=</span>  </span>
<span id="cb319-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb319-2" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> vtl_m <span class="sc">+</span> vtl, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb319-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb319-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>,</span>
<span id="cb319-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb319-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(176, 50)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb319-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb319-5" aria-hidden="true" tabindex="-1"></a>                 brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)))</span></code></pre></div>
<p>However, our model will not be able to find a satisfactory solution, and you will see a large list of warnings when trying to fit it. If you check out the model print statement you will see strange things in the population-level effects:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb320-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error   l-95% CI  u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb320-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept    45.69      2.37      41.17     50.47 1.00     4031     4425</span></span>
<span id="cb320-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="do">## vtl_m      1383.91 246800.93 -531293.80 343951.54 2.12        5       13</span></span>
<span id="cb320-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb320-5" aria-hidden="true" tabindex="-1"></a><span class="do">## vtl          -5.28   2468.01   -3430.88   5321.56 2.12        5       13</span></span></code></pre></div>
<p>Above we see comically small effective sample sizes (ESS) indicating that we have basically no information about our parameters, and large Rhat values indicating that our chains have not converged. We also see an astronomically large standard error for our <code>vtl_m</code> predictor, especially given knowledge that human speaker height tends to range from 100 cm to 200 cm at most. Also, what does it mean that the predictors for VTL in meters and VTL in centimeters differ in sign? How can one be positively related and the other be negatively related to apparent height. Obviously, there are serious problems with these parameter estimates.</p>
<p>Linear dependence is binary, a set of vectors is linearly dependent or it is not. However, we can also talk about the degree to which vectors are linearly <em>related</em>, with linear dependence being one extreme. We measure linear relatedness using correlation coefficients (section <a href="variation-in-parameters-random-effects-and-model-comparison.html#c6-correlations">6.3.2</a>) where correlations of 1 or -1 indicate linear dependence. Our model above failed because our two predictors are linearly dependent, they have a correlation of 1.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span> (exp_data<span class="sc">$</span>vtl_m, exp_data<span class="sc">$</span>vtl)</span>
<span id="cb321-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span></code></pre></div>
<p>In the code below we add a small amount of random error to our VTL predictor (in meters). This is set to 1/10th the value of the standard deviation of the predictor itself. This small amount of random noise reduces the correlation between VTL in meters and VTL in centimeters to 0.9946, almost perfectly correlated but <em>not</em>, strictly speaking, linearly dependent.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb322-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb322-2" aria-hidden="true" tabindex="-1"></a>exp_data<span class="sc">$</span>vtl_m_noise <span class="ot">=</span> exp_data<span class="sc">$</span>vtl_m <span class="sc">+</span> </span>
<span id="cb322-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb322-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span> (<span class="fu">length</span>(exp_data<span class="sc">$</span>vtl_m),<span class="dv">0</span>,<span class="fu">sd</span>(exp_data<span class="sc">$</span>vtl_m)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb322-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb322-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb322-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span> (exp_data<span class="sc">$</span>vtl, exp_data<span class="sc">$</span>vtl_m_noise)</span>
<span id="cb322-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb322-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9946</span></span></code></pre></div>
<p>We can fit the model with the new predictor:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb323-1" aria-hidden="true" tabindex="-1"></a>model_bad_2 <span class="ot">=</span>  </span>
<span id="cb323-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb323-2" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> vtl_m_noise <span class="sc">+</span> vtl, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, </span>
<span id="cb323-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb323-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">cores =</span> <span class="dv">4</span>,<span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>, <span class="at">prior =</span> priors)</span></code></pre></div>
<p>If we inspect the population-level effects we see that this tiny change has made our model substantially better. We get no warnings or error messages when we try to fit this model, and we have a very respectable ESS for our parameters.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb324-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb324-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept      45.75      2.36    41.16    50.35 1.00     4523     4087</span></span>
<span id="cb324-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb324-4" aria-hidden="true" tabindex="-1"></a><span class="do">## vtl_m_noise  -201.86    175.11  -544.11   139.03 1.00     3504     3697</span></span>
<span id="cb324-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb324-5" aria-hidden="true" tabindex="-1"></a><span class="do">## vtl            10.57      1.76     7.14    14.01 1.00     3439     3866</span></span></code></pre></div>
<p>At this point our model might not seem that bad except for the large effect (and huge interval) around <code>vtl_m_noise</code> (VTL in meters, plus noise). The estimate for <code>vtl</code>, and the interval around it, may seem plausible, especially in comparison to our last model. However, we might also consider the estimate for our <code>vtl</code> predictor in a model without this redundant parameter:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb325-1" aria-hidden="true" tabindex="-1"></a>model_good <span class="ot">=</span>  </span>
<span id="cb325-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb325-2" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> vtl, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb325-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb325-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>,</span>
<span id="cb325-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb325-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(176, 50)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb325-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb325-5" aria-hidden="true" tabindex="-1"></a>                 brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)))</span></code></pre></div>
<p>We see that we get a much narrower credible interval around the VTL parameter.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb326-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb326-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept    45.72      2.38    41.04    50.40 1.00     5052     4679</span></span>
<span id="cb326-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="do">## vtl           8.55      0.18     8.21     8.90 1.00     5072     4831</span></span></code></pre></div>
<p>The above is not to say that correlated quantitative predictors should never be included in the same regression model. However, it’s important to think about the consequences of doing this. In addition, when possible, its a good idea to not paint yourself into a corner by designing an experiment that will specifically lead to, or require, highly correlated predictors.</p>
</div>
<div id="predictable-values-of-categorical-predictors" class="section level3 hasAnchor" number="8.8.2">
<h3><span class="header-section-number">8.8.2</span> Predictable values of categorical predictors<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#predictable-values-of-categorical-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Linear dependence can cause other sorts of problems that are less obvious when making predictions using categorical variables. Your model parameters will also not be identifiable if you include categorical predictors whose values can be predicted based on the value of other categorical predictors you include in your model. For example, we know that we can’t estimate both group means <em>and</em> the intercept in two-group models. We can now say that this is because if you know that an observation is not in the first group, you <em>know</em> it must be in the second. This is, once again, the problem of linear dependence.</p>
<p>For example, below we make a small matrix representing predictor variables in a simple regression comparing two groups. The first column represents the intercept for every observation (section <a href="fitting-bayesian-regression-models-with-brms.html#c3-description-1">3.5.2</a>). The second column is a variable equal to 1 when the observation was in the first group and 0 if not. The third column is equal to 1 when the observation was in the second group and 0 if not. Obviously, the second column will equal 1 if the third column is zero and 0 if the third column is 1.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb327-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">cbind</span> (<span class="at">intercept=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">x1=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">2</span>), <span class="at">x2=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>))</span>
<span id="cb327-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb327-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb327-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      intercept x1 x2</span></span>
<span id="cb327-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb327-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]         1  1  0</span></span>
<span id="cb327-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb327-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]         1  0  1</span></span>
<span id="cb327-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]         1  1  0</span></span>
<span id="cb327-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb327-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]         1  0  1</span></span></code></pre></div>
<p>If we look at the numbers above, we can take the first column and add it to the negative of the second and third columns and this will always equal zero.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb328-1" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">1</span>] <span class="sc">+</span> x[,<span class="dv">2</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> x[,<span class="dv">3</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb328-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0 0 0 0</span></span></code></pre></div>
<p>That means that these three predictors are linearly dependent, and that’s why we can’t include separate predictors for the intercept and each group in a two-group model. This also explains why we can’t estimate all four levels of our <code>C</code> (apparent category) parameter, as we discussed in the previous chapter. Below we make a small matrix of ‘predictors’ for each of our four categories and the intercept. The predictors with <code>C</code> in their name equal 1 when the observation belongs to the first, second, third, and fourth groups respectively.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb329-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">cbind</span> (<span class="at">intercept=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">C1=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">C2=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb329-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb329-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">C3=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">C4=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb329-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb329-3" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb329-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb329-4" aria-hidden="true" tabindex="-1"></a><span class="do">##      intercept C1 C2 C3 C4</span></span>
<span id="cb329-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb329-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]         1  1  0  0  0</span></span>
<span id="cb329-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb329-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]         1  0  1  0  0</span></span>
<span id="cb329-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb329-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]         1  0  0  1  0</span></span>
<span id="cb329-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb329-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]         1  0  0  0  1</span></span></code></pre></div>
<p>We can see that the same approach can be used to make all rows add up to zero, indicating that these predictors are linearly dependent. The predictors cannot be made to sum to zero if we omit the fifth column of the matrix above, which is why our models will not estimate <code>C4</code> when <code>C</code> is included as a predictor in our models.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb330-1" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">1</span>] <span class="sc">+</span> x[,<span class="dv">2</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> x[,<span class="dv">3</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> x[,<span class="dv">4</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> x[,<span class="dv">5</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb330-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0 0 0 0</span></span></code></pre></div>
<p>This sort of thing also causes problems when you include multiple different factors that mutually explain each other. For example, last chapter we initially fit a model using <code>C</code>, apparent speaker category, as a predictor. We then fit models using <code>A</code> and <code>G</code>, apparent age and gender as predictors. However, we did not fit models that included apparent age, gender, <em>and</em> speaker category. This is because if a speaker is a woman, they are an adult female. If they are a male child they are a boy, and if they are a female child they are a girl. So, given combinations of some categorical predictors, we have perfect knowledge of the values of <em>other</em> categorical predictors. Mathematically, this means that the ‘secret’ predictors representing each category are linearly dependent. Below we make our small predictor matrix containing predictors for apparent category, apparent age and gender, and their interaction.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb331-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">cbind</span> (<span class="at">intercept=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">C1=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">C2=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb331-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb331-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">C3=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">A1=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">G1=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">A1G1=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb331-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb331-3" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb331-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb331-4" aria-hidden="true" tabindex="-1"></a><span class="do">##      intercept C1 C2 C3 A1 G1 A1G1</span></span>
<span id="cb331-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]         1  1  0  0  0  0    1</span></span>
<span id="cb331-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb331-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]         1  0  1  0  0  1    0</span></span>
<span id="cb331-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb331-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]         1  0  0  1  1  0    0</span></span>
<span id="cb331-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb331-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]         1  0  0  0  1  1    1</span></span></code></pre></div>
<p>This matrix actually features several different combinations of predictors that can be combined to equal zero. For example we can combine the first, second, third and fifth predictors:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb332-1" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">1</span>]<span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span> x[,<span class="dv">2</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> x[,<span class="dv">3</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> x[,<span class="dv">5</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb332-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0 0 0 0</span></span></code></pre></div>
<p>Or the first, third, fourth, and seventh:</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb333-1" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">1</span>]<span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span> x[,<span class="dv">3</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> x[,<span class="dv">4</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> x[,<span class="dv">7</span>]<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb333-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0 0 0 0</span></span></code></pre></div>
<p>If we try to fit a model that includes all of these predictors:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb334-1" aria-hidden="true" tabindex="-1"></a>model_bad_3 <span class="ot">=</span>  </span>
<span id="cb334-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb334-2" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> C <span class="sc">+</span> A<span class="sc">*</span>G, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb334-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb334-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>,</span>
<span id="cb334-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb334-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(176, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb334-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb334-5" aria-hidden="true" tabindex="-1"></a>                 brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)))</span></code></pre></div>
<p>We get a model with the low ESS values, the large Rhat values, and the very large coefficient values and intervals that we saw in our model featuring linearly dependent predictors above.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Population-Level Effects: </span></span>
<span id="cb335-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="do">##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb335-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   157.98      0.20   157.57   158.35 1.06       61       78</span></span>
<span id="cb335-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-4" aria-hidden="true" tabindex="-1"></a><span class="do">## C1         1066.31   2604.72 -4431.79  5158.68 2.07        5       18</span></span>
<span id="cb335-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-5" aria-hidden="true" tabindex="-1"></a><span class="do">## C2          496.91   1751.32 -2543.19  3708.83 1.87        6       13</span></span>
<span id="cb335-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-6" aria-hidden="true" tabindex="-1"></a><span class="do">## C3           74.39   2086.76 -4113.31  2801.74 1.99        5       21</span></span>
<span id="cb335-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-7" aria-hidden="true" tabindex="-1"></a><span class="do">## A1          793.68   1363.24 -2383.78  3019.96 1.90        6       12</span></span>
<span id="cb335-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-8" aria-hidden="true" tabindex="-1"></a><span class="do">## G1          567.63   2171.69 -4107.90  3364.23 2.04        5       18</span></span>
<span id="cb335-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb335-9" aria-hidden="true" tabindex="-1"></a><span class="do">## A1:G1       283.89   1112.60 -2295.30  2141.73 2.26        5       18</span></span></code></pre></div>
<p>This concludes our discussion of linear dependence and some of the many ways it can cause problems for your models. If you try to fit a model and you get errors, divergent transitions, low ESS values and high Rhats, you <em>may</em> have a problem with linear dependencies in your predictors, and it is worth carefully considering this possibility. In addition, a better understanding of model identifiability and linear dependence can be gained by learning a little linear algebra.</p>
</div>
<div id="saturated-and-nearly-saturated-models" class="section level3 hasAnchor" number="8.8.3">
<h3><span class="header-section-number">8.8.3</span> Saturated, and ‘nearly-saturated’, models<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#saturated-and-nearly-saturated-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The models in this chapter sought to estimate five parameters for each listener (<span class="math inline">\(\mathrm{Intercept}, A, G, A:G, \sigma\)</span>) based on 139 observations for each listener. This seems like a reasonable ratio of observations to parameters. If we had only 10 observations per listener, this model may still be identifiable. However, it might still not be such a good idea to fit a model with so many listener-dependent parameters given so little data. In general, before fitting a model that you <em>can</em> fit, it’s a good idea to think whether you <em>should</em> fit it given the nature of your data and the number of observations you have overall (and in different relevant subsets).</p>
<p>We can think of the logical extreme of a model with too many parameters and too little data. Imagine we wanted to fit a model with speaker effects, listener effects, <em>and</em> the interaction between the two. This model will be able to represent the 15 listener effects, 139 speaker effects, and all of the listener-dependent speaker effects. This means that at a minimum, this model would require 15 <span class="math inline">\(\cdot\)</span> 139 = 2085 parameters to represent these effects. However, we only have 2085 data points, one observation per speaker per listener. As a result, we would have a different parameter for every single observation leading to what’s known as a <strong>saturated model</strong>.</p>
<p>In a model without shrinkage, saturated models lead to the perfect prediction of data. This means that there is no data-level error (<span class="math inline">\(\sigma\)</span>), or in fact, any random variation at all. This is problematic because the existence of a non-zero <span class="math inline">\(\sigma\)</span> is a pre-requisite for the calculation of the likelihood function of our regression parameters (see chapter 2). For example, the model below doesn’t report errors because it doesn’t fit at all, it repeatedly crashed R and <em>Stan</em> when we attempted to fit it.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb336-1" aria-hidden="true" tabindex="-1"></a>exp_data<span class="sc">$</span>S <span class="ot">=</span> <span class="fu">factor</span> (exp_data<span class="sc">$</span>S)</span>
<span id="cb336-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb336-2" aria-hidden="true" tabindex="-1"></a>exp_data<span class="sc">$</span>L <span class="ot">=</span> <span class="fu">factor</span> (exp_data<span class="sc">$</span>L)</span>
<span id="cb336-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb336-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb336-4" aria-hidden="true" tabindex="-1"></a>model_bad_4  <span class="ot">=</span>  </span>
<span id="cb336-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb336-5" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">brm</span> (height <span class="sc">~</span> S<span class="sc">*</span>L, <span class="at">data =</span> exp_data, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb336-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb336-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">3500</span>, <span class="at">thin =</span> <span class="dv">2</span>,</span>
<span id="cb336-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb336-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">prior =</span> <span class="fu">c</span>(brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(176, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb336-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb336-8" aria-hidden="true" tabindex="-1"></a>                 brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 15)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)))</span></code></pre></div>
<p>This may be easier to conceive of if we use a much smaller example. Imagine two people run the coffee and reading times experiment we discussed in earlier chapters. Two speakers read a passage after drinking decaf, and another after drinking coffee. This results in four observations. We can estimate the speaker effect, this will be the average of the reading times for each speaker across both drink conditions. The error for this estimate will be the distribution of the coffee and decaf reading times around the speaker average. We can also estimate the effect for drink condition, the average of both speaker reading times within each condition. The error for this will be the distribution of speaker reading times around the mean for each drink condition. However, we cannot estimate the speaker by drink condition interaction. This is because once we know the mean reading time for each speaker for each drink condition, <em>there is no error</em>. We only have one observation within this condition so that observation <em>is</em> the mean. There is no error distribution because we have no other observations.</p>
<p>Ok, so what if we had not one but two observations per speaker per drink condition? This would not be a saturated model, but we could think of it as a <strong>nearly-saturated model</strong>, a term that may not have a formal definition but gets the point across. A model with only two observations per person per drink condition may technically allow us to model the listener by drink condition interaction, however each of the interaction parameters would be based on only two observations.</p>
<p>Back to our example of estimation of the speaker effects. We have 139 observations per listener but only one per listener per speaker. Rather than think of our <span class="math inline">\(n\)</span> (number of observations) as a single value, we can think of our effective <span class="math inline">\(n\)</span> for different parameters. If we plan to investigate the effect of apparent age on apparent height, we have &gt;40 observations per listener per apparent age group (<code>table (exp_data$A, exp_data$L)</code>). We can think of our <span class="math inline">\(n\)</span> per listener for the estimation of the apparent age parameter as &gt;40, a reasonable amount of data. On the other hand, our <span class="math inline">\(n\)</span> for the estimation of the listener by speaker interaction is only 1 (<code>table (exp_data$S, exp_data$L)</code>), regardless of whether we have 139 observations per listener.</p>
<p>If we wanted to make claims about listener-dependent judgments of individual speakers and variation in these, we would need to design an experiment that featured a ‘reasonable’ number of observations per listener per speaker. Establishing a ‘reasonable’ number of repetitions depends on the amount of variation, the type of variation, and the number of groups in your data, among other things. In general, the noisier your data the more observations you will need to get precise (and useful) estimates for your parameters.</p>
</div>
</div>
<div id="exercises-7" class="section level2 hasAnchor" number="8.9">
<h2><span class="header-section-number">8.9</span> Exercises<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#exercises-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The analyses in the main body of the text all involve only the unmodified ‘actual’ resonance level (in <code>exp_data</code>). Responses for the stimuli with the simulate ‘big’ resonance are reserved for exercises throughout. You can get the ‘big’ resonance in the <code>exp_ex</code> data frame, or all data in the <code>exp_data_all</code> data frame.</p>
<p>Fit and interpret one or more of the suggested models:</p>
<ol style="list-style-type: decimal">
<li><p>Easy: Analyze the (pre-fit) model that’s exactly like <code>model_A_L_sigma</code>, except using the data in <code>exp_ex</code> (<code>bmmb::get_model("8_model_A_L_sigma_ex.RDS")</code>).</p></li>
<li><p>Medium: Fit a model like <code>model_A_L_sigma</code>, but replace any of the predictors in the model with the resonance factor.</p></li>
<li><p>Medium: Fit a model like <code>model_A_L_sigma</code>, but add another predictor to the prediction equation for <code>sigma</code>, possibly with an interaction with apparent age.</p></li>
<li><p>Hard: Fit a model like <code>model_A_L_sigma</code> but including apparent age, apparent gender, and resonance. Include all interactions between these factors for both fixed and random effects.</p></li>
</ol>
<p>In any case, describe the model, present and explain the results, and include some figures.</p>
</div>
<div id="references-5" class="section level2 hasAnchor" number="8.10">
<h2><span class="header-section-number">8.10</span> References<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#references-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Gelman, A., Simpson, D., &amp; Betancourt, M. (2017). The prior can often only be understood in the context of the likelihood. Entropy, 19(10), 555.</p>
<p>Kruschke, J. (2014). Doing Bayesian data analysis: A tutorial with R, JAGS, and Stan.</p>
</div>
<div id="plot-code-7" class="section level2 hasAnchor" number="8.11">
<h2><span class="header-section-number">8.11</span> Plot Code<a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#plot-code-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb337-3"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 8.1</span></span>
<span id="cb337-4"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb337-5"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-6"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-6" aria-hidden="true" tabindex="-1"></a>prior_mildly_informative  <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&quot;../models/8_prior_mildly_informative.RDS&quot;</span>)</span>
<span id="cb337-7"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-7" aria-hidden="true" tabindex="-1"></a>prior_conservative <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&quot;../models/8_prior_conservative.RDS&quot;</span>)</span>
<span id="cb337-8"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-9"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>,.<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,.<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb337-10"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="fu">p_check</span> (prior_uninformative, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb337-11"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">samples =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">4000</span>,<span class="at">length.out=</span><span class="dv">10</span>))</span>
<span id="cb337-12"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-12" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span> (<span class="st">&quot;Uinformative&quot;</span>)</span>
<span id="cb337-13"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-13" aria-hidden="true" tabindex="-1"></a><span class="fu">p_check</span> (prior_mildly_informative, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">400</span>), <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb337-14"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">samples =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">4000</span>,<span class="at">length.out=</span><span class="dv">10</span>))</span>
<span id="cb337-15"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-15" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span> (<span class="st">&quot;Mildly Informative&quot;</span>)</span>
<span id="cb337-16"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-16" aria-hidden="true" tabindex="-1"></a><span class="fu">p_check</span> (prior_conservative, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">400</span>), <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb337-17"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">samples =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">4000</span>,<span class="at">length.out=</span><span class="dv">10</span>))</span>
<span id="cb337-18"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-18" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span> (<span class="st">&quot;Conservative&quot;</span>)</span>
<span id="cb337-19"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="st">&quot;Predicted Apparent Height&quot;</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">side=</span><span class="dv">1</span>,<span class="at">line=</span><span class="sc">-</span><span class="fl">1.5</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb337-20"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="st">&quot;Density&quot;</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">side=</span><span class="dv">2</span>,<span class="at">line=</span>.<span class="dv">7</span>, <span class="at">cex =</span> <span class="fl">0.9</span>, <span class="at">adj =</span> <span class="fl">0.6</span>)</span>
<span id="cb337-21"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-22"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-22" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb337-23"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-23" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 8.2</span></span>
<span id="cb337-24"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-24" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb337-25"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-26"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-26" aria-hidden="true" tabindex="-1"></a>model_uninformative <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&quot;../models/8_model_uninformative.RDS&quot;</span>)</span>
<span id="cb337-27"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-27" aria-hidden="true" tabindex="-1"></a>model_mildly_informative <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&quot;../models/8_model_mildly_informative.RDS&quot;</span>)</span>
<span id="cb337-28"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-28" aria-hidden="true" tabindex="-1"></a>model_conservative <span class="ot">=</span> <span class="fu">readRDS</span> (<span class="st">&quot;../models/8_model_conservative.RDS&quot;</span>)</span>
<span id="cb337-29"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-30"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-30" aria-hidden="true" tabindex="-1"></a>fixef_1 <span class="ot">=</span> <span class="fu">fixef</span>(model_uninformative)</span>
<span id="cb337-31"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-31" aria-hidden="true" tabindex="-1"></a>fixef_2 <span class="ot">=</span> <span class="fu">fixef</span>(model_mildly_informative)</span>
<span id="cb337-32"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-32" aria-hidden="true" tabindex="-1"></a>fixef_3 <span class="ot">=</span> <span class="fu">fixef</span>(model_conservative)</span>
<span id="cb337-33"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-34"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-34" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">2.5</span>,<span class="dv">1</span>),<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb337-35"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-35" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (<span class="fu">rbind</span>(fixef_1[<span class="dv">1</span>,],fixef_2[<span class="dv">1</span>,],fixef_3[<span class="dv">1</span>,]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">154.5</span>,<span class="fl">161.5</span>),</span>
<span id="cb337-36"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Intercept&quot;</span>,<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;UI&quot;</span>, <span class="st">&quot;MI&quot;</span>, <span class="st">&quot;C&quot;</span>),<span class="at">cex.lab=</span><span class="fl">1.3</span>,<span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb337-37"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-37" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (<span class="fu">rbind</span>(fixef_1[<span class="dv">2</span>,],fixef_2[<span class="dv">2</span>,],fixef_3[<span class="dv">2</span>,]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">6.5</span>,<span class="fl">13.5</span>),</span>
<span id="cb337-38"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;A1&quot;</span>,<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;UI&quot;</span>, <span class="st">&quot;MI&quot;</span>, <span class="st">&quot;C&quot;</span>),<span class="at">cex.lab=</span><span class="fl">1.3</span>,<span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb337-39"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-39" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (<span class="fu">rbind</span>(fixef_1[<span class="dv">3</span>,],fixef_2[<span class="dv">3</span>,],fixef_3[<span class="dv">3</span>,]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">1</span>),</span>
<span id="cb337-40"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;G1&quot;</span>,<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;UI&quot;</span>, <span class="st">&quot;MI&quot;</span>, <span class="st">&quot;C&quot;</span>),<span class="at">cex.lab=</span><span class="fl">1.3</span>,<span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb337-41"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-41" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (<span class="fu">rbind</span>(fixef_1[<span class="dv">4</span>,],fixef_2[<span class="dv">4</span>,],fixef_3[<span class="dv">4</span>,]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">1</span>),</span>
<span id="cb337-42"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;A1:G1&quot;</span>,<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;UI&quot;</span>, <span class="st">&quot;MI&quot;</span>, <span class="st">&quot;C&quot;</span>),<span class="at">cex.lab=</span><span class="fl">1.3</span>,<span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb337-43"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-43" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side =</span> <span class="dv">2</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="st">&quot;Centimeters&quot;</span>,<span class="at">adj =</span> .<span class="dv">55</span>, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb337-44"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-45"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-46"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-46" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb337-47"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-47" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 8.3</span></span>
<span id="cb337-48"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-48" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb337-49"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-50"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-50" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,.<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb337-51"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-51" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span> (<span class="at">mat =</span> <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb337-52"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-52" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(residuals_interaction[,<span class="dv">1</span>] <span class="sc">~</span> model_interaction<span class="sc">$</span>data<span class="sc">$</span>L, <span class="at">cex.lab =</span> <span class="fl">1.3</span>,<span class="at">cex.axis =</span> <span class="fl">1.2</span>,</span>
<span id="cb337-53"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> cols, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">outline=</span><span class="cn">FALSE</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb337-54"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-54" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb337-55"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-55" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(residuals_interaction[,<span class="dv">1</span>] <span class="sc">~</span> model_interaction<span class="sc">$</span>data<span class="sc">$</span>L, </span>
<span id="cb337-56"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> cols, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">outline=</span><span class="cn">FALSE</span>, <span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb337-57"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.lab =</span> <span class="fl">1.3</span>,<span class="at">cex.axis =</span> <span class="fl">1.2</span>)</span>
<span id="cb337-58"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-59"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-59" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(residuals_interaction[,<span class="dv">1</span>] <span class="sc">~</span> model_interaction<span class="sc">$</span>data<span class="sc">$</span>A, </span>
<span id="cb337-60"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">outline=</span><span class="cn">FALSE</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb337-61"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.lab =</span> <span class="fl">1.3</span>,<span class="at">cex.axis =</span> <span class="fl">1.3</span>)</span>
<span id="cb337-62"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-62" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb337-63"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-63" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(residuals_interaction[,<span class="dv">1</span>] <span class="sc">~</span> model_interaction<span class="sc">$</span>data<span class="sc">$</span>A, </span>
<span id="cb337-64"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">outline=</span><span class="cn">FALSE</span>, <span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb337-65"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.lab =</span> <span class="fl">1.3</span>,<span class="at">cex.axis =</span> <span class="fl">1.3</span>)</span>
<span id="cb337-66"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-66" aria-hidden="true" tabindex="-1"></a><span class="co">#axis (side=1, at = 1:2, labels = c()</span></span>
<span id="cb337-67"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-67" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(residuals_interaction[,<span class="dv">1</span>] <span class="sc">~</span> model_interaction<span class="sc">$</span>data<span class="sc">$</span>A <span class="sc">+</span> model_interaction<span class="sc">$</span>data<span class="sc">$</span>L, </span>
<span id="cb337-68"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rep</span>(cols, <span class="at">each =</span> <span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">32</span>,<span class="dv">30</span>), <span class="at">outline=</span><span class="cn">FALSE</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb337-69"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>, <span class="at">cex.lab =</span> <span class="fl">1.3</span>,<span class="at">cex.axis =</span> <span class="fl">1.3</span>)</span>
<span id="cb337-70"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-70" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb337-71"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-71" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(residuals_interaction[,<span class="dv">1</span>] <span class="sc">~</span> model_interaction<span class="sc">$</span>data<span class="sc">$</span>A <span class="sc">+</span> model_interaction<span class="sc">$</span>data<span class="sc">$</span>L,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>, </span>
<span id="cb337-72"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rep</span>(cols, <span class="at">each =</span> <span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">32</span>,<span class="dv">30</span>), <span class="at">outline=</span><span class="cn">FALSE</span>, <span class="at">add=</span><span class="cn">TRUE</span>,</span>
<span id="cb337-73"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">cex.lab =</span> <span class="fl">1.3</span>,<span class="at">cex.axis =</span> <span class="fl">1.3</span>)</span>
<span id="cb337-74"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-74" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span> (<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="fl">1.5</span>,<span class="fl">29.5</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,<span class="at">cex.axis =</span> <span class="fl">1.3</span>)</span>
<span id="cb337-75"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-76"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-76" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">2</span>, <span class="at">line =</span> <span class="fl">0.3</span>,<span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="st">&quot;Residuals (in centimeters)&quot;</span>)</span>
<span id="cb337-77"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-78"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-78" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb337-79"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-79" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 8.4</span></span>
<span id="cb337-80"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-80" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb337-81"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-82"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-82" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">2.2</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="dv">1</span>))</span>
<span id="cb337-83"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-83" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (sigmas, <span class="at">col =</span> cols[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Overall&quot;</span>,<span class="st">&quot;Adults&quot;</span>,<span class="st">&quot;Children&quot;</span>),</span>
<span id="cb337-84"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-84" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Centimeters&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">3.7</span>,<span class="dv">8</span>))</span>
<span id="cb337-85"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-85" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (<span class="fu">fixef</span>(model_A_sigma)[<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>),], <span class="at">col =</span> cols,<span class="at">nudge=</span> <span class="sc">-</span>.<span class="dv">1</span>,<span class="at">pch=</span><span class="dv">17</span>,</span>
<span id="cb337-86"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-86" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;G1&quot;</span>,<span class="st">&quot;A1:G1&quot;</span>),<span class="at">ylab =</span> <span class="st">&quot;Centimeters&quot;</span>)</span>
<span id="cb337-87"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-87" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (<span class="fu">fixef</span>(model_interaction)[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,], <span class="at">col =</span> cols, <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb337-88"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-88" aria-hidden="true" tabindex="-1"></a>         <span class="at">nudge=</span>.<span class="dv">1</span>,<span class="at">labels=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-89"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-89" aria-hidden="true" tabindex="-1"></a><span class="co">#abline (h = 7.71)</span></span>
<span id="cb337-90"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-90" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span> (<span class="fl">1.7</span>,<span class="dv">10</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Heteroscedastic&quot;</span>,<span class="st">&quot;Homoscedastic&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb337-91"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-92"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-92" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb337-93"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-93" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 8.5</span></span>
<span id="cb337-94"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-94" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb337-95"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-96"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-96" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">oma=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb337-97"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-97" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (log_sigmas_centered, <span class="at">col =</span> cols,<span class="at">labels =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.9</span>,<span class="fl">0.8</span>),</span>
<span id="cb337-98"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-98" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;Listener&quot;</span>)</span>
<span id="cb337-99"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-99" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span> (<span class="at">side=</span><span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb337-100"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-100" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (sigmas[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">col =</span> cols, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">11</span>),<span class="at">labels=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb337-101"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-101" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;Listener&quot;</span>)</span>
<span id="cb337-102"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-102" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="at">h =</span> <span class="fu">exp</span>(<span class="fl">1.74</span>))</span>
<span id="cb337-103"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-103" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (sigmas[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">col =</span> cols, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">labels=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-104"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-104" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span> (<span class="at">side=</span><span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb337-105"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-105" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side =</span> <span class="dv">2</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="st">&quot;Centimeters&quot;</span>,<span class="at">adj =</span> .<span class="dv">6</span>, <span class="at">cex=</span><span class="fl">1.1</span>, <span class="at">line =</span> <span class="fl">0.75</span>)</span>
<span id="cb337-106"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-107"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-108"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-108" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb337-109"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-109" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure 8.6</span></span>
<span id="cb337-110"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-110" aria-hidden="true" tabindex="-1"></a><span class="do">################################################################################</span></span>
<span id="cb337-111"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-112"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-112" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="fl">2.5</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">1</span>))</span>
<span id="cb337-113"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-114"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-114" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span> (<span class="at">m =</span> <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">10</span>),<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb337-115"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-116"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-116" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (fixefs1, <span class="at">col=</span>cols[<span class="dv">15</span>],<span class="at">labels =</span> <span class="st">&quot;&quot;</span>, <span class="at">nudge=</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">15</span>),</span>
<span id="cb337-117"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-117" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">&quot;Centimeters&quot;</span>,<span class="at">cex.lab=</span><span class="fl">1.4</span>)</span>
<span id="cb337-118"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-118" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (fixefs2[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),], <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">nudge=</span><span class="dv">0</span>, <span class="at">col=</span>cols[<span class="dv">3</span>],<span class="at">labels =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb337-119"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-119" aria-hidden="true" tabindex="-1"></a><span class="fu">brmplot</span> (fixefs3[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),], <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">nudge=</span><span class="fl">0.1</span>, <span class="at">col=</span>cols[<span class="dv">4</span>],<span class="at">labels =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb337-120"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-121"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-121" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span> (<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="fu">c</span>(<span class="st">&quot;Int.&quot;</span>,<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;G1&quot;</span>,<span class="st">&quot;A1:G1&quot;</span>),<span class="at">cex.axis=</span><span class="fl">1.3</span>)</span>
<span id="cb337-122"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-122" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span> (<span class="fl">1.5</span>,<span class="dv">6</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;M1:model_interaction&quot;</span>, <span class="st">&quot;M2:model_A_sigma&quot;</span>, <span class="st">&quot;M3:model_A_L_sigma&quot;</span>), </span>
<span id="cb337-123"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-123" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> cols[<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">4</span>)], <span class="at">pch=</span><span class="dv">16</span>,<span class="at">pt.cex=</span><span class="fl">1.5</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,<span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb337-124"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-124" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">3</span>,<span class="at">outer=</span><span class="cn">FALSE</span>, <span class="st">&quot;Fixed Effects&quot;</span>,<span class="at">cex=</span>.<span class="dv">9</span>,<span class="at">line=</span><span class="fl">0.9</span>)</span>
<span id="cb337-125"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-126"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-126" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">1.3</span>,<span class="dv">1</span>))</span>
<span id="cb337-127"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-128"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-128" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (ranefs1<span class="sc">$</span>L[,<span class="dv">1</span>,], ranefs2<span class="sc">$</span>L[,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">5</span>],</span>
<span id="cb337-129"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-129" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">cex=</span><span class="fl">1.25</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-130"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-130" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-131"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-131" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">3</span>,<span class="at">outer=</span><span class="cn">FALSE</span>, <span class="st">&quot;Listener Effects&quot;</span>,<span class="at">cex=</span>.<span class="dv">9</span>,<span class="at">line=</span><span class="fl">0.9</span>)</span>
<span id="cb337-132"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-132" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="st">&quot;x=M1,y=M2&quot;</span>,<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb337-133"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-133" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (ranefs1<span class="sc">$</span>S[,<span class="dv">1</span>,], ranefs2<span class="sc">$</span>S[,<span class="dv">1</span>,], <span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">7</span>],</span>
<span id="cb337-134"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-134" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>,<span class="dv">5</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>,<span class="dv">5</span>),<span class="at">cex=</span><span class="fl">1.25</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-135"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-135" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-136"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-136" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">3</span>,<span class="at">outer=</span><span class="cn">FALSE</span>, <span class="st">&quot;Speaker Effects&quot;</span>,<span class="at">cex=</span>.<span class="dv">9</span>,<span class="at">line=</span><span class="fl">0.9</span>)</span>
<span id="cb337-137"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-137" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (yhat1[,<span class="dv">1</span>],yhat2[,<span class="dv">1</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">8</span>],<span class="at">cex=</span><span class="fl">1.25</span>,</span>
<span id="cb337-138"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">190</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">190</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-139"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-139" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-140"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-140" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span> (<span class="at">side=</span><span class="dv">3</span>,<span class="at">outer=</span><span class="cn">FALSE</span>, <span class="st">&quot;Predictions&quot;</span>,<span class="at">cex=</span>.<span class="dv">9</span>,<span class="at">line=</span><span class="fl">0.9</span>)</span>
<span id="cb337-141"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-142"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-142" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (ranefs1<span class="sc">$</span>L[,<span class="dv">1</span>,], ranefs3<span class="sc">$</span>L[,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">9</span>],</span>
<span id="cb337-143"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-143" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">cex=</span><span class="fl">1.25</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-144"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-144" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-145"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-145" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="st">&quot;x=M1,y=M3&quot;</span>,<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb337-146"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-146" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (ranefs1<span class="sc">$</span>S[,<span class="dv">1</span>,], ranefs3<span class="sc">$</span>S[,<span class="dv">1</span>,], <span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">10</span>],</span>
<span id="cb337-147"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>,<span class="dv">5</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>,<span class="dv">5</span>),<span class="at">cex=</span><span class="fl">1.25</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-148"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-148" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-149"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-149" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (yhat1[,<span class="dv">1</span>],yhat3[,<span class="dv">1</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">2</span>],<span class="at">cex=</span><span class="fl">1.25</span>,</span>
<span id="cb337-150"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-150" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">190</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">190</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-151"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-151" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-152"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-153"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-153" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (ranefs2<span class="sc">$</span>L[,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], ranefs3<span class="sc">$</span>L[,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">12</span>],</span>
<span id="cb337-154"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-154" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">cex=</span><span class="fl">1.25</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-155"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-155" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-156"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-156" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="st">&quot;x=M2,y=M3&quot;</span>,<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb337-157"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-157" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (ranefs2<span class="sc">$</span>S[,<span class="dv">1</span>,], ranefs3<span class="sc">$</span>S[,<span class="dv">1</span>,], <span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">13</span>],</span>
<span id="cb337-158"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-158" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>,<span class="dv">5</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>,<span class="dv">5</span>),<span class="at">cex=</span><span class="fl">1.25</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-159"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-159" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb337-160"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-160" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (yhat2[,<span class="dv">1</span>],yhat3[,<span class="dv">1</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>bmmb<span class="sc">::</span>cols[<span class="dv">14</span>],<span class="at">cex=</span><span class="fl">1.25</span>,</span>
<span id="cb337-161"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-161" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">190</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">190</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb337-162"><a href="varying-variances-more-about-priors-and-prior-predictive-checks.html#cb337-162" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>

<div style="page-break-after: always;"></div>
</div>
</div>
<!-- Default Statcounter code for statsbook
https://santiagobarreda.github.io/stats-class/ -->
<script type="text/javascript">
var sc_project=12454226; 
var sc_invisible=1; 
var sc_security="a1959418"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/12454226/0/a1959418/1/"
alt="Web Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->
            </section>

          </div>
        </div>
      </div>
<a href="comparing-many-groups-interactions-and-posterior-predictive-checks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="quantitative-predictors-and-their-interactions-with-factors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
